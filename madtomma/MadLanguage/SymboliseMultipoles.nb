(************** Content-type: application/mathematica **************

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     63306,       1748]*)
(*NotebookOutlinePosition[     88366,       2625]*)
(*  CellTagsIndexPosition[     87999,       2611]*)
(*WindowFrame->Normal*)



Notebook[{
Cell["CERN SL Note XX-XXX  (AP)", "Text",
  TextAlignment->Right],

Cell["\<\


\
\>", "Text"],

Cell[CellGroupData[{

Cell["\<\
Restoring Multipole Components in MAD8 files generated by MAD9\
\>", "Title"],

Cell[TextData[{
  ButtonBox["John M. Jowett",
    ButtonData:>{
      URL[ "http://wwwslap.cern.ch/~jowett/"], None},
    ButtonStyle->"Hyperlink"],
  "\n19/2/2001"
}], "Author"],

Cell[CellGroupData[{

Cell["Introduction", "Section"],

Cell[TextData[{
  "This note is the documentation for a ",
  StyleBox["Mathematica",
    FontSlant->"Italic"],
  " [",
  ButtonBox["1",
    ButtonData:>"Wolfram book",
    ButtonStyle->"Hyperlink"],
  ",",
  ButtonBox["2",
    ButtonData:>"Maeder book",
    ButtonStyle->"Hyperlink"],
  "] package designed to remedy a deficiency of MAD9's conversion of a beam \
line sequence to MAD8 format, possibly including a conversion of thick \
elements to thin lenses."
}], "Text"],

Cell["\<\
MAD9 multipole element strengths are specified as vectors KN and KS whose \
components may contain algebraic dependences on MAD variables. MAD9 converts \
these expressions to their numerical values in the conversion process, thus \
losing the symbolic dependences.  Components which happen to evaluate to zero \
(including the case where parameter values have not yet been assigned) simply \
disappear. Numerically MAD9's output is correct but changes to parameter \
values will not have any effect.\
\>", "Text"],

Cell["\<\
This deficiency is present in MAD9 versions up to at least 9.5/7 (31 January \
2001).        
          
This package works by parsing the original MAD9 definitions of the multipole \
elements and correlating them with their translations in the MAD8 file.  It \
also treats any thin slices into which the multipoles may have been cut AND \
any elements that inherit their properties from the MAD9 multipoles.   The \
latter feature is presently limited to a single level of cloning.  The \
radiation length is taken from the MAD8 file and the proper dependences of \
the multipole strengths are taken from the MAD9 file. MAD9 specifies \
multipoles by their normal and skew components while MAD8 uses a magnitude \
and a tilt angle.  Algebraic expressions are built to make this \
transformation and preserve the proper symbolic dependences.  Simplified \
versions are generated in common special cases (e.g. zero skew component).    \
       \
\>", "Text"],

Cell["\<\
There are some limitations but should work with the files used to generate \
the LHC optics provided there are no dramatic changes in the way these are \
built.\
\>", "Text"],

Cell["\<\
The new MAD8 file has the following features:                              
Long lines are broken to respect MAD8's limit on length of lines.
The radiation lengths of the elements are the same numerical values (i.e. no \
attempt to re-instate parametric dependences of element lengths)  but new \
algebraic forms are generated for the multipole strengths.       
Every element explicitly defined as a multipole is treated.              \
\>", "Text"],

Cell["\<\
This program was originally written as a KEDIT macro SymboliseMultipoles.kex.\
\
\>", "Text"],

Cell[TextData[{
  "These packages and others relating to the use of ",
  ButtonBox["MAD",
    ButtonData:>{
      URL[ "http://wwwslap.cern.ch/~fci/mad/mad.html"], None},
    ButtonStyle->"Hyperlink"],
  " will all be made available in the context ",
  StyleBox["Madtomma", "Input"],
  "  (the word ",
  StyleBox["context",
    FontSlant->"Italic"],
  " is used in a special sense in ",
  StyleBox["Mathematica).  ",
    FontSlant->"Italic"],
  "Preliminary versions of some are already available; documentation will be \
released as it is prepared."
}], "Text"],

Cell[TextData[{
  "This notebook adheres to the conventions for ",
  StyleBox["Mathematica",
    FontSlant->"Italic"],
  " package structure and documentation set out in [2].  As such it serves as \
the development medium for the package itself.  ",
  StyleBox["For this reason , some sections of the printed versions of this \
document are hidden.  ",
    FontWeight->"Bold"],
  "They contain the definitions (\"code\") of the functions.  The visible \
sections contain the documentation and examples of interest to users."
}], "Text"],

Cell[TextData[{
  "To make the package available, you need only copy a couple of commands \
from the \"Setup\" section.  The ",
  ButtonBox["\"Examples\"",
    ButtonData:>"Examples section",
    ButtonStyle->"Hyperlink"],
  " section illustrates basic use of the package.  A final subsection \
illustrating some less useful features is hidden."
}], "Text"],

Cell["The latest version is available on-line at", "Text"],

Cell[TextData[ButtonBox["http://home.cern.ch/jowett/Madtomma/",
  ButtonData:>{
    URL[ "http://home.cern.ch/jowett/Madtomma/"], None},
  ButtonStyle->"Hyperlink"]], "Program"],

Cell[TextData[{
  "This notebook is based on the template for package and notebook \
development by R. Maeder  and supplied with ",
  StyleBox["Mathematica",
    FontSlant->"Italic"],
  " 3.0."
}], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reference", "Section",
  CellTags->"Reference section"],

Cell[CellGroupData[{

Cell["Title", "Subsubsection"],

Cell[TextData[StyleBox["Package template",
  FontSlant->"Italic"]], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Author", "Subsubsection"],

Cell["John M. Jowett", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Summary", "Subsubsection"],

Cell["\<\
This notebook is a template for package and notebook development.\
\>", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Copyright", "Subsubsection"],

Cell[TextData[{
  "\[Copyright] ",
  ButtonBox["Copyright CERN.1997",
    ButtonData:>{
      URL[ 
      "http://www.cern.ch/CERN/Divisions/DSU/Legal/Notices/Copyright.html"], 
      None},
    ButtonStyle->"Hyperlink"],
  "\n\nThe copyright and all other rights relating to this computer software, \
in whatever form, including but not limited to the source code, the object \
code and user documentation, are vested in CERN. \n\nCERN, on a royalty-free \
and non-exclusive basis, hereby grants permission to use, copy, change, \
modify, translate, display, distribute and make available this computer \
software, subject to the following conditions:\n\n(1) this computer software \
is provided on an as-is basis and CERN provides no express or implied \
warranties of any kind, including but not limited to those of \
merchantability, fitness for a particular purpose and non-infringement of the \
proprietary rights, such as copyrights, patents and trade secrets, of third \
parties. CERN accepts no liability whatsoever for or in connection with the \
use of this computer software; \n\n(2) all copies made of this computer \
software or of parts thereof shall include  his copyright statement in full; \
\n\n(3) however, if this computer software or parts thereof are made \
available in any other form than their original form, or are included in any \
other computer software, the following short acknowledgement only must be \
mentioned in the copyright statement and in the user documentation (or, in \
the absence thereof, in any other appropriate place) concerning the computer \
software thus made available or created: \n\n\"This product includes computer \
software created and made available by CERN. This acknowledgement shall be \
mentioned in full in any product which includes the CERN computer software \
included herein or parts thereof.\" "
}], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Notebook Version", "Subsubsection"],

Cell["1.0", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
  StyleBox["Mathematica",
    FontSlant->"Italic"],
  " Version"
}], "Subsubsection"],

Cell["3.0", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["History", "Subsubsection"],

Cell[TextData[{
  "Adapted from Version 1.0 for ",
  StyleBox["Programming in Mathematica",
    FontSlant->"Italic"],
  ", 3rd edition."
}], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Keywords", "Subsubsection"],

Cell["programming, notebooks, packages, template", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Source", "Subsubsection"],

Cell[TextData[{
  StyleBox["Maeder, R. "],
  StyleBox["Programming in ",
    FontSlant->"Italic"],
  StyleBox["Mathematica",
    FontSlant->"Italic"],
  StyleBox[", 3rd ed. Addison-Wesley, 1996."]
}], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Warnings", "Subsubsection"],

Cell[TextData[StyleBox["description of global effects, incompatibilities",
  FontSlant->"Italic"]], "Text"],

Cell[TextData[{
  "Note: all cells marked as \"InitializationCell\" will be written to the \
Auto-Save package. This package can then be read in programs that use it with \
",
  StyleBox["Needs[\"Template`\"]", "Input"],
  ". Cells not intended to belong to the package should not have this \
property."
}], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Limitation", "Subsubsection"],

Cell[TextData[StyleBox["special cases not handled, known problems",
  FontSlant->"Italic"]], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Discussion", "Subsubsection"],

Cell[TextData[StyleBox["description of algorithm, information for experts",
  FontSlant->"Italic"]], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Requirements", "Subsubsection"],

Cell[TextData[StyleBox["Context`Package`",
  FontFamily->"Courier",
  FontWeight->"Bold",
  FontSlant->"Italic"]], "Text"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Setup", "Section",
  CellTags->"Setup section"],

Cell[TextData[{
  "This section contains commands needed to load the corresponding package \
file.  The contents of this file are equivalent to the following sections \
(Interface, Implementation, Epilog) in which the package is developed.  These \
sections are hidden when this notebook is used as the package documentation \
but may be inspected in the online copy of this notebook that can be found in \
the appropriate  sub-directory of the directory added to the ",
  StyleBox["$Path", "Input"],
  " variable below."
}], "Text"],

Cell[CellGroupData[{

Cell["Search Path (ESSENTIAL!)", "Subsection",
  CellTags->"Setup section"],

Cell["\<\
To have access to my packages, you may need to add my packages directory to \
your search path.  This is system-dependent and the latest information about \
arranging it on CERN computer systems can be found at\
\>", "Text"],

Cell[TextData[ButtonBox["http://home.cern.ch/jowett/Madtomma/AboutFiles.html",
  
  ButtonData:>{
    URL[ "http://home.cern.ch/jowett/Madtomma/AboutFiles.html"], None},
  ButtonStyle->"Hyperlink"]], "Program"],

Cell[TextData[{
  "and is not reproduced here.  I strongly recommend that you modify your \
kernel initialisation file once and for all as explained on this page.  Then \
all my packages will be found as easily as the Standard Packages that come \
with ",
  StyleBox["Mathematica",
    FontSlant->"Italic"],
  "."
}], "Text",
  CellTags->"Setup section"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loading the Package", "Subsection",
  CellTags->"Setup section"],

Cell[TextData[{
  "Once the package directory is on your search path, the ",
  StyleBox["Mfs", "Input"],
  " package can be loaded by evaluating the following cell. ",
  StyleBox[
  "If you are using a copy of this notebook in order to work through the \
examples and you are invited to  evaluate all the initialisation cells in it, \
you should click \"NO\" and then go straight to the ",
    FontSlant->"Italic",
    FontColor->RGBColor[1, 0, 0]],
  StyleBox["\"",
    FontSlant->"Italic"],
  StyleBox[ButtonBox["User's Guide and Examples",
    ButtonData:>"Examples section",
    ButtonStyle->"Hyperlink"],
    FontSlant->"Italic"],
  StyleBox["\" ",
    FontSlant->"Italic"],
  StyleBox["without evaluating the intermediate sections.",
    FontSlant->"Italic",
    FontColor->RGBColor[1, 0, 0]]
}], "Text",
  CellTags->"Setup section"],

Cell[BoxData[
    StyleBox[\(Needs["\<Madtomma`MadLanguage`SymboliseMultipoles`\>"]\),
      "Input"]], "InputOnly",
  CellTags->"Setup section"],

Cell[TextData[{
  "This is all you need to start using the package in your own applications.  \
 In interactive sessions, you will normally see a palette of buttons \
appearing on your screen.   This makes it easier to use the package: see ",
  ButtonBox["Section ",
    ButtonData:>"palette",
    ButtonStyle->"Hyperlink"],
  CounterBox["Section", "palette"],
  " below."
}], "Text",
  CellTags->"Setup section"],

Cell[TextData[{
  "These following sections are hidden when this notebook is used as the \
package documentation but may be inspected in the online copy that can be \
found in the appropriate  sub-directory of the directory added to the ",
  StyleBox["$Path", "Input"],
  " variable above."
}], "Text",
  CellTags->"Setup section"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interface", "Section",
  InitializationCell->True,
  CellTags->"Interface section"],

Cell["\<\
This part declares the publicly visible functions, options, and values.\
\>", "Text",
  InitializationCell->True,
  CellTags->"Interface section"],

Cell[CellGroupData[{

Cell["Set up the package context, including public imports", "Subsection",
  InitializationCell->True,
  CellTags->"Interface section"],

Cell[TextData[{
  "Because of a bug in ",
  StyleBox["Mathematica",
    FontSlant->"Italic"],
  " (Version 4 anyway) that tends to break context strings across lines in \
the auto-generated package file, it is advisable to force line-breaks after \
the name of each package in this command."
}], "Commentary"],

Cell[CellGroupData[{

Cell["BeginPackage[\"Madtomma`MadLanguage`SymboliseMultipoles`\"]", "Input",
  InitializationCell->True,
  CellTags->"Interface section"],

Cell[BoxData["\<\"Madtomma`MadLanguage`SymboliseMultipoles`\"\>"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Usage messages for the exported functions and the context itself\
\>", "Subsection",
  InitializationCell->True,
  CellTags->"Interface section"],

Cell["\<\
SymboliseMultipoles::usage = \"SymboliseMultipoles.m is a package that \
restores correct symbolic dependences of multipole strengths in MAD8 files \
generated by MAD9.\";\
\>", "Input",
  InitializationCell->True,
  CellTags->"Interface section"],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"SymboliseMultipolesMAD8", "::", "usage"}], "=", 
        "\"\<SymboliseMultipolesMAD8[mad9file,mad8file,fixedFile] uses the \
original multipole definitions in a MAD9 file to restore correct symbolic \
dependences of multipole strengths in a MAD8 file generated by MAD9. The \
output is given on a new file fixedFile (which is overwritten if it already \
exists).\>\""}], ";"}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"stripComment", "::", "usage"}], "=", 
        "\"\<\!\(InputForm\`stripComment\)[stmt,comchar] strips off comment \
text, taken to be anything to the right of comchar (default \\\"//\\\") in \
the string stmt.\>\""}], ";"}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"cleanReadMAD9file", "::", "usage"}], "=", 
        "\"\<cleanReadMAD9file[mad9file] reads in a MAD9 file and returns a \
list of complete commands without comments.\>\""}], ";"}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(\(cleanReadMAD8file::usage = "\<cleanReadMAD8file[mad8file] reads in a \
MAD8 file and returns a list of complete commands without comments.\>";\)\)], \
"Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"MAD9label", "::", "usage"}], "=", 
        "\"\<MAD9label[stmt] returns the label part of a MAD9 \
statement.\>\""}], ";"}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"MAD8label", "::", "usage"}], "=", 
        "\"\<MAD8label[stmt] returns the label part of a MAD8 \
statement.\>\""}], ";"}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"MAD9keyword", "::", "usage"}], "=", 
        "\"\<MAD9keyword[stmt] returns the keyword part of a MAD9 \
statement.\>\""}], ";"}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"MAD8keyword", "::", "usage"}], "=", 
        "\"\<MAD8keyword[stmt] returns the keyword part of a MAD8 \
statement.\>\""}], ";"}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"MAD8sliceParent", "::", "usage"}], "=", 
        "\"\<MAD8sliceParent[elementname] returns the name of the parent \
element of a thin slice generated by MAD9 in a MAD8 format file.\>\""}], 
      ";"}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"MAD9multipoleList", "::", "usage"}], "=", 
        "\"\<MAD9multipoleList[stmt,type] where type is \\\"KN\\\" (default) \
or \\\"KS\\\" returns a list of strings giving the MAD9 multipole strengths \
found in the MAD9 command stnt.\>\""}], ";"}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"MAD8multipoleDefinition", "::", "usage"}], "=", 
        "\"\<MAD8multipoleDefinition[KN,KS,LRAD] converts a MAD8 multipole \
definition string to MAD8 format.\>\""}], ";"}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"breakMAD8line", "::", "usage"}], "=", 
        "\"\<breakMAD8line[mad8line] breaks up a long MAD8 line into a list \
of lines that do not exceed the length limit in MAD8.\>\""}], ";"}]], "Input",\

  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Error messages for the exported objects", "Subsection",
  CellTags->"Interface section"],

Cell["\<\
SymboliseMultipoles::badarg = \"You  called `1` with argument `2`!\"\
\>", "Input",
  CellTags->"Interface section"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Implementation", "Section",
  InitializationCell->True,
  CellTags->"Implementation section"],

Cell["\<\
This part contains the actual definitions and any auxiliary functions that \
should not be visible outside.\
\>", "Text",
  CellTags->"Implementation section"],

Cell[CellGroupData[{

Cell["Begin the private context (implementation part)", "Subsection",
  InitializationCell->True,
  CellTags->"Implementation section"],

Cell[CellGroupData[{

Cell["Begin[\"`Private`\"]", "Input",
  InitializationCell->True,
  CellTags->"Implementation section"],

Cell[BoxData["\<\"Madtomma`MadLanguage`SymboliseMultipoles`Private`\"\>"], \
"Output"]
}, Open  ]]
}, Open  ]],

Cell["Definition of the exported functions", "Subsection",
  InitializationCell->True,
  CellTags->"Implementation section"],

Cell[CellGroupData[{

Cell["The master function", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(SymboliseMultipolesMAD8[thickFile_String, thinFile_String, 
        fixedFile_String] := 
      Module[{thickclean, thickMultipoles, mnames, mKN, mKS, thinclean, 
          fixedMAD8commands}, \[IndentingNewLine]thickclean = 
          cleanReadMAD9file[thickFile]; \[IndentingNewLine]thickMultipoles = 
          Select[thickclean, \((StringMatchQ[#, "\<*KN*{*}\>"] || 
                  StringMatchQ[#, "\<*KS*{*}\>"])\) &]\ ; \
\[IndentingNewLine]mnames = 
          MAD9label /@ thickMultipoles; \[IndentingNewLine]mKN = 
          MAD9multipoleList /@ 
            thickMultipoles; \[IndentingNewLine]mKS = \(MAD9multipoleList[#, \
"\<KS\>"] &\) /@ thickMultipoles; \[IndentingNewLine]thinclean = 
          cleanReadMAD8file[thinFile]; \[IndentingNewLine]fixedMAD8commands = 
          Flatten[breakMAD8line /@ \((\(\((symboliseMultipoles[#, mnames, 
                          mKN, mKS] <> "\<;\>")\) &\) /@ 
                  thinclean)\)]; \[IndentingNewLine]DeleteFile[
          fixedFile]; \[IndentingNewLine]fixed = 
          OpenWrite[fixedFile]; \[IndentingNewLine]WriteString[
          fixed, "\<!! <MAD8 file processed by SymboliseMultipoles.m>;\n\>"]; \
\[IndentingNewLine]\(WriteString[fixed, # <> "\<\n\>"] &\) /@ 
          fixedMAD8commands; \[IndentingNewLine]WriteString[
          fixed, "\<!! </MAD8 file processed by SymboliseMultipoles.m>;\n\
\>"]; \[IndentingNewLine]Close[fixed]\[IndentingNewLine]]\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"General", "::", "\<\"spell1\"\>"}], 
      RowBox[{
      ":", " "}], "\<\"Possible spelling error: new symbol name \
\\\"\\!\\(symboliseMultipoles\\)\\\" is similar to existing symbol \
\\\"\\!\\(SymboliseMultipoles\\)\\\".\"\>"}]], "Message"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Auxiliary functions", "Subsection"],

Cell[BoxData[
    RowBox[{
      RowBox[{"stripComment", "[", 
        RowBox[{"s_String", ",", 
          RowBox[{"comchar_String:", "\"\<//\>\""}]}], "]"}], ":=", 
      RowBox[{"If", "[", 
        RowBox[{
          RowBox[{
            RowBox[{"StringTake", "[", 
              RowBox[{"s", ",", 
                RowBox[{"StringLength", "[", "comchar", "]"}]}], "]"}], 
            "\[Equal]", "comchar"}], ",", "s", ",", 
          RowBox[{"StringTake", "[", 
            RowBox[{"s", ",", 
              RowBox[{
                RowBox[{"First", "@", 
                  RowBox[{"First", "@", 
                    RowBox[{"StringPosition", "[", 
                      RowBox[{"s", ",", "comchar"}], "]"}]}]}], "-", "1"}]}], 
            "]"}]}], "]"}]}]], "Input",
  InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{"cleanReadMAD9file", "[", "thickFile_String", "]"}], ":=", 
      RowBox[{"Module", "[", 
        RowBox[{
          RowBox[{"{", 
            RowBox[{"thick", ",", "thicknocomment", ",", "thicks"}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
            RowBox[{"thick", "=", 
              RowBox[{"ToUpperCase", "/@", 
                RowBox[{"ReadList", "[", 
                  RowBox[{"thickFile", ",", "Record", ",", 
                    RowBox[{"RecordSeparators", "\[Rule]", 
                      RowBox[{"{", "\"\<\\n\>\"", "}"}]}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"thicknocomment", "=", 
              RowBox[{
                RowBox[{
                  RowBox[{"If", "[", 
                    RowBox[{
                      RowBox[{"Not", "@", 
                        RowBox[{"StringMatchQ", "[", 
                          RowBox[{"#", ",", "\"\<*//*\>\""}], "]"}]}], ",", 
                      "#", ",", 
                      RowBox[{
                        RowBox[{"stripComment", "[", "#", "]"}], "<>", 
                        "\"\<;\>\""}]}], "]"}], "&"}], "/@", "thick"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"thicks", "=", 
              RowBox[{"FixedPoint", "[", 
                RowBox[{
                  RowBox[{
                    RowBox[{"StringReplace", "[", 
                      RowBox[{"#", ",", 
                        RowBox[{"{", 
                          RowBox[{
                            RowBox[{"\"\< ;\>\"", "\[Rule]", "\"\<;\>\""}], 
                            ",", 
                            RowBox[{"\"\<; \>\"", "\[Rule]", "\"\<;\>\""}], 
                            ",", 
                            RowBox[{"\"\< ,\>\"", "\[Rule]", "\"\<,\>\""}], 
                            ",", 
                            RowBox[{"\"\<, \>\"", "\[Rule]", "\"\<,\>\""}], 
                            ",", 
                            RowBox[{"\"\< :\>\"", "\[Rule]", "\"\<:\>\""}], 
                            ",", 
                            RowBox[{"\"\<: \>\"", "\[Rule]", "\"\<:\>\""}], 
                            ",", 
                            RowBox[{"\"\< =\>\"", "\[Rule]", "\"\<=\>\""}], 
                            ",", 
                            RowBox[{"\"\<= \>\"", "\[Rule]", "\"\<=\>\""}]}], 
                          "}"}]}], "]"}], "&"}], ",", 
                  RowBox[{"StringJoin", "@@", "thicknocomment"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"ReadList", "[", 
              RowBox[{
                RowBox[{"StringToStream", "[", "thicks", "]"}], ",", "Record",
                 ",", 
                RowBox[{"RecordSeparators", "\[Rule]", 
                  RowBox[{"{", "\"\<;\>\"", "}"}]}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"General", "::", "\<\"spell1\"\>"}], 
      RowBox[{
      ":", " "}], "\<\"Possible spelling error: new symbol name \
\\\"\\!\\(thicks\\)\\\" is similar to existing symbol \\\"\\!\\(thick\\)\\\".\
\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(cleanReadMAD8file[thinFile_String] := 
      Module[{thin, thinnocomment}, \[IndentingNewLine]thin = 
          ReadList[thinFile, Record, 
            RecordSeparators \[Rule] {"\<\n\>"}]; \
\[IndentingNewLine]thinnocomment = \(If[Not@StringMatchQ[#, "\<*!*\>"], #, 
                stripComment[#, "\<!\>"] <> "\<;\>"] &\) /@ 
            thin; \[IndentingNewLine]thins = 
          StringReplace[
            StringJoin @@ \((\((# <> "\<;\>" &)\) /@ 
                  thinnocomment)\), "\<;;\>" \[Rule] "\<;\>"]; \
\[IndentingNewLine]ReadList[
          StringToStream[StringReplace[thins, {"\<&;\>" \[Rule] "\<\>"}]], 
          Record, RecordSeparators \[Rule] {"\<;\>"}]\[IndentingNewLine]]\)], \
"Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"General", "::", "\<\"spell1\"\>"}], 
      RowBox[{
      ":", " "}], "\<\"Possible spelling error: new symbol name \
\\\"\\!\\(thins\\)\\\" is similar to existing symbol \\\"\\!\\(thin\\)\\\".\"\
\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    RowBox[{
      RowBox[{"MAD9label", "[", "s_String", "]"}], ":=", 
      RowBox[{"Module", "[", 
        RowBox[{
          RowBox[{"{", 
            RowBox[{
              RowBox[{"colpos", "=", 
                RowBox[{"StringPosition", "[", 
                  RowBox[{"s", ",", "\"\<:\>\""}], "]"}]}], ",", 
              RowBox[{"delpos", "=", 
                RowBox[{"StringPosition", "[", 
                  RowBox[{"s", ",", "\"\<:=\>\""}], "]"}]}]}], "}"}], ",", 
          RowBox[{"If", "[", 
            RowBox[{
              RowBox[{
                RowBox[{"colpos", "=!=", 
                  RowBox[{"{", "}"}]}], "&&", 
                RowBox[{
                  RowBox[{"colpos", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "=!=",
                   
                  RowBox[{"delpos", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
              ",", 
              RowBox[{"StringReplace", "[", 
                RowBox[{
                  RowBox[{"StringTake", "[", 
                    RowBox[{"s", ",", 
                      RowBox[{
                        RowBox[{"First", "[", 
                          RowBox[{"First", "[", "colpos", "]"}], "]"}], "-", 
                        "1"}]}], "]"}], ",", 
                  RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                "]"}], ",", "\"\<\>\""}], "]"}]}], "]"}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"MAD8label", "[", "s_String", "]"}], ":=", 
      RowBox[{"MAD9label", "[", "s", "]"}]}]], "Input",
  InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{"(*", " ", "developing", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
        RowBox[{"MAD9keyword", "[", "s_String", "]"}], ":=", 
        RowBox[{"Module", "[", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{
                RowBox[{"colpos", "=", 
                  RowBox[{"StringPosition", "[", 
                    RowBox[{"s", ",", "\"\<:\>\""}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"delpos", "=", 
                  RowBox[{"StringPosition", "[", 
                    RowBox[{"s", ",", "\"\<:=\>\""}], "]"}]}], ",", 
                "compos"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
              RowBox[{"key1", "=", 
                RowBox[{"If", "[", 
                  RowBox[{
                    RowBox[{
                      RowBox[{"colpos", "=!=", 
                        RowBox[{"{", "}"}]}], "&&", 
                      RowBox[{
                        RowBox[{"colpos", "\[LeftDoubleBracket]", 
                          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
                        "=!=", 
                        RowBox[{"delpos", "\[LeftDoubleBracket]", 
                          RowBox[{"1", ",", "1"}], 
                          "\[RightDoubleBracket]"}]}]}], ",", 
                    RowBox[{"colpos", "\[LeftDoubleBracket]", 
                      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",",
                     "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"compos", "=", 
                RowBox[{"StringPosition", "[", 
                  RowBox[{
                    RowBox[{"StringDrop", "[", 
                      RowBox[{"s", ",", 
                        RowBox[{"key1", "-", "1"}]}], "]"}], ",", 
                    "\"\<,\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"key2", "=", 
                RowBox[{"key1", "-", "1", "+", 
                  RowBox[{"If", "[", 
                    RowBox[{
                      RowBox[{"compos", "=!=", 
                        RowBox[{"{", "}"}]}], ",", 
                      RowBox[{"compos", "\[LeftDoubleBracket]", 
                        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
                      ",", 
                      RowBox[{
                        RowBox[{"StringLength", "[", "s", "]"}], "-", "key1", 
                        "+", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"StringTake", "[", 
                RowBox[{"s", ",", 
                  RowBox[{"{", 
                    RowBox[{
                      RowBox[{"key1", "+", "1"}], ",", 
                      RowBox[{"key2", "-", "1"}]}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"General", "::", "\<\"spell1\"\>"}], 
      RowBox[{
      ":", " "}], "\<\"Possible spelling error: new symbol name \
\\\"\\!\\(compos\\)\\\" is similar to existing symbol \
\\\"\\!\\(colpos\\)\\\".\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    RowBox[{
      RowBox[{"MAD8keyword", "[", "s_String", "]"}], ":=", 
      RowBox[{"MAD9keyword", "[", "s", "]"}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(MAD9multipoleList[s_String, type_String : "\<KN\>"] := 
      Module[{s1, kpos}, \[IndentingNewLine]s1 = 
          StringReplace[
            s, {"\<:=\>" \[Rule] "\<=\>"}]; \[IndentingNewLine]kpos = 
          StringPosition[s1, type <> "\<={\>"]; \[IndentingNewLine]If[
          kpos =!= {}, \[IndentingNewLine]s1 = 
            StringTake[s1, {First[First[kpos]] + 3, StringLength[s1]}]; 
          s1 = StringTake[
              s1, {1, First[
                  First[StringPosition[
                      s1, "\<}\>"]]]}]; \[IndentingNewLine]ToExpression[
            StringReplace[
              s1, {"\< \>" \[Rule] "\<\>", "\<{\>" \[Rule] "\<{\"\>", "\<,\>" \
\[Rule] "\<\",\"\>", "\<}\>" \[Rule] "\<\"}\>"}]], \[IndentingNewLine]{}\
\[IndentingNewLine]]\[IndentingNewLine]]\)], "Input",
  InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{"MAD8sliceParent", "[", "nam_String", "]"}], ":=", 
      RowBox[{"Module", "[", 
        RowBox[{
          RowBox[{"{", 
            RowBox[{"spos", "=", 
              RowBox[{"StringPosition", "[", 
                RowBox[{"nam", ",", "\"\<..\>\""}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
            RowBox[{
              RowBox[{"spos", "==", 
                RowBox[{"{", "}"}]}], ",", "Null", ",", 
              RowBox[{"StringTake", "[", 
                RowBox[{"nam", ",", 
                  RowBox[{
                    RowBox[{"spos", "\[LeftDoubleBracket]", 
                      RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-",
                     "1"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"General", "::", "\<\"spell1\"\>"}], 
      RowBox[{
      ":", " "}], "\<\"Possible spelling error: new symbol name \
\\\"\\!\\(spos\\)\\\" is similar to existing symbol \
\\\"\\!\\(kpos\\)\\\".\"\>"}]], "Message"]
}, Open  ]],

Cell["\<\
All the lines we have to fix contain radiation length in the form \
\",LRAD=123.4,\" because they were generated by MAD9.  We need a function to \
get hold of the radiation length. We also need a function to return the stem \
part of the element definition.  Combine these for efficiency.\
\>", "Text"],

Cell[BoxData[
    \(MAD8multipoleDefinition[kn_, ks_, lrad_] := 
      Module[{nmax = Max @@ \((Length /@ {kn, ks})\), kne, 
          kse}, \[IndentingNewLine]kne = 
          PadRight[kn, nmax, "\<0\>"]; \[IndentingNewLine]kse = 
          PadRight[ks, nmax, "\<0\>"]; \[IndentingNewLine]StringDrop[
          StringJoin @@ 
            Table[\[IndentingNewLine]Which[
                kne\[LeftDoubleBracket]
                      n\[RightDoubleBracket] \[Equal] "\<0\>" && 
                  kse\[LeftDoubleBracket]
                      n\[RightDoubleBracket] \[Equal] "\<0\>", "\<\>", \
\[IndentingNewLine]kse\[LeftDoubleBracket]
                    n\[RightDoubleBracket] \[Equal] "\<0\>", \
\[IndentingNewLine]"\<K\>" <> ToString[n - 1] <> "\<L=(\>" <> 
                  kne\[LeftDoubleBracket]n\[RightDoubleBracket] <> "\<)*(\>" <> 
                  lrad <> "\<),\>", \[IndentingNewLine]kne\[LeftDoubleBracket]
                    n\[RightDoubleBracket] \[Equal] "\<0\>", \
\[IndentingNewLine]"\<K\>" <> ToString[n - 1] <> "\<L=(\>" <> 
                  kse\[LeftDoubleBracket]n\[RightDoubleBracket] <> "\<)*(\>" <> 
                  lrad <> "\<),\>" <> \[IndentingNewLine]"\<T\>" <> 
                  ToString[n - 1] <> "\<=PI/\>" <> 
                  ToString[
                    n] <> "\<,\>", \[IndentingNewLine]True, \
\[IndentingNewLine]"\<K\>" <> ToString[n - 1] <> "\<L=SQRT((\>" <> 
                  kne\[LeftDoubleBracket]
                    n\[RightDoubleBracket] <> "\<)^2+(\>" <> 
                  kse\[LeftDoubleBracket]
                    n\[RightDoubleBracket] <> "\<)^2)*(\>" <> 
                  lrad <> "\<),\>" <> \[IndentingNewLine]"\<T\>" <> 
                  ToString[n - 1] <> "\<=ATAN2((\>" <> 
                  kse\[LeftDoubleBracket]n\[RightDoubleBracket] <> "\<),(\>" <> 
                  kne\[LeftDoubleBracket]n\[RightDoubleBracket] <> "\<))/\>" <> 
                  ToString[n] <> "\<,\>"\[IndentingNewLine]], {n, 1, 
                nmax}], \[IndentingNewLine]\(-1\)]\[IndentingNewLine]]\)], \
"Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"breakMAD8line", "[", "s_String", "]"}], ":=", 
      RowBox[{"Module", "[", 
        RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
            RowBox[{
              RowBox[{
                RowBox[{"StringLength", "[", "s", "]"}], "<", "80"}], ",", 
              "s", ",", "\[IndentingNewLine]", 
              RowBox[{
                RowBox[{"brk", "=", 
                  RowBox[{"Max", "[", 
                    RowBox[{"Select", "[", 
                      RowBox[{
                        RowBox[{"Flatten", "[", 
                          RowBox[{"compos", "=", 
                            RowBox[{"StringPosition", "[", 
                              RowBox[{"s", ",", "\"\<,\>\""}], "]"}]}], "]"}],
                         ",", 
                        RowBox[{
                          RowBox[{"#", "<", "72"}], "&"}]}], "]"}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"Flatten", "[", 
                  RowBox[{"{", 
                    RowBox[{
                      RowBox[{
                        RowBox[{"StringTake", "[", 
                          RowBox[{"s", ",", 
                            RowBox[{"{", 
                              RowBox[{"1", ",", "brk"}], "}"}]}], "]"}], 
                        "<>", "\"\<&\>\""}], ",", 
                      RowBox[{"breakMAD8line", "[", 
                        RowBox[{"\"\<     \>\"", "<>", 
                          RowBox[{"StringTake", "[", 
                            RowBox[{"s", ",", 
                              RowBox[{"{", 
                                RowBox[{
                                  RowBox[{"brk", "+", "1"}], ",", 
                                  RowBox[{"StringLength", "[", "s", "]"}]}], 
                                "}"}]}], "]"}]}], "]"}]}], "}"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
        "]"}]}]], "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Non-exported functions", "Subsection",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"stemLRAD", "[", "m8line_String", "]"}], ":=", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
          RowBox[{"{", 
            RowBox[{
              RowBox[{"lrpos", "=", 
                RowBox[{"StringPosition", "[", 
                  RowBox[{"m8line", ",", "\"\<,LRAD=\>\""}], "]"}]}], ",", 
              "tailpos", ",", "valLRAD"}], "}"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{
            RowBox[{"tailpos", "=", 
              RowBox[{"Min", "[", 
                RowBox[{"Select", "[", "\[IndentingNewLine]", 
                  RowBox[{
                    RowBox[{"First", "/@", 
                      RowBox[{"(", 
                        RowBox[{
                          RowBox[{"StringPosition", "[", 
                            RowBox[{"m8line", ",", "\"\<,\>\""}], "]"}], 
                          "\[Union]", 
                          RowBox[{"StringPosition", "[", 
                            RowBox[{"m8line", ",", "\"\<;\>\""}], "]"}]}], 
                        ")"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                      RowBox[{"#1", ">", 
                        RowBox[{"lrpos", "\[LeftDoubleBracket]", 
                          RowBox[{"1", ",", "1"}], 
                          "\[RightDoubleBracket]"}]}], "&"}]}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"tailpos", "=", 
              RowBox[{"Min", "[", 
                RowBox[{"tailpos", ",", 
                  RowBox[{
                    RowBox[{"StringLength", "[", "m8line", "]"}], "+", 
                    "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"valLRAD", "=", 
              RowBox[{"StringTake", "[", 
                RowBox[{"m8line", ",", 
                  RowBox[{"{", 
                    RowBox[{
                      RowBox[{
                        RowBox[{"lrpos", "\[LeftDoubleBracket]", 
                          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
                        "+", "1"}], ",", 
                      RowBox[{"tailpos", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"StringTake", "[", 
                  RowBox[{"m8line", ",", 
                    RowBox[{"tailpos", "-", "1"}]}], "]"}], ",", "valLRAD"}], 
              "}"}]}]}], "]"}]}]], "Input",
  InitializationCell->True],

Cell["\<\
This function codes what the present element is in relation to the original \
set of multipoles, either the thin version of the multipole itself, a clone \
of it or a slice of it.\
\>", "Text",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"relatedMultipole", "[", 
        RowBox[{"m8line_String", ",", "mnames_List"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
        RowBox[{
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
            RowBox[{
              RowBox[{"Position", "[", 
                RowBox[{"mnames", ",", 
                  RowBox[{"MAD8label", "[", "m8line", "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Position", "[", 
                RowBox[{"mnames", ",", 
                  RowBox[{"MAD8keyword", "[", "m8line", "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Position", "[", 
                RowBox[{"mnames", ",", 
                  RowBox[{"MAD8sliceParent", "[", 
                    RowBox[{"MAD8label", "[", "m8line", "]"}], "]"}]}], 
                "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"symboliseMultipoles", "[", 
        RowBox[{
        "m8line_String", ",", "mnames_List", ",", "mKN_List", ",", 
          "mKS_List"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
        RowBox[{
          RowBox[{"{", 
            RowBox[{"mp", ",", "stem", ",", "lradval"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
            RowBox[{
              RowBox[{"Not", "[", 
                RowBox[{"StringMatchQ", "[", 
                  RowBox[{"m8line", ",", "\"\<*,LRAD=*\>\""}], "]"}], "]"}], 
              ",", "\[IndentingNewLine]", "m8line", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(", 
                RowBox[{
                  RowBox[{
                    RowBox[{"{", 
                      RowBox[{"stem", ",", "lradval"}], "}"}], "=", 
                    RowBox[{"stemLRAD", "[", "m8line", "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                    RowBox[{
                      RowBox[{"IntegerQ", "[", 
                        RowBox[{"mp", "=", 
                          RowBox[{"First", "[", 
                            RowBox[{"Flatten", "[", 
                              RowBox[{"relatedMultipole", "[", 
                                RowBox[{"m8line", ",", "mnames"}], "]"}], 
                              "]"}], "]"}]}], "]"}], ",", 
                      "\[IndentingNewLine]", 
                      RowBox[{"stem", "<>", "\"\<,\>\"", "<>", 
                        RowBox[{"MAD8multipoleDefinition", "[", 
                          RowBox[{
                            RowBox[{
                            "mKN", "\[LeftDoubleBracket]", "mp", 
                              "\[RightDoubleBracket]"}], ",", 
                            RowBox[{
                            "mKS", "\[LeftDoubleBracket]", "mp", 
                              "\[RightDoubleBracket]"}], ",", "lradval"}], 
                          "]"}]}], "\[IndentingNewLine]", ",", "m8line"}], 
                    "]"}]}], ")"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}]], "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["End the private context", "Subsection",
  InitializationCell->True,
  CellTags->"Implementation section"],

Cell[CellGroupData[{

Cell["End[ ]", "Input",
  InitializationCell->True,
  CellTags->"Implementation section"],

Cell[BoxData["\<\"Madtomma`MadLanguage`SymboliseMultipoles`Private`\"\>"], \
"Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Epilog", "Section",
  InitializationCell->True,
  CellTags->"Epilog section"],

Cell["This section protects exported symbols and ends the package.", "Text",
  CellTags->"Epilog section"],

Cell[CellGroupData[{

Cell["Protect exported symbol", "Subsection",
  InitializationCell->True,
  CellTags->"Epilog section"],

Cell["Alternative: protect all exported symbols", "Text",
  InitializationCell->True,
  CellTags->"Epilog section"],

Cell["Protect[Evaluate[$Context <> \"*\"]]", "Input",
  Evaluatable->False,
  InitializationCell->True,
  CellTags->"Epilog section"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End the package context", "Subsection",
  InitializationCell->True,
  CellTags->"Epilog section"],

Cell["EndPackage[ ]", "Input",
  InitializationCell->True,
  CellTags->"Epilog section"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Basic documentation", "Section"],

Cell["\<\
A quick way  to document this package is to list the names of the functions \
it exports [1]:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Names["\<Madtomma`MadLanguage`SymboliseMultipoles`*\>"]\)], "Input",
  CellTags->"Setup section"],

Cell[BoxData[
    RowBox[{"{", "}"}]], "Output"]
}, Open  ]],

Cell["\<\
and then print their usage messages that say what they do.  Normally these \
messages are accessible by typing, e.g., \
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"?", "SymboliseMultipolesMAD8"}]], "Input"],

Cell[BoxData["\<\"Global`SymboliseMultipolesMAD8\"\>"], "Print"],

Cell[BoxData[
    InterpretationBox[GridBox[{
          {GridBox[{
                {
                  RowBox[{
                    RowBox[{"SymboliseMultipolesMAD8", "[", 
                      RowBox[{"thickFile_String", ",", "thinFile_String"}], 
                      "]"}], ":=", 
                    RowBox[{"Module", "[", 
                      RowBox[{
                        RowBox[{"{", 
                          RowBox[{
                          "thickclean", ",", "thickMultipoles", ",", 
                            "mnames"}], "}"}], ",", 
                        RowBox[{
                          RowBox[{"thickclean", "=", 
                            RowBox[{
                            "cleanReadMAD9file", "[", "thickFile", "]"}]}], 
                          ";", 
                          RowBox[{"thickMultipoles", "=", 
                            RowBox[{"Select", "[", 
                              RowBox[{"thickclean", ",", 
                                RowBox[{
                                  RowBox[{
                                    RowBox[{"StringMatchQ", "[", 
                                      RowBox[{"#1", ",", "\<\"*KN*{*}\"\>"}], 
                                      "]"}], "||", 
                                    RowBox[{"StringMatchQ", "[", 
                                      RowBox[{"#1", ",", "\<\"*KS*{*}\"\>"}], 
                                      "]"}]}], "&"}]}], "]"}]}], ";", 
                          RowBox[{"mnames", "=", 
                            RowBox[{"MAD9label", "/@", "thickMultipoles"}]}], 
                          ";"}]}], "]"}]}]}
                },
              GridBaseline->{Baseline, {1, 1}},
              ColumnWidths->0.999,
              ColumnAlignments->{Left}]}
          },
        GridBaseline->{Baseline, {1, 1}},
        ColumnAlignments->{Left}],
      Definition[ SymboliseMultipolesMAD8],
      Editable->False]], "Print"]
}, Open  ]],

Cell["\<\
but the following utility function generates the same information in \
formatted form (the following subsections!).\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    \(UsageNotebook[
      Names["\<Madtomma`MadLanguage`SymboliseMultipoles`*\>"]]\)], "Input"],

Cell[BoxData[
    InterpretationBox[\(NotebookObject[\[LeftSkeleton]"Untitled-1"\
\[RightSkeleton]]\),
      NotebookObject[ 
        FrontEndObject[ 
          LinkObject[ "p2c", 1, 1]], 16]]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples, Tests", "Section",
  CellTags->"Examples section"],

Cell[CellGroupData[{

Cell["Test for LHC", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(SetDirectory[
      testDir = "\<P:\\cern.ch\\eng\\lhc\\spdyn\\MAD9\\Problems\\ThinLens\>"]\
\)], "Input"],

Cell[BoxData[
    \("P:\\cern.ch\\eng\\lhc\\spdyn\\MAD9\\Problems\\ThinLens"\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(thinFile = "\<B1V6.1.thin.slice.seq\>"\)], "Input"],

Cell[BoxData[
    \("B1V6.1.thin.slice.seq"\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileInformation[thinFile]\)], "Input"],

Cell[BoxData[
    \({File \[Rule] 
        "P:\\cern.ch\\eng\\lhc\\spdyn\\MAD9\\Problems\\ThinLens\\B1V6.1.thin.\
slice.seq", FileType \[Rule] File, Date \[Rule] 3191744584, 
      ByteCount \[Rule] 980649}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(thickFile = 
      ToFileName[{"\<ldb.link\>"}, "\<B1B2V6.1.sep.seq\>"]\)], "Input"],

Cell[BoxData[
    \("ldb.link\\B1B2V6.1.sep.seq"\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileInformation[thickFile]\)], "Input"],

Cell[BoxData[
    \({}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Timing[
      SymboliseMultipolesMAD8[thickFile, 
        thinFile, "\<package.\>" <> thinFile]]\)], "Input"],

Cell[BoxData[
    \(ReadList::"nffil" \(\(:\)\(\ \)\) 
      "File not found during \
\!\(ReadList[\(\(\"ldb.link\\\\B1B2V6.1.sep.seq\", Record, \
\(\(RecordSeparators \[Rule] \(\({\"\\n\"}\)\)\)\)\)\)]\)."\)], "Message"],

Cell[BoxData[
    \($Aborted\)], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test on small example", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(SetDirectory["\<SmallExample\>"]\)], "Input"],

Cell[BoxData[
    \("P:\\cern.ch\\eng\\lhc\\spdyn\\MAD9\\Problems\\ThinLens\\SmallExample"\)\
], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(SymboliseMultipolesMAD8["\<small.mad\>", "\<thinlittle.mad\>", \
"\<package.thinlittle.mad\>"]\)], "Input"],

Cell[BoxData[
    \(Part::"partw" \(\(:\)\(\ \)\) 
      "Part \!\(1\) of \!\({}\) does not exist."\)], "Message"],

Cell[BoxData[
    \(Part::"partw" \(\(:\)\(\ \)\) 
      "Part \!\(1\) of \!\({}\) does not exist."\)], "Message"],

Cell[BoxData[
    \(Part::"partw" \(\(:\)\(\ \)\) 
      "Part \!\(1\) of \!\({}\) does not exist."\)], "Message"],

Cell[BoxData[
    \(General::"stop" \(\(:\)\(\ \)\) 
      "Further output of \!\(Part :: \"partw\"\) will be suppressed during \
this calculation."\)], "Message"],

Cell[BoxData[
    \("package.thinlittle.mad"\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Import["\<package.thinlittle.mad\>", "\<Text\>"]\)], "Input"],

Cell[BoxData[
    \("!! <MAD8 file processed by SymboliseMultipoles.m>;\n!! <MAD Version 8 \
data, created by MAD Version 9.>;\n!! <Parameter definitions>;\n\
BRHO:=P0/P0TESLA;\nJMJECHO=1;\nJMJINFO=1;\nJMJMAD8=0;\nJMJTFS=1;\nJMJTRACE=1;\
\nJMJVERIFY=0;\nJMJWARN=1;\nN0:=2;\nN1:=3;\nN2:=0;\nN3:=7;\nP0:=1;\n\
P0TESLA:CONSTANT=0.299792;\nS0:=11;\nS1:=13;\nS2:=17;\n!! </Parameter \
definitions>;\n!! <Element definitions>;\n\
M1:MULTIPOLE,LRAD=5,K0L=(N0)*(5),K1L=(N1)*(5),K2L=(N2)*(5),K3L=(N3)*(5);\n\
M2:MULTIPOLE,LRAD=7,K0L=SQRT((N0-7)^2+(S0)^2)*(7),T0=ATAN2((S0),&\n     \
(N0-7))/1,K1L=(N1+SQRT(N1*N2/3))*(7),K2L=SQRT((N2)^2+(2)^2)*(7),&\n     \
T2=ATAN2((2),(N2))/3,K3L=(N3)*(7);\nTOYD:DRIFT,L=1.23457;\n!! </Element \
definitions>;\n!! <Line (and split element) definitions>;\n\
M1..1:M1,LRAD=1.66667,K0L=(N0)*(1.66667),K1L=(N1)*(1.66667),&\n     \
K2L=(N2)*(1.66667),K3L=(N3)*(1.66667);\n\
M1..2:M1,LRAD=1.66667,K0L=(N0)*(1.66667),K1L=(N1)*(1.66667),&\n     \
K2L=(N2)*(1.66667),K3L=(N3)*(1.66667);\n\
M1..3:M1,LRAD=1.66667,K0L=(N0)*(1.66667),K1L=(N1)*(1.66667),&\n     \
K2L=(N2)*(1.66667),K3L=(N3)*(1.66667);\n\
M2..1:M2,LRAD=2.33333,K0L=SQRT((N0-7)^2+(S0)^2)*(2.33333),&\n     \
T0=ATAN2((S0),(N0-7))/1,K1L=(N1+SQRT(N1*N2/3))*(2.33333),&\n     \
K2L=SQRT((N2)^2+(2)^2)*(2.33333),T2=ATAN2((2),(N2))/3,K3L=(N3)*(2.33333);\n\
M2..2:M2,LRAD=2.33333,K0L=SQRT((N0-7)^2+(S0)^2)*(2.33333),&\n     \
T0=ATAN2((S0),(N0-7))/1,K1L=(N1+SQRT(N1*N2/3))*(2.33333),&\n     \
K2L=SQRT((N2)^2+(2)^2)*(2.33333),T2=ATAN2((2),(N2))/3,K3L=(N3)*(2.33333);\n\
M2..3:M2,LRAD=2.33333,K0L=SQRT((N0-7)^2+(S0)^2)*(2.33333),&\n     \
T0=ATAN2((S0),(N0-7))/1,K1L=(N1+SQRT(N1*N2/3))*(2.33333),&\n     \
K2L=SQRT((N2)^2+(2)^2)*(2.33333),T2=ATAN2((2),(N2))/3,K3L=(N3)*(2.33333);\n\
LITTLE:SEQUENCE,REFER=\"CENTRE\";\n  M1..1,AT=3.125;\n  M1..2,AT=5;\n  \
M1..3,AT=6.875;\n  M2..1,AT=17.375;\n  M2..2,AT=20;\n  M2..3,AT=22.625;\n  \
MARKER,AT=30;\nENDSEQUENCE;\nTOYLINE:LINE=(TOYD);\n!! </Line (and split \
element) definitions>;\n!! <Special definitions>;\n!! </Special definitions>;\
\n!! </MAD Version 8 data, created by MAD Version 9.>;\n!! </MAD8 file \
processed by SymboliseMultipoles.m>;\n"\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(explorer[]\)], "Input"],

Cell[BoxData[
    \("P:\\cern.ch\\eng\\lhc\\spdyn\\MAD9\\Problems\\ThinLens\\SmallExample"\)\
], "Output"]
}, Open  ]],

Cell[BoxData[
    StyleBox[\(Needs["\<Madtomma`RunningMAD`\>"]\),
      "Input"]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(runMAD["\<package.thinlittle.mad\>"]\)], "Input"],

Cell[BoxData[
    \({"1\"MAD\" Version 8.51/07 Win32                      Copyright (C) \
1990 by CERN.", 
      "                                                  24/10/01     \
15.54.26", " ", " Input stream and message log:", " ", " ", 
      " MAD.     Reading standard input file.", " ", 
      "               !! <MAD8 file processed by SymboliseMultipoles.m>;      \
                        ", 
      "               !! <MAD Version 8 data, created by MAD Version 9.>;     \
                        ", 
      "               !! <Parameter definitions>;                             \
                        ", 
      "               BRHO:=P0/P0TESLA;                                       \
                        ", 
      "         5     JMJECHO=1;                                              \
                        ", 
      "               JMJINFO=1;                                              \
                        ", 
      "               JMJMAD8=0;                                              \
                        ", 
      "               JMJTFS=1;                                               \
                        ", 
      "               JMJTRACE=1;                                             \
                        ", 
      "        10     JMJVERIFY=0;                                            \
                        ", 
      "               JMJWARN=1;                                              \
                        ", 
      "               N0:=2;                                                  \
                        ", 
      "               N1:=3;                                                  \
                        ", 
      "               N2:=0;                                                  \
                        ", 
      "        15     N3:=7;                                                  \
                        ", 
      "               P0:=1;                                                  \
                        ", 
      "               P0TESLA:CONSTANT=0.299792;                              \
                        ", 
      "               S0:=11;                                                 \
                        ", 
      "               S1:=13;                                                 \
                        ", 
      "        20     S2:=17;                                                 \
                        ", 
      "               !! </Parameter definitions>;                            \
                        ", 
      "               !! <Element definitions>;                               \
                        ", 
      "               \
M1:MULTIPOLE,LRAD=5,K0L=(N0)*(5),K1L=(N1)*(5),K2L=(N2)*(5),K3L=(N3)*(5);      \
  ", "               \
M2:MULTIPOLE,LRAD=7,K0L=SQRT((N0-7)^2+(S0)^2)*(7),T0=ATAN2((S0),&             \
  ", "        25          \
(N0-7))/1,K1L=(N1+SQRT(N1*N2/3))*(7),K2L=SQRT((N2)^2+(2)^2)*(7),&          ", 
      "                    T2=ATAN2((2),(N2))/3,K3L=(N3)*(7);                 \
                        ", 
      "               TOYD:DRIFT,L=1.23457;                                   \
                        ", 
      "               !! </Element definitions>;                              \
                        ", 
      "               !! <Line (and split element) definitions>;              \
                        ", 
      "        30     \
M1..1:M1,LRAD=1.66667,K0L=(N0)*(1.66667),K1L=(N1)*(1.66667),&                 \
  ", "                    K2L=(N2)*(1.66667),K3L=(N3)*(1.66667);              \
                       ", 
      "               \
M1..2:M1,LRAD=1.66667,K0L=(N0)*(1.66667),K1L=(N1)*(1.66667),&                 \
  ", "                    K2L=(N2)*(1.66667),K3L=(N3)*(1.66667);              \
                       ", 
      "               \
M1..3:M1,LRAD=1.66667,K0L=(N0)*(1.66667),K1L=(N1)*(1.66667),&                 \
  ", "        35          K2L=(N2)*(1.66667),K3L=(N3)*(1.66667);              \
                       ", 
      "               \
M2..1:M2,LRAD=2.33333,K0L=SQRT((N0-7)^2+(S0)^2)*(2.33333),&                   \
  ", "                    \
T0=ATAN2((S0),(N0-7))/1,K1L=(N1+SQRT(N1*N2/3))*(2.33333),&                 ", 
      "                    \
K2L=SQRT((N2)^2+(2)^2)*(2.33333),T2=ATAN2((2),(N2))/3,K3L=(N3)*(2.33333);  ", 
      "               \
M2..2:M2,LRAD=2.33333,K0L=SQRT((N0-7)^2+(S0)^2)*(2.33333),&                   \
  ", "        40          \
T0=ATAN2((S0),(N0-7))/1,K1L=(N1+SQRT(N1*N2/3))*(2.33333),&                 ", 
      "                    \
K2L=SQRT((N2)^2+(2)^2)*(2.33333),T2=ATAN2((2),(N2))/3,K3L=(N3)*(2.33333);  ", 
      "               \
M2..3:M2,LRAD=2.33333,K0L=SQRT((N0-7)^2+(S0)^2)*(2.33333),&                   \
  ", "                    \
T0=ATAN2((S0),(N0-7))/1,K1L=(N1+SQRT(N1*N2/3))*(2.33333),&                 ", 
      "                    \
K2L=SQRT((N2)^2+(2)^2)*(2.33333),T2=ATAN2((2),(N2))/3,K3L=(N3)*(2.33333);  ", 
      "        45     LITTLE:SEQUENCE,REFER=\"CENTRE\";                       \
                          ", 
      "                 M1..1,AT=3.125;                                       \
                        ", 
      "                 M1..2,AT=5;                                           \
                        ", 
      "                 M1..3,AT=6.875;                                       \
                        ", 
      "                 M2..1,AT=17.375;                                      \
                        ", 
      "        50       M2..2,AT=20;                                          \
                        ", 
      "                 M2..3,AT=22.625;                                      \
                        ", 
      "                 MARKER,AT=30;                                         \
                        ", 
      "               ENDSEQUENCE;                                            \
                        ", 
      "               TOYLINE:LINE=(TOYD);                                    \
                        ", 
      "        55     !! </Line (and split element) definitions>;             \
                        ", 
      "               !! <Special definitions>;                               \
                        ", 
      "               !! </Special definitions>;                              \
                        ", 
      "               !! </MAD Version 8 data, created by MAD Version 9.>;    \
                        ", 
      "               !! </MAD8 file processed by SymboliseMultipoles.m>;     \
                        ", 
      "               END_FILE! *** Generated line ***                        \
                        ", " ", 
      " ZEND.          MAD terminated on 24/10/01 at 15.54.26", " ", 
      " MZEND.   Usage statistics for  1 dynamic stores.", 
      "   Map of store  0 / /     ", "   ------------------------", 
      "   Division                                        Number of times", 
      "              Kind                Max-size                Garb-coll.", 
      "            Mode    Position      used   allowed   Wiped  user  auto \
Pushd Redcd", 
      "    1 QDIV1    0 1         9         0  32000006       0     0     0   \
  0     0", 
      "    2 QDIV2    1 1  31999606    132962  32000006       0     0     0   \
  0     0", 
      "   20 system   1 8  32000006       111  32000006       0     0     0   \
  0     0"}\)], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bibliography", "Section"],

Cell[TextData[{
  StyleBox["[1] Stephen Wolfram, ", "SR"],
  StyleBox["The Mathematica Book", "SO",
    FontSlant->"Italic"],
  StyleBox[
  ", 3rd ed., Wolfram Media/Cambridge University Press, 1996.", "SR"]
}], "Text",
  CellTags->"Wolfram book"],

Cell[TextData[{
  "[2]  Roman Maeder, ",
  StyleBox["Programming in Mathematica",
    FontSlant->"Italic"],
  ", 3rd ed. Addison-Wesley, 1996"
}], "Text",
  CellTags->"Maeder book"],

Cell["\<\
[3] Hans Grote, F. Christoph Iselin, The MAD Program, User's Reference \
Manual, CERN/SL/90-13 (AP), and \
\>", "Text",
  CellTags->"MAD manual"],

Cell[TextData[ButtonBox["http://wwwslap.cern.ch/mad/",
  ButtonData:>{
    URL[ "http://wwwslap.cern.ch/mad/"], None},
  ButtonStyle->"Hyperlink"]], "Program"]
}, Closed]]
}, Open  ]]
},
FrontEndVersion->"4.1 for Microsoft Windows",
ScreenRectangle->{{0, 1280}, {0, 951}},
AutoGeneratedPackage->Automatic,
Evaluator->"Local",
InitializationCellEvaluation->False,
CellGrouping->Automatic,
WindowSize->{944, 822},
WindowMargins->{{Automatic, 125}, {32, Automatic}},
PrivateNotebookOptions->{"ColorPalette"->{RGBColor, 128}},
ShowCellLabel->True,
RenderingOptions->{"ObjectDithering"->True,
"RasterDithering"->False},
StyleDefinitions -> Notebook[{
  
  Cell[CellGroupData[{
  Cell["Style Definitions", "Subtitle"],
  
  Cell["\<\
Modify the definitions below to change the default appearance of all cells in \
a given style.
Make modifications to any definition using commands in the Format menu.\
\>", "Text"],
  
  Cell[CellGroupData[{
  
  Cell["Style Environment Names", "Section"],
  
  Cell[StyleData[All, "Working"],
    PageWidth->WindowWidth,
    CellBracketOptions->{"Color"->RGBColor[0.4, 0, 0.239994]},
    ScriptMinSize->9,
    Background->None],
  
  Cell[StyleData[All, "Presentation"],
    PageWidth->PaperWidth,
    CellBracketOptions->{"Color"->RGBColor[0, 0, 1]},
    ScriptMinSize->9],
  
  Cell[StyleData[All, "Printout"],
    PageWidth->PaperWidth,
    ShowCellLabel->False,
    ImageSize->{200, 200},
    PrivateFontOptions->{"FontType"->"Outline"}]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell["Notebook Options", "Section"],
  
  Cell["\<\
The options defined for the style below will be used at the Notebook level.\
\>", "Text"],
  
  Cell[StyleData["Notebook"],
    PageHeaders->{{Cell[ 
            TextData[ {
              CounterBox[ "Page"]}], "PageNumber"], None, Cell[ 
            TextData[ {
              ValueBox[ "FileName"]}], "Header"]}, {Cell[ 
            TextData[ {
              ValueBox[ "FileName"]}], "Header"], None, Cell[ 
            TextData[ {
              CounterBox[ "Page"]}], "PageNumber"]}},
    CellFrameLabelMargins->6,
    StyleMenuListing->None]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell["Styles for Headings", "Section"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Title"],
    CellFrame->{{0, 0}, {0, 0.25}},
    CellMargins->{{18, 10}, {0, 20}},
    CellGroupingRules->{"TitleGrouping", 0},
    PageBreakBelow->False,
    CellFrameMargins->6,
    CellFrameColor->GrayLevel[0],
    LineSpacing->{0.95, 0},
    CounterAssignments->{{"Section", 0}, {"Equation", 0}, {"Figure", 0}},
    FontFamily->"Helvetica",
    FontSize->36,
    FontWeight->"Bold",
    FontColor->RGBColor[0.4, 0, 0.239994]],
  
  Cell[StyleData["Title", "Presentation"],
    CellMargins->{{20, 10}, {2, 20}},
    CellFrameMargins->5,
    FontColor->RGBColor[0, 0, 1]],
  
  Cell[StyleData["Title", "Printout"],
    CellMargins->{{18, 30}, {0, 0}},
    CellFrameMargins->4,
    FontSize->24]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Subtitle"],
    CellMargins->{{20, 30}, {2, 10}},
    CellGroupingRules->{"TitleGrouping", 10},
    PageBreakBelow->False,
    CellFrameMargins->{{0, 4}, {8, 4}},
    LineSpacing->{1, 0},
    CounterAssignments->{{"Section", 0}, {"Equation", 0}, {"Figure", 0}},
    FontFamily->"Helvetica",
    FontSize->24],
  
  Cell[StyleData["Subtitle", "Presentation"],
    CellMargins->{{20, 10}, {2, 10}}],
  
  Cell[StyleData["Subtitle", "Printout"],
    CellMargins->{{18, 30}, {0, 10}},
    FontSize->18]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Section 1"],
    CellFrame->{{0, 0}, {0, 3}},
    CellMargins->{{18, 10}, {10, 30}},
    CellGroupingRules->{"SectionGrouping", 40},
    PageBreakBelow->False,
    CellFrameMargins->{{0, 4}, {8, 4}},
    CellFrameColor->RGBColor[0.4, 0, 0.239994],
    CounterIncrements->"Section",
    CounterAssignments->{{"Subsection", 0}, {"Subsubsection", 0}},
    FontFamily->"Helvetica",
    FontSize->18,
    FontWeight->"Bold"],
  
  Cell[StyleData["Section 1", "Presentation"],
    CellMargins->{{20, 10}, {6, 30}},
    CellFrameMargins->5],
  
  Cell[StyleData["Section 1", "Printout"],
    CellMargins->{{18, 30}, {4, 30}},
    CellFrameMargins->4,
    FontSize->14]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Section"],
    CellFrame->False,
    CellMargins->{{18, 10}, {10, 30}},
    CellGroupingRules->{"SectionGrouping", 40},
    PageBreakBelow->False,
    CellFrameMargins->4,
    CellFrameLabels->{{Cell[ 
            TextData[ {
              CounterBox[ "Section"]}]], None}, {None, None}},
    CounterIncrements->"Section",
    CounterAssignments->{{"Subsection", 0}, {"Subsubsection", 0}},
    FontFamily->"Helvetica",
    FontSize->18,
    FontWeight->"Bold"],
  
  Cell[StyleData["Section", "Presentation"],
    CellMargins->{{20, 10}, {0, 30}}],
  
  Cell[StyleData["Section", "Printout"],
    CellMargins->{{18, 30}, {0, 30}},
    CellFrameMargins->5,
    FontSize->14]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Subsection"],
    CellDingbat->None,
    CellMargins->{{38, 30}, {2, 20}},
    CellGroupingRules->{"SectionGrouping", 50},
    PageBreakBelow->False,
    CellFrameLabels->{{Cell[ 
            TextData[ {
              CounterBox[ "Section"], ".", 
              CounterBox[ "Subsection"]}]], None}, {None, None}},
    CounterIncrements->"Subsection",
    CounterAssignments->{{"Subsubsection", 0}},
    FontFamily->"Times",
    FontSize->14,
    FontWeight->"Bold"],
  
  Cell[StyleData["Subsection", "Presentation"],
    CellMargins->{{35, 30}, {0, 20}}],
  
  Cell[StyleData["Subsection", "Printout"],
    CellMargins->{{18, 30}, {0, 10}},
    FontSize->12]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Subsubsection"],
    CellDingbat->None,
    CellMargins->{{55, 30}, {4, 10}},
    CellGroupingRules->{"SectionGrouping", 60},
    PageBreakBelow->False,
    CellFrameLabels->{{Cell[ 
            TextData[ {
              CounterBox[ "Section"], ".", 
              CounterBox[ "Subsection"], ".", 
              CounterBox[ "Subsubsection"]}]], None}, {None, None}},
    CounterIncrements->"Subsubsection",
    FontFamily->"Times",
    FontSize->12,
    FontWeight->"Bold"],
  
  Cell[StyleData["Subsubsection", "Presentation"],
    CellMargins->{{31, 30}, {0, 12}}],
  
  Cell[StyleData["Subsubsection", "Printout"],
    CellMargins->{{18, 30}, {0, 12}},
    FontSize->10]
  }, Open  ]]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell["Styles for Body Text", "Section"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Text"],
    CellMargins->{{55, 10}, {6, 6}},
    TextJustification->1,
    LineSpacing->{1, 2},
    FontFamily->"Times"],
  
  Cell[StyleData["Text", "Presentation"],
    CellMargins->{{20, 10}, {6, 6}},
    TextAlignment->Left,
    TextJustification->0,
    LineSpacing->{1.3, 0},
    FontSize->14],
  
  Cell[StyleData["Text", "Printout"],
    CellMargins->{{18, 4}, {4, 4}},
    LineSpacing->{1, 3},
    FontSize->10]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Commentary"],
    CellMargins->{{55, 10}, {2, 6}},
    TextJustification->1,
    LineSpacing->{1, 2},
    FontFamily->"Helvetica",
    FontSize->10,
    FontColor->RGBColor[0, 0, 0.4]],
  
  Cell[StyleData["Commentary", "Presentation"],
    CellMargins->{{60, 30}, {2, 6}},
    TextJustification->1,
    LineSpacing->{1.3, 0},
    FontSize->12],
  
  Cell[StyleData["Commentary", "Printout"],
    CellMargins->{{18, 30}, {3, 0}},
    LineSpacing->{1, 3},
    FontFamily->"Times",
    FontSize->10]
  }, Open  ]]
  }, Closed]],
  
  Cell[CellGroupData[{
  
  Cell["Styles for Input/Output", "Section"],
  
  Cell["\<\
The cells in this section define styles used for input and output to the \
kernel.  Be careful when modifying, renaming, or removing these styles, \
because the front end associates special meanings with these style names.\
\>", "Text"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Input"],
    CellFrame->{{1, 1}, {0, 1}},
    CellMargins->{{55, 10}, {0, 0}},
    Evaluatable->True,
    CellGroupingRules->"InputGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    GroupPageBreakWithin->False,
    CellLabelPositioning->Automatic,
    CellLabelMargins->{{23, Inherited}, {Inherited, Inherited}},
    DefaultFormatType->DefaultInputFormatType,
    FormatType->InputForm,
    ShowStringCharacters->True,
    NumberMarks->True,
    FontSize->12,
    FontWeight->"Bold",
    Background->None],
  
  Cell[StyleData["Input", "Presentation"],
    CellMargins->{{60, 10}, {0, 10}},
    Background->None],
  
  Cell[StyleData["Input", "Printout"],
    CellMargins->{{55, 10}, {0, 10}},
    FontSize->10,
    Background->None]
  }, Open  ]],
  
  Cell[StyleData["InlineInput"],
    Evaluatable->True,
    CellGroupingRules->"InputGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    GroupPageBreakWithin->False,
    DefaultFormatType->DefaultInputFormatType,
    AutoItalicWords->{},
    FormatType->InputForm,
    ShowStringCharacters->True,
    NumberMarks->True,
    CounterIncrements->"Input",
    FontWeight->"Bold"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Output"],
    CellFrame->{{1, 1}, {1, 0}},
    CellMargins->{{55, 10}, {15, 0}},
    CellEditDuplicate->True,
    CellGroupingRules->"OutputGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    GroupPageBreakWithin->False,
    GeneratedCell->True,
    CellAutoOverwrite->True,
    CellLabelMargins->{{23, Inherited}, {Inherited, Inherited}},
    DefaultFormatType->DefaultOutputFormatType,
    FormatType->InputForm,
    FontSize->12,
    Background->None],
  
  Cell[StyleData["Output", "Presentation"],
    CellMargins->{{60, Inherited}, {10, 0}},
    Background->None],
  
  Cell[StyleData["Output", "Printout"],
    CellMargins->{{55, Inherited}, {10, 0}},
    FontSize->10,
    Background->None]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["InputOnly"],
    CellFrame->1,
    CellMargins->{{55, 10}, {15, 0}},
    Evaluatable->True,
    CellGroupingRules->"InputGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    GroupPageBreakWithin->False,
    CellLabelPositioning->Automatic,
    CellLabelMargins->{{23, Inherited}, {Inherited, Inherited}},
    DefaultFormatType->DefaultInputFormatType,
    FormatType->InputForm,
    ShowStringCharacters->True,
    NumberMarks->True,
    FontSize->12,
    FontWeight->"Bold",
    Background->GrayLevel[0.966674]],
  
  Cell[StyleData["InputOnly", "Presentation"],
    CellMargins->{{60, Inherited}, {10, 10}}],
  
  Cell[StyleData["InputOnly", "Printout"],
    CellMargins->{{55, Inherited}, {10, 10}},
    FontSize->10]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Message"],
    CellFrame->{{1, 1}, {0, 0}},
    CellDingbat->"\[LongDash]",
    CellMargins->{{55, 10}, {0, 0}},
    CellGroupingRules->"OutputGrouping",
    PageBreakWithin->False,
    GroupPageBreakWithin->False,
    GeneratedCell->True,
    CellAutoOverwrite->True,
    ShowCellLabel->False,
    CellLabelMargins->{{23, Inherited}, {Inherited, Inherited}},
    DefaultFormatType->DefaultOutputFormatType,
    FormatType->InputForm,
    StyleMenuListing->None,
    FontFamily->"Helvetica",
    FontSize->10,
    FontSlant->"Oblique",
    FontColor->GrayLevel[0],
    Background->GrayLevel[1]],
  
  Cell[StyleData["Message", "Presentation"],
    CellMargins->{{60, Inherited}, {Inherited, Inherited}},
    LineSpacing->{1, 0}],
  
  Cell[StyleData["Message", "Printout"],
    CellMargins->{{55, Inherited}, {0, 0}},
    FontSize->8]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Print"],
    CellFrame->True,
    CellMargins->{{55, 26}, {1, 6}},
    CellGroupingRules->"OutputGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    GroupPageBreakWithin->False,
    GeneratedCell->True,
    CellAutoOverwrite->True,
    ShowCellLabel->False,
    CellLabelMargins->{{23, Inherited}, {Inherited, Inherited}},
    DefaultFormatType->DefaultOutputFormatType,
    TextAlignment->Left,
    FormatType->InputForm,
    StyleMenuListing->None,
    FontSize->9,
    Background->GrayLevel[0.849989]],
  
  Cell[StyleData["Print", "Presentation"],
    CellFrame->True,
    CellMargins->{{60, Inherited}, {10, 2}},
    Background->GrayLevel[0.849989]],
  
  Cell[StyleData["Print", "Printout"],
    CellFrame->True,
    CellMargins->{{54, Inherited}, {2, 6}},
    FontSize->10,
    Background->GrayLevel[0.849989]]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Graphics"],
    CellFrame->{{1, 1}, {0, 0}},
    CellMargins->{{55, 10}, {0, 0}},
    CellGroupingRules->"GraphicsGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    GeneratedCell->True,
    CellAutoOverwrite->True,
    ShowCellLabel->False,
    DefaultFormatType->DefaultOutputFormatType,
    FormatType->InputForm,
    ImageSize->{288, 288},
    ImageMargins->{{35, Inherited}, {Inherited, 0}},
    StyleMenuListing->None,
    Background->GrayLevel[1]],
  
  Cell[StyleData["Graphics", "Presentation"],
    CellMargins->{{60, Inherited}, {0, 0}},
    ImageMargins->{{10, 10}, {10, 10}}],
  
  Cell[StyleData["Graphics", "Printout"],
    CellMargins->{{55, Inherited}, {0, 0}},
    ImageSize->{288, 288}]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["CellLabel"],
    StyleMenuListing->None,
    FontFamily->"Helvetica",
    FontSize->10,
    FontSlant->"Oblique",
    FontColor->RGBColor[0, 0, 1]],
  
  Cell[StyleData["CellLabel", "Presentation"],
    CellMargins->{{18, Inherited}, {Inherited, Inherited}}],
  
  Cell[StyleData["CellLabel", "Printout"],
    CellMargins->{{0, Inherited}, {Inherited, Inherited}},
    FontSize->8]
  }, Open  ]]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell["Unique Styles", "Section"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Author"],
    CellMargins->{{20, 30}, {45, 5}},
    CellGroupingRules->{"TitleGrouping", 20},
    PageBreakBelow->False,
    CellFrameMargins->{{0, 4}, {8, 4}},
    LineSpacing->{1, 0},
    CounterAssignments->{{"Section", 0}, {"Equation", 0}, {"Figure", 0}},
    FontFamily->"Helvetica",
    FontSize->16,
    FontSlant->"Italic"],
  
  Cell[StyleData["Author", "Presentation"],
    CellMargins->{{20, 30}, {45, 10}},
    FontSize->18],
  
  Cell[StyleData["Author", "Printout"],
    CellMargins->{{18, 30}, {45, 5}},
    FontSize->16]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Abstract"],
    CellFrame->False,
    CellMargins->{{18, 140}, {4, 30}},
    LineSpacing->{0.9, 0},
    FontFamily->"Times",
    FontSize->12],
  
  Cell[StyleData["Abstract", "Presentation"],
    CellFrame->True,
    CellMargins->{{20, 10}, {Inherited, 30}}],
  
  Cell[StyleData["Abstract", "Printout"],
    LineSpacing->{1, 2},
    FontSize->10]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Caption"],
    CellMargins->{{55, 10}, {5, 3}},
    FontFamily->"Helvetica",
    FontSize->9],
  
  Cell[StyleData["Caption", "Presentation"],
    CellMargins->{{60, 65}, {6, 4}},
    FontSize->10],
  
  Cell[StyleData["Caption", "Printout"],
    CellMargins->{{55, 55}, {5, 4}},
    LineSpacing->{1, 2},
    FontSize->8]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Reference"],
    CellMargins->{{24, 40}, {6, 6}},
    TextJustification->1,
    LineSpacing->{1, 0},
    FontFamily->"Times"],
  
  Cell[StyleData["Reference", "Presentation"],
    CellMargins->{{20, 40}, {Inherited, 6}},
    TextJustification->0,
    LineSpacing->{1, 4},
    FontSize->12],
  
  Cell[StyleData["Reference", "Printout"],
    CellMargins->{{18, 4}, {4, 4}},
    FontSize->9]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["PictureGroup"],
    CellFrame->{{1, 1}, {0, 0}},
    CellMargins->{{55, Inherited}, {0, 0}},
    CellGroupingRules->"GraphicsGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    ShowCellLabel->False,
    ImageMargins->{{35, Inherited}, {Inherited, 0}},
    StyleMenuListing->None,
    Background->None],
  
  Cell[StyleData["PictureGroup", "Presentation"],
    CellMargins->{{60, Inherited}, {0, 0}},
    ImageMargins->{{10, 10}, {10, 10}},
    Background->None],
  
  Cell[StyleData["PictureGroup", "Printout"],
    CellMargins->{{55, Inherited}, {0, 0}},
    ImageSize->{288, 288},
    Background->None]
  }, Open  ]]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell["Formulas and Programming", "Section"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["DisplayFormula"],
    CellMargins->{{55, Inherited}, {Inherited, Inherited}},
    CellHorizontalScrolling->True,
    ScriptLevel->0,
    SingleLetterItalics->True,
    StyleMenuListing->None,
    UnderoverscriptBoxOptions->{LimitsPositioning->True}],
  
  Cell[StyleData["DisplayFormula", "Presentation"],
    CellMargins->{{60, 10}, {Inherited, 6}},
    LineSpacing->{1, 5}],
  
  Cell[StyleData["DisplayFormula", "Printout"],
    CellMargins->{{18, 4}, {4, 4}}]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["ChemicalFormula"],
    CellMargins->{{55, 10}, {Inherited, 0}},
    CellHorizontalScrolling->True,
    TextJustification->1,
    AutoSpacing->False,
    ScriptLevel->1,
    ScriptBaselineShifts->{0.6, Automatic},
    SingleLetterItalics->False,
    ZeroWidthTimes->True],
  
  Cell[StyleData["ChemicalFormula", "Presentation"],
    CellMargins->{{60, 10}, {Inherited, 6}}],
  
  Cell[StyleData["ChemicalFormula", "Printout"],
    CellMargins->{{18, 4}, {4, 4}},
    LineSpacing->{1, 3},
    FontSize->10]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Program"],
    CellMargins->{{55, 10}, {Inherited, 0}},
    CellHorizontalScrolling->True,
    FontFamily->"Courier"],
  
  Cell[StyleData["Program", "Presentation"],
    CellMargins->{{60, 10}, {Inherited, 6}}],
  
  Cell[StyleData["Program", "Printout"],
    CellMargins->{{18, 4}, {4, 4}},
    LineSpacing->{1, 3},
    FontSize->9.5]
  }, Open  ]]
  }, Closed]],
  
  Cell[CellGroupData[{
  
  Cell["Styles for Automatic Numbering", "Section"],
  
  Cell["\<\
The following styles are useful for numbered equations, figures, etc.  They \
automatically give the cell a FrameLabel containing a reference to a \
particular counter, and also increment that counter.\
\>", "Text"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["NumberedEquation"],
    CellMargins->{{55, 85}, {Inherited, Inherited}},
    CellFrameLabels->{{None, Cell[ 
            TextData[ {"(", 
              CounterBox[ "NumberedEquation"], ")"}]]}, {None, None}},
    DefaultFormatType->DefaultInputFormatType,
    CounterIncrements->"NumberedEquation",
    FormatTypeAutoConvert->False,
    FontFamily->"Times"],
  
  Cell[StyleData["NumberedEquation", "Presentation"],
    CellMargins->{{60, 10}, {Inherited, 6}},
    LineSpacing->{1, 0}],
  
  Cell[StyleData["NumberedEquation", "Printout"],
    CellMargins->{{18, 4}, {4, 4}},
    FontSize->8]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["NumberedFigure"],
    CellMargins->{{55, 95}, {Inherited, Inherited}},
    CellFrameLabels->{{None, None}, {Cell[ 
            TextData[ {"Figure ", 
              CounterBox[ "NumberedFigure"]}], FontWeight -> "Bold"], None}},
    CounterIncrements->"NumberedFigure",
    FormatTypeAutoConvert->False,
    FontFamily->"Times"],
  
  Cell[StyleData["NumberedFigure", "Presentation"],
    CellMargins->{{60, 80}, {Inherited, 6}},
    LineSpacing->{1, 0}],
  
  Cell[StyleData["NumberedFigure", "Printout"],
    CellMargins->{{18, 80}, {4, 4}},
    FontSize->8]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["NumberedTable"],
    CellMargins->{{55, 95}, {Inherited, Inherited}},
    CellFrameLabels->{{None, None}, {Cell[ 
            TextData[ {"Table ", 
              CounterBox[ "NumberedTable"]}], FontWeight -> "Bold"], None}},
    TextAlignment->Center,
    CounterIncrements->"NumberedTable",
    FormatTypeAutoConvert->False,
    FontFamily->"Times"],
  
  Cell[StyleData["NumberedTable", "Presentation"],
    CellMargins->{{60, 80}, {Inherited, 6}},
    LineSpacing->{1, 0}],
  
  Cell[StyleData["NumberedTable", "Printout"],
    CellMargins->{{18, 80}, {4, 4}},
    FontSize->8]
  }, Open  ]]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell["Styles for Headers and Footers", "Section"],
  
  Cell[StyleData["Header"],
    StyleMenuListing->None,
    FontFamily->"Helvetica",
    FontSize->9],
  
  Cell[StyleData["PageNumber"],
    StyleMenuListing->None,
    FontFamily->"Helvetica",
    FontSize->9,
    FontWeight->"Bold"],
  
  Cell[StyleData["Footer"],
    TextAlignment->Center,
    StyleMenuListing->None,
    FontFamily->"Helvetica",
    FontSize->9]
  }, Closed]]
  }, Open  ]]
  }]
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{
  "Reference section"->{
    Cell[6827, 201, 61, 1, 63, "Section",
      CellTags->"Reference section"]},
  "Setup section"->{
    Cell[11226, 362, 53, 1, 37, "Section",
      CellTags->"Setup section"],
    Cell[11840, 378, 75, 1, 41, "Subsection",
      CellTags->"Setup section"],
    Cell[12368, 393, 354, 9, 46, "Text",
      CellTags->"Setup section"],
    Cell[12759, 407, 70, 1, 41, "Subsection",
      CellTags->"Setup section"],
    Cell[12832, 410, 839, 22, 64, "Text",
      CellTags->"Setup section"],
    Cell[13674, 434, 145, 3, 51, "InputOnly",
      CellTags->"Setup section"],
    Cell[13822, 439, 413, 10, 46, "Text",
      CellTags->"Setup section"],
    Cell[14238, 451, 331, 7, 47, "Text",
      CellTags->"Setup section"],
    Cell[46618, 1309, 117, 2, 27, "Input",
      CellTags->"Setup section"]},
  "Interface section"->{
    Cell[14618, 464, 89, 2, 63, "Section",
      InitializationCell->True,
      CellTags->"Interface section"],
    Cell[14710, 468, 156, 4, 29, "Text",
      InitializationCell->True,
      CellTags->"Interface section"],
    Cell[14891, 476, 135, 2, 41, "Subsection",
      InitializationCell->True,
      CellTags->"Interface section"],
    Cell[15363, 491, 137, 2, 27, "Input",
      InitializationCell->True,
      CellTags->"Interface section"],
    Cell[15628, 501, 155, 4, 25, "Subsection",
      InitializationCell->True,
      CellTags->"Interface section"],
    Cell[15786, 507, 257, 6, 45, "Input",
      InitializationCell->True,
      CellTags->"Interface section"],
    Cell[19490, 619, 94, 1, 41, "Subsection",
      CellTags->"Interface section"],
    Cell[19587, 622, 126, 3, 27, "Input",
      CellTags->"Interface section"]},
  "Implementation section"->{
    Cell[19762, 631, 99, 2, 37, "Section",
      InitializationCell->True,
      CellTags->"Implementation section"],
    Cell[19864, 635, 169, 4, 29, "Text",
      CellTags->"Implementation section"],
    Cell[20058, 643, 135, 2, 41, "Subsection",
      InitializationCell->True,
      CellTags->"Implementation section"],
    Cell[20218, 649, 103, 2, 27, "Input",
      InitializationCell->True,
      CellTags->"Implementation section"],
    Cell[20437, 658, 124, 2, 41, "Subsection",
      InitializationCell->True,
      CellTags->"Implementation section"],
    Cell[45206, 1245, 111, 2, 41, "Subsection",
      InitializationCell->True,
      CellTags->"Implementation section"],
    Cell[45342, 1251, 89, 2, 27, "Input",
      InitializationCell->True,
      CellTags->"Implementation section"]},
  "Epilog section"->{
    Cell[45581, 1263, 83, 2, 63, "Section",
      InitializationCell->True,
      CellTags->"Epilog section"],
    Cell[45667, 1267, 106, 1, 29, "Text",
      CellTags->"Epilog section"],
    Cell[45798, 1272, 103, 2, 41, "Subsection",
      InitializationCell->True,
      CellTags->"Epilog section"],
    Cell[45904, 1276, 115, 2, 29, "Text",
      InitializationCell->True,
      CellTags->"Epilog section"],
    Cell[46022, 1280, 133, 3, 27, "Input",
      Evaluatable->False,
      InitializationCell->True,
      CellTags->"Epilog section"],
    Cell[46192, 1288, 103, 2, 41, "Subsection",
      InitializationCell->True,
      CellTags->"Epilog section"],
    Cell[46298, 1292, 88, 2, 27, "Input",
      InitializationCell->True,
      CellTags->"Epilog section"]},
  "Examples section"->{
    Cell[49591, 1395, 66, 1, 37, "Section",
      CellTags->"Examples section"]},
  "Wolfram book"->{
    Cell[62527, 1718, 247, 7, 29, "Text",
      CellTags->"Wolfram book"]},
  "Maeder book"->{
    Cell[62777, 1727, 181, 6, 29, "Text",
      CellTags->"Maeder book"]},
  "MAD manual"->{
    Cell[62961, 1735, 155, 4, 29, "Text",
      CellTags->"MAD manual"]}
  }
*)

(*CellTagsIndex
CellTagsIndex->{
  {"Reference section", 84286, 2507},
  {"Setup section", 84388, 2510},
  {"Interface section", 85110, 2529},
  {"Implementation section", 85987, 2552},
  {"Epilog section", 86813, 2573},
  {"Examples section", 87610, 2595},
  {"Wolfram book", 87712, 2598},
  {"Maeder book", 87807, 2601},
  {"MAD manual", 87900, 2604}
  }
*)

(*NotebookFileOutline
Notebook[{
Cell[1705, 50, 65, 1, 29, "Text"],
Cell[1773, 53, 26, 4, 63, "Text"],

Cell[CellGroupData[{
Cell[1824, 61, 87, 2, 108, "Title"],
Cell[1914, 65, 178, 6, 88, "Author"],

Cell[CellGroupData[{
Cell[2117, 75, 31, 0, 63, "Section"],
Cell[2151, 77, 473, 15, 46, "Text"],
Cell[2627, 94, 524, 8, 63, "Text"],
Cell[3154, 104, 967, 16, 131, "Text"],
Cell[4124, 122, 184, 4, 29, "Text"],
Cell[4311, 128, 460, 7, 97, "Text"],
Cell[4774, 137, 103, 3, 29, "Text"],
Cell[4880, 142, 562, 16, 47, "Text"],
Cell[5445, 160, 536, 11, 63, "Text"],
Cell[5984, 173, 357, 8, 46, "Text"],
Cell[6344, 183, 58, 0, 29, "Text"],
Cell[6405, 185, 177, 3, 21, "Program"],
Cell[6585, 190, 205, 6, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[6827, 201, 61, 1, 63, "Section",
  CellTags->"Reference section"],

Cell[CellGroupData[{
Cell[6913, 206, 30, 0, 31, "Subsubsection"],
Cell[6946, 208, 75, 1, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[7058, 214, 31, 0, 31, "Subsubsection"],
Cell[7092, 216, 30, 0, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[7159, 221, 32, 0, 31, "Subsubsection"],
Cell[7194, 223, 89, 2, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[7320, 230, 34, 0, 31, "Subsubsection"],
Cell[7357, 232, 1875, 30, 386, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[9269, 267, 41, 0, 31, "Subsubsection"],
Cell[9313, 269, 19, 0, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[9369, 274, 101, 4, 31, "Subsubsection"],
Cell[9473, 280, 19, 0, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[9529, 285, 32, 0, 31, "Subsubsection"],
Cell[9564, 287, 148, 5, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[9749, 297, 33, 0, 31, "Subsubsection"],
Cell[9785, 299, 58, 0, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[9880, 304, 31, 0, 31, "Subsubsection"],
Cell[9914, 306, 208, 7, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[10159, 318, 33, 0, 31, "Subsubsection"],
Cell[10195, 320, 107, 1, 29, "Text"],
Cell[10305, 323, 315, 7, 47, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[10657, 335, 35, 0, 31, "Subsubsection"],
Cell[10695, 337, 100, 1, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[10832, 343, 35, 0, 31, "Subsubsection"],
Cell[10870, 345, 108, 1, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[11015, 351, 37, 0, 31, "Subsubsection"],
Cell[11055, 353, 122, 3, 30, "Text"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[11226, 362, 53, 1, 37, "Section",
  CellTags->"Setup section"],
Cell[11282, 365, 533, 9, 64, "Text"],

Cell[CellGroupData[{
Cell[11840, 378, 75, 1, 41, "Subsection",
  CellTags->"Setup section"],
Cell[11918, 381, 234, 4, 46, "Text"],
Cell[12155, 387, 210, 4, 21, "Program"],
Cell[12368, 393, 354, 9, 46, "Text",
  CellTags->"Setup section"]
}, Open  ]],

Cell[CellGroupData[{
Cell[12759, 407, 70, 1, 41, "Subsection",
  CellTags->"Setup section"],
Cell[12832, 410, 839, 22, 64, "Text",
  CellTags->"Setup section"],
Cell[13674, 434, 145, 3, 51, "InputOnly",
  CellTags->"Setup section"],
Cell[13822, 439, 413, 10, 46, "Text",
  CellTags->"Setup section"],
Cell[14238, 451, 331, 7, 47, "Text",
  CellTags->"Setup section"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[14618, 464, 89, 2, 63, "Section",
  InitializationCell->True,
  CellTags->"Interface section"],
Cell[14710, 468, 156, 4, 29, "Text",
  InitializationCell->True,
  CellTags->"Interface section"],

Cell[CellGroupData[{
Cell[14891, 476, 135, 2, 41, "Subsection",
  InitializationCell->True,
  CellTags->"Interface section"],
Cell[15029, 480, 309, 7, 38, "Commentary"],

Cell[CellGroupData[{
Cell[15363, 491, 137, 2, 27, "Input",
  InitializationCell->True,
  CellTags->"Interface section"],
Cell[15503, 495, 76, 0, 41, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[15628, 501, 155, 4, 25, "Subsection",
  InitializationCell->True,
  CellTags->"Interface section"],
Cell[15786, 507, 257, 6, 45, "Input",
  InitializationCell->True,
  CellTags->"Interface section"],
Cell[16046, 515, 475, 9, 107, "Input",
  InitializationCell->True],
Cell[16524, 526, 321, 7, 67, "Input",
  InitializationCell->True],
Cell[16848, 535, 276, 6, 47, "Input",
  InitializationCell->True],
Cell[17127, 543, 209, 4, 47, "Input",
  InitializationCell->True],
Cell[17339, 549, 221, 6, 27, "Input",
  InitializationCell->True],
Cell[17563, 557, 221, 6, 27, "Input",
  InitializationCell->True],
Cell[17787, 565, 227, 6, 27, "Input",
  InitializationCell->True],
Cell[18017, 573, 227, 6, 27, "Input",
  InitializationCell->True],
Cell[18247, 581, 299, 7, 67, "Input",
  InitializationCell->True],
Cell[18549, 590, 343, 7, 67, "Input",
  InitializationCell->True],
Cell[18895, 599, 271, 6, 47, "Input",
  InitializationCell->True],
Cell[19169, 607, 284, 7, 67, "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{
Cell[19490, 619, 94, 1, 41, "Subsection",
  CellTags->"Interface section"],
Cell[19587, 622, 126, 3, 27, "Input",
  CellTags->"Interface section"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{
Cell[19762, 631, 99, 2, 37, "Section",
  InitializationCell->True,
  CellTags->"Implementation section"],
Cell[19864, 635, 169, 4, 29, "Text",
  CellTags->"Implementation section"],

Cell[CellGroupData[{
Cell[20058, 643, 135, 2, 41, "Subsection",
  InitializationCell->True,
  CellTags->"Implementation section"],

Cell[CellGroupData[{
Cell[20218, 649, 103, 2, 27, "Input",
  InitializationCell->True,
  CellTags->"Implementation section"],
Cell[20324, 653, 86, 1, 41, "Output"]
}, Open  ]]
}, Open  ]],
Cell[20437, 658, 124, 2, 41, "Subsection",
  InitializationCell->True,
  CellTags->"Implementation section"],

Cell[CellGroupData[{
Cell[20586, 664, 41, 0, 41, "Subsection"],

Cell[CellGroupData[{
Cell[20652, 668, 1490, 24, 327, "Input",
  InitializationCell->True],
Cell[22145, 694, 286, 6, 14, "Message"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[22480, 706, 41, 0, 41, "Subsection"],
Cell[22524, 708, 797, 20, 47, "Input",
  InitializationCell->True],

Cell[CellGroupData[{
Cell[23346, 732, 2935, 62, 147, "Input",
  InitializationCell->True],
Cell[26284, 796, 259, 6, 14, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[26580, 807, 760, 15, 127, "Input",
  InitializationCell->True],
Cell[27343, 824, 257, 6, 14, "Message"]
}, Open  ]],
Cell[27615, 833, 1559, 36, 47, "Input",
  InitializationCell->True],
Cell[29177, 871, 168, 4, 27, "Input",
  InitializationCell->True],

Cell[CellGroupData[{
Cell[29370, 879, 2849, 60, 167, "Input",
  InitializationCell->True],
Cell[32222, 941, 260, 6, 14, "Message"]
}, Open  ]],
Cell[32497, 950, 172, 4, 27, "Input",
  InitializationCell->True],
Cell[32672, 956, 845, 16, 207, "Input",
  InitializationCell->True],

Cell[CellGroupData[{
Cell[33542, 976, 869, 21, 67, "Input",
  InitializationCell->True],
Cell[34414, 999, 256, 6, 14, "Message"]
}, Open  ]],
Cell[34685, 1008, 312, 5, 46, "Text"],
Cell[35000, 1015, 2086, 36, 327, "Input",
  InitializationCell->True],
Cell[37089, 1053, 2029, 44, 127, "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{
Cell[39155, 1102, 72, 1, 41, "Subsection",
  InitializationCell->True],
Cell[39230, 1105, 2508, 55, 167, "Input",
  InitializationCell->True],
Cell[41741, 1162, 231, 5, 29, "Text",
  InitializationCell->True],
Cell[41975, 1169, 984, 22, 107, "Input",
  InitializationCell->True],
Cell[42962, 1193, 2207, 47, 187, "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{
Cell[45206, 1245, 111, 2, 41, "Subsection",
  InitializationCell->True,
  CellTags->"Implementation section"],

Cell[CellGroupData[{
Cell[45342, 1251, 89, 2, 27, "Input",
  InitializationCell->True,
  CellTags->"Implementation section"],
Cell[45434, 1255, 86, 1, 41, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[45581, 1263, 83, 2, 63, "Section",
  InitializationCell->True,
  CellTags->"Epilog section"],
Cell[45667, 1267, 106, 1, 29, "Text",
  CellTags->"Epilog section"],

Cell[CellGroupData[{
Cell[45798, 1272, 103, 2, 41, "Subsection",
  InitializationCell->True,
  CellTags->"Epilog section"],
Cell[45904, 1276, 115, 2, 29, "Text",
  InitializationCell->True,
  CellTags->"Epilog section"],
Cell[46022, 1280, 133, 3, 27, "Input",
  Evaluatable->False,
  InitializationCell->True,
  CellTags->"Epilog section"]
}, Open  ]],

Cell[CellGroupData[{
Cell[46192, 1288, 103, 2, 41, "Subsection",
  InitializationCell->True,
  CellTags->"Epilog section"],
Cell[46298, 1292, 88, 2, 27, "Input",
  InitializationCell->True,
  CellTags->"Epilog section"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[46435, 1300, 38, 0, 37, "Section"],
Cell[46476, 1302, 117, 3, 29, "Text"],

Cell[CellGroupData[{
Cell[46618, 1309, 117, 2, 27, "Input",
  CellTags->"Setup section"],
Cell[46738, 1313, 48, 1, 41, "Output"]
}, Open  ]],
Cell[46801, 1317, 142, 3, 29, "Text"],

Cell[CellGroupData[{
Cell[46968, 1324, 69, 1, 27, "Input"],
Cell[47040, 1327, 64, 0, 37, "Print"],
Cell[47107, 1329, 1939, 41, 67, "Print"]
}, Open  ]],
Cell[49061, 1373, 139, 3, 29, "Text"],

Cell[CellGroupData[{
Cell[49225, 1380, 110, 2, 27, "Input"],
Cell[49338, 1384, 204, 5, 41, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[49591, 1395, 66, 1, 37, "Section",
  CellTags->"Examples section"],

Cell[CellGroupData[{
Cell[49682, 1400, 34, 0, 41, "Subsection"],

Cell[CellGroupData[{
Cell[49741, 1404, 126, 3, 27, "Input"],
Cell[49870, 1409, 90, 1, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[49997, 1415, 71, 1, 27, "Input"],
Cell[50071, 1418, 57, 1, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[50165, 1424, 58, 1, 27, "Input"],
Cell[50226, 1427, 220, 4, 60, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[50483, 1436, 104, 2, 27, "Input"],
Cell[50590, 1440, 62, 1, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[50689, 1446, 59, 1, 27, "Input"],
Cell[50751, 1449, 36, 1, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[50824, 1455, 129, 3, 27, "Input"],
Cell[50956, 1460, 221, 4, 29, "Message"],
Cell[51180, 1466, 42, 1, 41, "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[51271, 1473, 43, 0, 41, "Subsection"],

Cell[CellGroupData[{
Cell[51339, 1477, 65, 1, 27, "Input"],
Cell[51407, 1480, 106, 2, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[51550, 1487, 127, 2, 27, "Input"],
Cell[51680, 1491, 114, 2, 14, "Message"],
Cell[51797, 1495, 114, 2, 14, "Message"],
Cell[51914, 1499, 114, 2, 14, "Message"],
Cell[52031, 1503, 163, 3, 14, "Message"],
Cell[52197, 1508, 58, 1, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[52292, 1514, 81, 1, 27, "Input"],
Cell[52376, 1517, 2184, 32, 1162, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[54597, 1554, 43, 1, 27, "Input"],
Cell[54643, 1557, 106, 2, 41, "Output"]
}, Open  ]],
Cell[54764, 1562, 91, 2, 27, "Input"],

Cell[CellGroupData[{
Cell[54880, 1568, 69, 1, 27, "Input"],
Cell[54952, 1571, 7480, 138, 1371, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[62493, 1716, 31, 0, 63, "Section"],
Cell[62527, 1718, 247, 7, 29, "Text",
  CellTags->"Wolfram book"],
Cell[62777, 1727, 181, 6, 29, "Text",
  CellTags->"Maeder book"],
Cell[62961, 1735, 155, 4, 29, "Text",
  CellTags->"MAD manual"],
Cell[63119, 1741, 159, 3, 21, "Program"]
}, Closed]]
}, Open  ]]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

