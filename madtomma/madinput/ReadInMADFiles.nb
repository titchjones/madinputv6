(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    557890,      13266]
NotebookOptionsPosition[    553951,      13146]
NotebookOutlinePosition[    554345,      13163]
CellTagsIndexPosition[    554302,      13160]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<Madtomma`MADInput`ReadInMADFiles`\>\"", ",", 
    RowBox[{"{", "\"\<Madtomma`MADInput`MADInput`\>\"", "}"}]}], "]"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.39426242240057*^9, 3.39426242260369*^9}, {
   3.4620160209470987`*^9, 3.46201604530663*^9}, 3.462016079119346*^9, {
   3.4620162506516943`*^9, 3.4620162691830626`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReadInMADFiles", "::", "usage"}], "=", 
   "\"\<nb to read in MAD files\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FormatMADFile", "::", "usage"}], "=", 
   "\"\<FormatMADFile[\\\"filename\\\"] creates a formatted MMA set of MAD \
commands\>\""}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FormatMADLines", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReadInMADFile", "::", "usage"}], "=", 
   "\"\<ReadInMADFile[\\\"filename\\\"] reads in a MAD file and (re)assigns \
the element and line definitions\>\""}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReadInMADLines", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReplaceExponent", "[", "string_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"list", "=", "string"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"DigitQ", "[", 
                RowBox[{"StringTake", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"#", "-", "1"}], "}"}]}], "]"}], "]"}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"#", "-", "1"}], "}"}]}], "]"}], "===", 
                "\"\<=\>\""}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"#", "-", "1"}], "}"}]}], "]"}], "===", 
                "\"\<-\>\""}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"#", "-", "1"}], "}"}]}], "]"}], "===", 
                "\"\<+\>\""}], ")"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"DigitQ", "[", 
                RowBox[{"StringTake", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"#", "+", "1"}], "}"}]}], "]"}], "]"}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"#", "+", "1"}], "}"}]}], "]"}], "===", 
                "\"\<+\>\""}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"#", "+", "1"}], "}"}]}], "]"}], "===", 
                "\"\<-\>\""}], ")"}]}], ")"}]}], ",", 
           RowBox[{"list", "=", 
            RowBox[{"StringReplacePart", "[", 
             RowBox[{"list", ",", "\"\<*10^\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "#"}], "}"}]}], "]"}]}]}], "]"}], ")"}], 
        "&"}], "/@", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"list", ",", "\"\<E\>\""}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", ">", "1"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"#", "<", 
              RowBox[{"StringLength", "[", "list", "]"}]}], ")"}]}], "&"}]}], 
         "]"}], "]"}]}], ")"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"list", ",", 
        RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"NumberRight", "[", 
   RowBox[{"a_", ",", 
    RowBox[{"acc_:", "30"}]}], "]"}], ":=", 
  RowBox[{"NumberForm", "[", 
   RowBox[{
    RowBox[{"N", "[", "a", "]"}], ",", "acc", ",", 
    RowBox[{"ExponentFunction", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"Null", "&"}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["\<\
Functions to Read In MAD Files and Create Mathematica lines (formatted output)\
\>", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fquadRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<quad[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
            "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"NumberRight", "@", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"ToString", "[", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
              "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], ")"}], "]"}], ">", 
             "0"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<\\\"\>\"", "<>", 
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], "&"}],
              "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"First", "@", 
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                  "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"fsolenoidRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<solenoid[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
            "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"NumberRight", "@", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"ToString", "[", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
              "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<KS\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], ")"}], "]"}], ">", 
             "0"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<KS\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<\\\"\>\"", "<>", 
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], "&"}],
              "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"First", "@", 
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                  "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"fsbendRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<sbend[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
            "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"NumberRight", "@", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"ToString", "[", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
              "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], ")"}], "]"}], ">", 
             "0"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<ANGLE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], ")"}], "]"}], ">",
              "0"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<ANGLE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<\\\"\>\"", "<>", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                  "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"\"\<,E1\[Rule]\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"ToExpression", "[", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"First", "@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                 "]"}], "]"}]}], "]"}]}], ",", "\"\<\>\""}], "]"}], "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"\"\<,E2\[Rule]\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"ToExpression", "[", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"First", "@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                 "]"}], "]"}]}], "]"}]}], ",", "\"\<\>\""}], "]"}], "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<HGAP\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"\"\<,HGap\[Rule]\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"ToExpression", "[", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"First", "@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<HGAP\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                 "]"}], "]"}]}], "]"}]}], ",", "\"\<\>\""}], "]"}], "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FINT\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"\"\<,FInt\[Rule]\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"ToExpression", "[", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"First", "@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FINT\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                 "]"}], "]"}]}], "]"}]}], ",", "\"\<\>\""}], "]"}], "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FINTX\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"\"\<,FIntX\[Rule]\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"ToExpression", "[", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"First", "@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FINTX\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                 "]"}], "]"}]}], "]"}]}], ",", "\"\<\>\""}], "]"}], "<>", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TILT\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"\"\<,Tilt\[Rule]\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"ToExpression", "[", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"First", "@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TILT\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                 "]"}], "]"}]}], "]"}]}], ",", "\"\<\>\""}], "]"}], 
          "\[IndentingNewLine]", "<>", "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.416894386261749*^9, 3.416894409419036*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frbendRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<rbend[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
            "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"NumberRight", "@", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"ToString", "[", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
              "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FOCUS\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], ")"}], "]"}], ">",
              "0"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FOCUS\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<ANGLE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], ")"}], "]"}], ">",
              "0"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<ANGLE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<\\\"\>\"", "<>", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                  "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"\"\<,E1\[Rule]\>\"", "<>", 
             RowBox[{"First", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"First", "@", 
                   RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], ",", 
            "\"\<\>\""}], "]"}], "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"\"\<,E2\[Rule]\>\"", "<>", 
             RowBox[{"First", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"First", "@", 
                   RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], ",", 
            "\"\<\>\""}], "]"}], "<>", "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"fsextRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<sext[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{
             "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"NumberRight", "@", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"ToString", "[", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
              "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"NumberRight", "@", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"ToString", "[", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
              "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<\\\"\>\"", "<>", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{
                "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          "\"\<,Thin\[Rule]usethin\>\"", "<>", "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"foctRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<oct[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
            "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"NumberRight", "@", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"ToString", "[", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
              "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"NumberRight", "@", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"ToString", "[", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K3\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
              "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<\\\"\>\"", "<>", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                  "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          "\"\<,Thin\[Rule]usethin\>\"", "<>", "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"fmonitorRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<bpm[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
            "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
             ",", "\"\<0\>\""}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<\\\"\>\"", "<>", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                  "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"fkickerRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<kick[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
            "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<HKICK\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<HKICK\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<VKICK\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<VKICK\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<\\\"\>\"", "<>", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                  "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"fdriftRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<drift[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
            "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"NumberRight", "@", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<\\\"\>\"", "<>", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                  "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"fdriftRead2", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<drift[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
            "]"}], "]"}], "<>", "\"\<,\>\"", "<>", "\"\<0\>\"", "<>", 
          "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<\\\"\>\"", "<>", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                  "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"fmarkerRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<marker[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
            "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<\\\"\>\"", "<>", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                  "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"frcollRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<rcoll[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
            "]"}], "]"}], "<>", "\"\<,\>\"", "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<XSIZE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<XSIZE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<YSIZE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<YSIZE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<\\\"\>\"", "<>", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                  "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"fecollRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<ecoll[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
            "]"}], "]"}], "<>", "\"\<,\>\"", "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<XSIZE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<XSIZE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<YSIZE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"NumberRight", "@", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"ToString", "[", 
                 RowBox[{"First", "@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<YSIZE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
                "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
          "\"\<,\>\"", "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<\\\"\>\"", "<>", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                  "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"flcavRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<lcav[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{
             "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"NumberRight", "@", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"ToExpression", "[", 
              RowBox[{"ToString", "[", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
              "]"}], "]"}]}], "]"}], "<>", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<,\\\"\>\"", "<>", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
            RowBox[{"\"\<,\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{
                "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<DELTAE\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,VoltageGain\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<DELTAE\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}],
                "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<PHI0\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,CavityPhase\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<PHI0\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FREQ\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,Frequency\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FREQ\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<ELOSS\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,LossFactor\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<ELOSS\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<VOLTERR\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,VoltageError\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<VOLTERR\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}],
                "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<LAGERR\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,LagError\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<LAGERR\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}],
                "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<NBIN\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,NumberBins\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<NBIN\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<BINMAX\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,MaxBinLength\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<BINMAX\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}],
                "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<LFILE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,LWakefieldFile\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<LFILE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TFILE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,TWakefieldFile\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TFILE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"fmultipoleRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"\"\<multipole[\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringReplace", "[", 
              RowBox[{
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
            "]"}], "]"}], "<>", "\"\<,\>\"", "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"\"\<\\\"\>\"", "<>", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
            RowBox[{"\"\<\\\"\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"StringReplace", "[", 
                 RowBox[{
                  RowBox[{
                  "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", 
                  RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], 
                "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<LRAD\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,LRAD\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<LRAD\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K0L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,K0L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K0L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T0\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,T0\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T0\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K1L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,K1L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K1L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,T1\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K2L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,K2L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K2L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,T2\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K3L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,K3L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K3L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T3\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,T3\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T3\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K4L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,K4L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K4L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T4\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,T4\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T4\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K5L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,K5L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K5L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T5\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,T5\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T5\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K6L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,K6L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K6L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T6\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,T6\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T6\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K7L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,K7L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K7L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T7\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,T7\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T7\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K8L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,K8L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K8L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T8\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,T8\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T8\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K9L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,K9L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K9L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T9\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
             "\[GreaterEqual]", "1"}], ",", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"NumberRight", "@", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"\"\<,T9\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T9\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
             "]"}], ",", "\"\<\>\""}], "]"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "<>", "\"\<]\>\""}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"flineRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{
            "a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}], ",", 
            RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "b", "]"}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<:LINE=(\>\"", "\[Rule]", "\"\<:={\>\""}], ",", 
          RowBox[{"\"\<:Line=(\>\"", "\[Rule]", "\"\<:={\>\""}], ",", 
          RowBox[{"\"\<:line=(\>\"", "\[Rule]", "\"\<:={\>\""}], ",", 
          RowBox[{"\"\<&\\n\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<)\>\"", "\[Rule]", "\"\<}\>\""}], ",", 
          RowBox[{"\"\<\\n\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<LINE\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<(\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<100*\>\"", "\[Rule]", "\"\<Table[#,{100}]&@\>\""}], 
          ",", 
          RowBox[{"\"\<99*\>\"", "\[Rule]", "\"\<Table[#,{99}]&@\>\""}], ",", 
          RowBox[{"\"\<98*\>\"", "\[Rule]", "\"\<Table[#,{98}]&@\>\""}], ",", 
          RowBox[{"\"\<97*\>\"", "\[Rule]", "\"\<Table[#,{97}]&@\>\""}], ",", 
          RowBox[{"\"\<96*\>\"", "\[Rule]", "\"\<Table[#,{96}]&@\>\""}], ",", 
          RowBox[{"\"\<95*\>\"", "\[Rule]", "\"\<Table[#,{95}]&@\>\""}], ",", 
          RowBox[{"\"\<94*\>\"", "\[Rule]", "\"\<Table[#,{94}]&@\>\""}], ",", 
          RowBox[{"\"\<93*\>\"", "\[Rule]", "\"\<Table[#,{93}]&@\>\""}], ",", 
          RowBox[{"\"\<92*\>\"", "\[Rule]", "\"\<Table[#,{92}]&@\>\""}], ",", 
          RowBox[{"\"\<91*\>\"", "\[Rule]", "\"\<Table[#,{91}]&@\>\""}], ",", 
          RowBox[{"\"\<90*\>\"", "\[Rule]", "\"\<Table[#,{90}]&@\>\""}], ",", 
          RowBox[{"\"\<89*\>\"", "\[Rule]", "\"\<Table[#,{89}]&@\>\""}], ",", 
          RowBox[{"\"\<88*\>\"", "\[Rule]", "\"\<Table[#,{88}]&@\>\""}], ",", 
          RowBox[{"\"\<87*\>\"", "\[Rule]", "\"\<Table[#,{87}]&@\>\""}], ",", 
          RowBox[{"\"\<86*\>\"", "\[Rule]", "\"\<Table[#,{86}]&@\>\""}], ",", 
          RowBox[{"\"\<85*\>\"", "\[Rule]", "\"\<Table[#,{85}]&@\>\""}], ",", 
          RowBox[{"\"\<84*\>\"", "\[Rule]", "\"\<Table[#,{84}]&@\>\""}], ",", 
          RowBox[{"\"\<83*\>\"", "\[Rule]", "\"\<Table[#,{83}]&@\>\""}], ",", 
          RowBox[{"\"\<82*\>\"", "\[Rule]", "\"\<Table[#,{82}]&@\>\""}], ",", 
          RowBox[{"\"\<81*\>\"", "\[Rule]", "\"\<Table[#,{81}]&@\>\""}], ",", 
          RowBox[{"\"\<80*\>\"", "\[Rule]", "\"\<Table[#,{80}]&@\>\""}], ",", 
          RowBox[{"\"\<79*\>\"", "\[Rule]", "\"\<Table[#,{79}]&@\>\""}], ",", 
          RowBox[{"\"\<78*\>\"", "\[Rule]", "\"\<Table[#,{78}]&@\>\""}], ",", 
          RowBox[{"\"\<77*\>\"", "\[Rule]", "\"\<Table[#,{77}]&@\>\""}], ",", 
          RowBox[{"\"\<76*\>\"", "\[Rule]", "\"\<Table[#,{76}]&@\>\""}], ",", 
          RowBox[{"\"\<75*\>\"", "\[Rule]", "\"\<Table[#,{75}]&@\>\""}], ",", 
          RowBox[{"\"\<74*\>\"", "\[Rule]", "\"\<Table[#,{74}]&@\>\""}], ",", 
          RowBox[{"\"\<73*\>\"", "\[Rule]", "\"\<Table[#,{73}]&@\>\""}], ",", 
          RowBox[{"\"\<72*\>\"", "\[Rule]", "\"\<Table[#,{72}]&@\>\""}], ",", 
          RowBox[{"\"\<71*\>\"", "\[Rule]", "\"\<Table[#,{71}]&@\>\""}], ",", 
          RowBox[{"\"\<70*\>\"", "\[Rule]", "\"\<Table[#,{70}]&@\>\""}], ",", 
          RowBox[{"\"\<69*\>\"", "\[Rule]", "\"\<Table[#,{69}]&@\>\""}], ",", 
          RowBox[{"\"\<68*\>\"", "\[Rule]", "\"\<Table[#,{68}]&@\>\""}], ",", 
          RowBox[{"\"\<67*\>\"", "\[Rule]", "\"\<Table[#,{67}]&@\>\""}], ",", 
          RowBox[{"\"\<66*\>\"", "\[Rule]", "\"\<Table[#,{66}]&@\>\""}], ",", 
          RowBox[{"\"\<65*\>\"", "\[Rule]", "\"\<Table[#,{65}]&@\>\""}], ",", 
          RowBox[{"\"\<64*\>\"", "\[Rule]", "\"\<Table[#,{64}]&@\>\""}], ",", 
          RowBox[{"\"\<63*\>\"", "\[Rule]", "\"\<Table[#,{63}]&@\>\""}], ",", 
          RowBox[{"\"\<62*\>\"", "\[Rule]", "\"\<Table[#,{62}]&@\>\""}], ",", 
          RowBox[{"\"\<61*\>\"", "\[Rule]", "\"\<Table[#,{61}]&@\>\""}], ",", 
          RowBox[{"\"\<60*\>\"", "\[Rule]", "\"\<Table[#,{60}]&@\>\""}], ",", 
          RowBox[{"\"\<59*\>\"", "\[Rule]", "\"\<Table[#,{59}]&@\>\""}], ",", 
          RowBox[{"\"\<58*\>\"", "\[Rule]", "\"\<Table[#,{58}]&@\>\""}], ",", 
          RowBox[{"\"\<57*\>\"", "\[Rule]", "\"\<Table[#,{57}]&@\>\""}], ",", 
          RowBox[{"\"\<56*\>\"", "\[Rule]", "\"\<Table[#,{56}]&@\>\""}], ",", 
          RowBox[{"\"\<55*\>\"", "\[Rule]", "\"\<Table[#,{55}]&@\>\""}], ",", 
          RowBox[{"\"\<54*\>\"", "\[Rule]", "\"\<Table[#,{54}]&@\>\""}], ",", 
          RowBox[{"\"\<53*\>\"", "\[Rule]", "\"\<Table[#,{53}]&@\>\""}], ",", 
          RowBox[{"\"\<52*\>\"", "\[Rule]", "\"\<Table[#,{52}]&@\>\""}], ",", 
          RowBox[{"\"\<51*\>\"", "\[Rule]", "\"\<Table[#,{51}]&@\>\""}], ",", 
          RowBox[{"\"\<50*\>\"", "\[Rule]", "\"\<Table[#,{50}]&@\>\""}], ",", 
          RowBox[{"\"\<49*\>\"", "\[Rule]", "\"\<Table[#,{49}]&@\>\""}], ",", 
          RowBox[{"\"\<48*\>\"", "\[Rule]", "\"\<Table[#,{48}]&@\>\""}], ",", 
          RowBox[{"\"\<47*\>\"", "\[Rule]", "\"\<Table[#,{47}]&@\>\""}], ",", 
          RowBox[{"\"\<46*\>\"", "\[Rule]", "\"\<Table[#,{46}]&@\>\""}], ",", 
          RowBox[{"\"\<45*\>\"", "\[Rule]", "\"\<Table[#,{45}]&@\>\""}], ",", 
          RowBox[{"\"\<44*\>\"", "\[Rule]", "\"\<Table[#,{44}]&@\>\""}], ",", 
          RowBox[{"\"\<43*\>\"", "\[Rule]", "\"\<Table[#,{43}]&@\>\""}], ",", 
          RowBox[{"\"\<42*\>\"", "\[Rule]", "\"\<Table[#,{42}]&@\>\""}], ",", 
          RowBox[{"\"\<41*\>\"", "\[Rule]", "\"\<Table[#,{41}]&@\>\""}], ",", 
          RowBox[{"\"\<40*\>\"", "\[Rule]", "\"\<Table[#,{40}]&@\>\""}], ",", 
          RowBox[{"\"\<39*\>\"", "\[Rule]", "\"\<Table[#,{39}]&@\>\""}], ",", 
          RowBox[{"\"\<38*\>\"", "\[Rule]", "\"\<Table[#,{38}]&@\>\""}], ",", 
          RowBox[{"\"\<37*\>\"", "\[Rule]", "\"\<Table[#,{37}]&@\>\""}], ",", 
          RowBox[{"\"\<36*\>\"", "\[Rule]", "\"\<Table[#,{36}]&@\>\""}], ",", 
          RowBox[{"\"\<35*\>\"", "\[Rule]", "\"\<Table[#,{35}]&@\>\""}], ",", 
          RowBox[{"\"\<34*\>\"", "\[Rule]", "\"\<Table[#,{34}]&@\>\""}], ",", 
          RowBox[{"\"\<33*\>\"", "\[Rule]", "\"\<Table[#,{33}]&@\>\""}], ",", 
          RowBox[{"\"\<32*\>\"", "\[Rule]", "\"\<Table[#,{32}]&@\>\""}], ",", 
          RowBox[{"\"\<31*\>\"", "\[Rule]", "\"\<Table[#,{31}]&@\>\""}], ",", 
          RowBox[{"\"\<30*\>\"", "\[Rule]", "\"\<Table[#,{30}]&@\>\""}], ",", 
          RowBox[{"\"\<29*\>\"", "\[Rule]", "\"\<Table[#,{29}]&@\>\""}], ",", 
          RowBox[{"\"\<28*\>\"", "\[Rule]", "\"\<Table[#,{28}]&@\>\""}], ",", 
          RowBox[{"\"\<27*\>\"", "\[Rule]", "\"\<Table[#,{27}]&@\>\""}], ",", 
          RowBox[{"\"\<26*\>\"", "\[Rule]", "\"\<Table[#,{26}]&@\>\""}], ",", 
          RowBox[{"\"\<25*\>\"", "\[Rule]", "\"\<Table[#,{25}]&@\>\""}], ",", 
          RowBox[{"\"\<24*\>\"", "\[Rule]", "\"\<Table[#,{24}]&@\>\""}], ",", 
          RowBox[{"\"\<23*\>\"", "\[Rule]", "\"\<Table[#,{23}]&@\>\""}], ",", 
          RowBox[{"\"\<22*\>\"", "\[Rule]", "\"\<Table[#,{22}]&@\>\""}], ",", 
          RowBox[{"\"\<21*\>\"", "\[Rule]", "\"\<Table[#,{21}]&@\>\""}], ",", 
          RowBox[{"\"\<20*\>\"", "\[Rule]", "\"\<Table[#,{20}]&@\>\""}], ",", 
          RowBox[{"\"\<19*\>\"", "\[Rule]", "\"\<Table[#,{19}]&@\>\""}], ",", 
          RowBox[{"\"\<18*\>\"", "\[Rule]", "\"\<Table[#,{18}]&@\>\""}], ",", 
          RowBox[{"\"\<17*\>\"", "\[Rule]", "\"\<Table[#,{17}]&@\>\""}], ",", 
          RowBox[{"\"\<16*\>\"", "\[Rule]", "\"\<Table[#,{16}]&@\>\""}], ",", 
          RowBox[{"\"\<15*\>\"", "\[Rule]", "\"\<Table[#,{15}]&@\>\""}], ",", 
          RowBox[{"\"\<14*\>\"", "\[Rule]", "\"\<Table[#,{14}]&@\>\""}], ",", 
          RowBox[{"\"\<13*\>\"", "\[Rule]", "\"\<Table[#,{13}]&@\>\""}], ",", 
          RowBox[{"\"\<12*\>\"", "\[Rule]", "\"\<Table[#,{12}]&@\>\""}], ",", 
          RowBox[{"\"\<11*\>\"", "\[Rule]", "\"\<Table[#,{11}]&@\>\""}], ",", 
          RowBox[{"\"\<10*\>\"", "\[Rule]", "\"\<Table[#,{10}]&@\>\""}], ",", 
          RowBox[{"\"\<9*\>\"", "\[Rule]", "\"\<Table[#,{9}]&@\>\""}], ",", 
          RowBox[{"\"\<8*\>\"", "\[Rule]", "\"\<Table[#,{8}]&@\>\""}], ",", 
          RowBox[{"\"\<7*\>\"", "\[Rule]", "\"\<Table[#,{7}]&@\>\""}], ",", 
          RowBox[{"\"\<6*\>\"", "\[Rule]", "\"\<Table[#,{6}]&@\>\""}], ",", 
          RowBox[{"\"\<5*\>\"", "\[Rule]", "\"\<Table[#,{5}]&@\>\""}], ",", 
          RowBox[{"\"\<4*\>\"", "\[Rule]", "\"\<Table[#,{4}]&@\>\""}], ",", 
          RowBox[{"\"\<3*\>\"", "\[Rule]", "\"\<Table[#,{3}]&@\>\""}], ",", 
          RowBox[{"\"\<2*\>\"", "\[Rule]", "\"\<Table[#,{2}]&@\>\""}], ",", 
          RowBox[{"\"\<1*\>\"", "\[Rule]", "\"\<Table[#,{1}]&@\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<*100\>\"", "\[Rule]", "\"\<Table[#,{100}]&@\>\""}], 
          ",", 
          RowBox[{"\"\<*99\>\"", "\[Rule]", "\"\<Table[#,{99}]&@\>\""}], ",", 
          RowBox[{"\"\<*98\>\"", "\[Rule]", "\"\<Table[#,{98}]&@\>\""}], ",", 
          RowBox[{"\"\<*97\>\"", "\[Rule]", "\"\<Table[#,{97}]&@\>\""}], ",", 
          RowBox[{"\"\<*96\>\"", "\[Rule]", "\"\<Table[#,{96}]&@\>\""}], ",", 
          RowBox[{"\"\<*95\>\"", "\[Rule]", "\"\<Table[#,{95}]&@\>\""}], ",", 
          RowBox[{"\"\<*94\>\"", "\[Rule]", "\"\<Table[#,{94}]&@\>\""}], ",", 
          RowBox[{"\"\<*93\>\"", "\[Rule]", "\"\<Table[#,{93}]&@\>\""}], ",", 
          RowBox[{"\"\<*92\>\"", "\[Rule]", "\"\<Table[#,{92}]&@\>\""}], ",", 
          RowBox[{"\"\<*91\>\"", "\[Rule]", "\"\<Table[#,{91}]&@\>\""}], ",", 
          RowBox[{"\"\<*90\>\"", "\[Rule]", "\"\<Table[#,{90}]&@\>\""}], ",", 
          RowBox[{"\"\<*89\>\"", "\[Rule]", "\"\<Table[#,{89}]&@\>\""}], ",", 
          RowBox[{"\"\<*88\>\"", "\[Rule]", "\"\<Table[#,{88}]&@\>\""}], ",", 
          RowBox[{"\"\<*87\>\"", "\[Rule]", "\"\<Table[#,{87}]&@\>\""}], ",", 
          RowBox[{"\"\<*86\>\"", "\[Rule]", "\"\<Table[#,{86}]&@\>\""}], ",", 
          RowBox[{"\"\<*85\>\"", "\[Rule]", "\"\<Table[#,{85}]&@\>\""}], ",", 
          RowBox[{"\"\<*84\>\"", "\[Rule]", "\"\<Table[#,{84}]&@\>\""}], ",", 
          RowBox[{"\"\<*83\>\"", "\[Rule]", "\"\<Table[#,{83}]&@\>\""}], ",", 
          RowBox[{"\"\<*82\>\"", "\[Rule]", "\"\<Table[#,{82}]&@\>\""}], ",", 
          RowBox[{"\"\<*81\>\"", "\[Rule]", "\"\<Table[#,{81}]&@\>\""}], ",", 
          RowBox[{"\"\<*80\>\"", "\[Rule]", "\"\<Table[#,{80}]&@\>\""}], ",", 
          RowBox[{"\"\<*79\>\"", "\[Rule]", "\"\<Table[#,{79}]&@\>\""}], ",", 
          RowBox[{"\"\<*78\>\"", "\[Rule]", "\"\<Table[#,{78}]&@\>\""}], ",", 
          RowBox[{"\"\<*77\>\"", "\[Rule]", "\"\<Table[#,{77}]&@\>\""}], ",", 
          RowBox[{"\"\<*76\>\"", "\[Rule]", "\"\<Table[#,{76}]&@\>\""}], ",", 
          RowBox[{"\"\<*75\>\"", "\[Rule]", "\"\<Table[#,{75}]&@\>\""}], ",", 
          RowBox[{"\"\<*74\>\"", "\[Rule]", "\"\<Table[#,{74}]&@\>\""}], ",", 
          RowBox[{"\"\<*73\>\"", "\[Rule]", "\"\<Table[#,{73}]&@\>\""}], ",", 
          RowBox[{"\"\<*72\>\"", "\[Rule]", "\"\<Table[#,{72}]&@\>\""}], ",", 
          RowBox[{"\"\<*71\>\"", "\[Rule]", "\"\<Table[#,{71}]&@\>\""}], ",", 
          RowBox[{"\"\<*70\>\"", "\[Rule]", "\"\<Table[#,{70}]&@\>\""}], ",", 
          RowBox[{"\"\<*69\>\"", "\[Rule]", "\"\<Table[#,{69}]&@\>\""}], ",", 
          RowBox[{"\"\<*68\>\"", "\[Rule]", "\"\<Table[#,{68}]&@\>\""}], ",", 
          RowBox[{"\"\<*67\>\"", "\[Rule]", "\"\<Table[#,{67}]&@\>\""}], ",", 
          RowBox[{"\"\<*66\>\"", "\[Rule]", "\"\<Table[#,{66}]&@\>\""}], ",", 
          RowBox[{"\"\<*65\>\"", "\[Rule]", "\"\<Table[#,{65}]&@\>\""}], ",", 
          RowBox[{"\"\<*64\>\"", "\[Rule]", "\"\<Table[#,{64}]&@\>\""}], ",", 
          RowBox[{"\"\<*63\>\"", "\[Rule]", "\"\<Table[#,{63}]&@\>\""}], ",", 
          RowBox[{"\"\<*62\>\"", "\[Rule]", "\"\<Table[#,{62}]&@\>\""}], ",", 
          RowBox[{"\"\<*61\>\"", "\[Rule]", "\"\<Table[#,{61}]&@\>\""}], ",", 
          RowBox[{"\"\<*60\>\"", "\[Rule]", "\"\<Table[#,{60}]&@\>\""}], ",", 
          RowBox[{"\"\<*59\>\"", "\[Rule]", "\"\<Table[#,{59}]&@\>\""}], ",", 
          RowBox[{"\"\<*58\>\"", "\[Rule]", "\"\<Table[#,{58}]&@\>\""}], ",", 
          RowBox[{"\"\<*57\>\"", "\[Rule]", "\"\<Table[#,{57}]&@\>\""}], ",", 
          RowBox[{"\"\<*56\>\"", "\[Rule]", "\"\<Table[#,{56}]&@\>\""}], ",", 
          RowBox[{"\"\<*55\>\"", "\[Rule]", "\"\<Table[#,{55}]&@\>\""}], ",", 
          RowBox[{"\"\<*54\>\"", "\[Rule]", "\"\<Table[#,{54}]&@\>\""}], ",", 
          RowBox[{"\"\<*53\>\"", "\[Rule]", "\"\<Table[#,{53}]&@\>\""}], ",", 
          RowBox[{"\"\<*52\>\"", "\[Rule]", "\"\<Table[#,{52}]&@\>\""}], ",", 
          RowBox[{"\"\<*51\>\"", "\[Rule]", "\"\<Table[#,{51}]&@\>\""}], ",", 
          RowBox[{"\"\<*50\>\"", "\[Rule]", "\"\<Table[#,{50}]&@\>\""}], ",", 
          RowBox[{"\"\<*49\>\"", "\[Rule]", "\"\<Table[#,{49}]&@\>\""}], ",", 
          RowBox[{"\"\<*48\>\"", "\[Rule]", "\"\<Table[#,{48}]&@\>\""}], ",", 
          RowBox[{"\"\<*47\>\"", "\[Rule]", "\"\<Table[#,{47}]&@\>\""}], ",", 
          RowBox[{"\"\<*46\>\"", "\[Rule]", "\"\<Table[#,{46}]&@\>\""}], ",", 
          RowBox[{"\"\<*45\>\"", "\[Rule]", "\"\<Table[#,{45}]&@\>\""}], ",", 
          RowBox[{"\"\<*44\>\"", "\[Rule]", "\"\<Table[#,{44}]&@\>\""}], ",", 
          RowBox[{"\"\<*43\>\"", "\[Rule]", "\"\<Table[#,{43}]&@\>\""}], ",", 
          RowBox[{"\"\<*42\>\"", "\[Rule]", "\"\<Table[#,{42}]&@\>\""}], ",", 
          RowBox[{"\"\<*41\>\"", "\[Rule]", "\"\<Table[#,{41}]&@\>\""}], ",", 
          RowBox[{"\"\<*40\>\"", "\[Rule]", "\"\<Table[#,{40}]&@\>\""}], ",", 
          RowBox[{"\"\<*39\>\"", "\[Rule]", "\"\<Table[#,{39}]&@\>\""}], ",", 
          RowBox[{"\"\<*38\>\"", "\[Rule]", "\"\<Table[#,{38}]&@\>\""}], ",", 
          RowBox[{"\"\<*37\>\"", "\[Rule]", "\"\<Table[#,{37}]&@\>\""}], ",", 
          RowBox[{"\"\<*36\>\"", "\[Rule]", "\"\<Table[#,{36}]&@\>\""}], ",", 
          RowBox[{"\"\<*35\>\"", "\[Rule]", "\"\<Table[#,{35}]&@\>\""}], ",", 
          RowBox[{"\"\<*34\>\"", "\[Rule]", "\"\<Table[#,{34}]&@\>\""}], ",", 
          RowBox[{"\"\<*33\>\"", "\[Rule]", "\"\<Table[#,{33}]&@\>\""}], ",", 
          RowBox[{"\"\<*32\>\"", "\[Rule]", "\"\<Table[#,{32}]&@\>\""}], ",", 
          RowBox[{"\"\<*31\>\"", "\[Rule]", "\"\<Table[#,{31}]&@\>\""}], ",", 
          RowBox[{"\"\<*30\>\"", "\[Rule]", "\"\<Table[#,{30}]&@\>\""}], ",", 
          RowBox[{"\"\<*29\>\"", "\[Rule]", "\"\<Table[#,{29}]&@\>\""}], ",", 
          RowBox[{"\"\<*28\>\"", "\[Rule]", "\"\<Table[#,{28}]&@\>\""}], ",", 
          RowBox[{"\"\<*27\>\"", "\[Rule]", "\"\<Table[#,{27}]&@\>\""}], ",", 
          RowBox[{"\"\<*26\>\"", "\[Rule]", "\"\<Table[#,{26}]&@\>\""}], ",", 
          RowBox[{"\"\<*25\>\"", "\[Rule]", "\"\<Table[#,{25}]&@\>\""}], ",", 
          RowBox[{"\"\<*24\>\"", "\[Rule]", "\"\<Table[#,{24}]&@\>\""}], ",", 
          RowBox[{"\"\<*23\>\"", "\[Rule]", "\"\<Table[#,{23}]&@\>\""}], ",", 
          RowBox[{"\"\<*22\>\"", "\[Rule]", "\"\<Table[#,{22}]&@\>\""}], ",", 
          RowBox[{"\"\<*21\>\"", "\[Rule]", "\"\<Table[#,{21}]&@\>\""}], ",", 
          RowBox[{"\"\<*20\>\"", "\[Rule]", "\"\<Table[#,{20}]&@\>\""}], ",", 
          RowBox[{"\"\<*19\>\"", "\[Rule]", "\"\<Table[#,{19}]&@\>\""}], ",", 
          RowBox[{"\"\<*18\>\"", "\[Rule]", "\"\<Table[#,{18}]&@\>\""}], ",", 
          RowBox[{"\"\<*17\>\"", "\[Rule]", "\"\<Table[#,{17}]&@\>\""}], ",", 
          RowBox[{"\"\<*16\>\"", "\[Rule]", "\"\<Table[#,{16}]&@\>\""}], ",", 
          RowBox[{"\"\<*15\>\"", "\[Rule]", "\"\<Table[#,{15}]&@\>\""}], ",", 
          RowBox[{"\"\<*14\>\"", "\[Rule]", "\"\<Table[#,{14}]&@\>\""}], ",", 
          RowBox[{"\"\<*13\>\"", "\[Rule]", "\"\<Table[#,{13}]&@\>\""}], ",", 
          RowBox[{"\"\<*12\>\"", "\[Rule]", "\"\<Table[#,{12}]&@\>\""}], ",", 
          RowBox[{"\"\<*11\>\"", "\[Rule]", "\"\<Table[#,{11}]&@\>\""}], ",", 
          RowBox[{"\"\<*10\>\"", "\[Rule]", "\"\<Table[#,{10}]&@\>\""}], ",", 
          RowBox[{"\"\<*9\>\"", "\[Rule]", "\"\<Table[#,{9}]&@\>\""}], ",", 
          RowBox[{"\"\<*8\>\"", "\[Rule]", "\"\<Table[#,{8}]&@\>\""}], ",", 
          RowBox[{"\"\<*7\>\"", "\[Rule]", "\"\<Table[#,{7}]&@\>\""}], ",", 
          RowBox[{"\"\<*6\>\"", "\[Rule]", "\"\<Table[#,{6}]&@\>\""}], ",", 
          RowBox[{"\"\<*5\>\"", "\[Rule]", "\"\<Table[#,{5}]&@\>\""}], ",", 
          RowBox[{"\"\<*4\>\"", "\[Rule]", "\"\<Table[#,{4}]&@\>\""}], ",", 
          RowBox[{"\"\<*3\>\"", "\[Rule]", "\"\<Table[#,{3}]&@\>\""}], ",", 
          RowBox[{"\"\<*2\>\"", "\[Rule]", "\"\<Table[#,{2}]&@\>\""}], ",", 
          RowBox[{"\"\<*1\>\"", "\[Rule]", "\"\<Table[#,{1}]&@\>\""}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"\"\<-\>\"", "\[Rule]", "\"\<Reverse@MADFlatten@\>\""}]}], 
         "}"}]}], "]"}]}], ";", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "b"}], "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4190728045233154`*^9, 3.4190728077110806`*^9}, {
  3.4804138058630433`*^9, 3.4804138060192957`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fconstantRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "b", "]"}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<&\\n\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<\\n\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", "b"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"NumberQ", "[", 
              RowBox[{"StringTake", "[", 
               RowBox[{"d", ",", 
                RowBox[{"{", 
                 RowBox[{"#", "-", "1"}], "}"}]}], "]"}], "]"}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"NumberQ", "[", 
                RowBox[{"StringTake", "[", 
                 RowBox[{"d", ",", 
                  RowBox[{"{", 
                   RowBox[{"#", "+", "1"}], "}"}]}], "]"}], "]"}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"d", ",", 
                  RowBox[{"{", 
                   RowBox[{"#", "+", "1"}], "}"}]}], "]"}], "===", 
                "\"\<+\>\""}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"d", ",", 
                  RowBox[{"{", 
                   RowBox[{"#", "+", "1"}], "}"}]}], "]"}], "===", 
                "\"\<-\>\""}], ")"}]}], ")"}]}], ",", 
           RowBox[{"d", "=", 
            RowBox[{"StringReplacePart", "[", 
             RowBox[{"d", ",", "\"\<*10*^\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "#"}], "}"}]}], "]"}]}]}], "]"}], ")"}], 
        "&"}], "/@", 
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"d", ",", "\"\<E\>\""}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "d"}], "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"FormatMADFile", "[", "file_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "readfile", "}"}], ",", 
    RowBox[{
     RowBox[{"readfile", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"Cell", "[", 
        RowBox[{"\"\<Element Definitions\>\"", ",", "\"\<Subsection\>\""}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fconstantRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:=*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"Cell", "[", 
        RowBox[{"\"\<Quadrupoles & Bends\>\"", ",", "\"\<Subsubsection\>\""}],
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fquadRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*QUAD*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fsbendRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*SBEND*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"frbendRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*RBEND*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"flcavRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*LCAVITY*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"Cell", "[", 
        RowBox[{"\"\<Sextupoles\>\"", ",", "\"\<Subsubsection\>\""}], "]"}]}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fsextRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*SEXT*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"foctRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*OCT*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fsolenoidRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*SOL*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fmultipoleRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*MULTIPOLE*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"Cell", "[", 
        RowBox[{"\"\<Monitors & Kickers\>\"", ",", "\"\<Subsubsection\>\""}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fmonitorRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*MONITOR*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fkickerRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*KICKER*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"Cell", "[", 
        RowBox[{"\"\<Drifts\>\"", ",", "\"\<Subsubsection\>\""}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fdriftRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*DRIF*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fmarkerRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*MARK*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"frcollRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*RCOLL*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fecollRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*ECOLL*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"fdriftRead2", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*MATRIX*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"Cell", "[", 
        RowBox[{"\"\<Lines\>\"", ",", "\"\<Subsubsection\>\""}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"flineRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*LINE*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.6255732421138387`*^9, {3.625573291004615*^9, 3.6255732911491437`*^9}}],

Cell[BoxData["fecollRead"], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FormatMADLines", "[", "file_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "readfile", "}"}], ",", 
    RowBox[{
     RowBox[{"readfile", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NotebookWrite", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", 
       RowBox[{"Cell", "[", 
        RowBox[{"\"\<Lines\>\"", ",", "\"\<Subsubsection\>\""}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"flineRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:*LINE*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Functions to Read In MAD Files and reassign element definitions (no output)\
\>", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"quadRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<quad[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"\"\<\\\"\>\"", "<>", 
              RowBox[{"Extract", "[", 
               RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], "&"}], 
            "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"Position", "[", 
                RowBox[{"c", ",", 
                 RowBox[{"_", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                   ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ",", 
           RowBox[{"\"\<\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"sbendRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<sbend[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FOCUS\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], ")"}], "]"}], ">",
             "0"}], ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"NumberRight", "@", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"ToString", "[", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FOCUS\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
               "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
         "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<ANGLE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], ")"}], "]"}], ">",
             "0"}], ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"NumberRight", "@", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"ToString", "[", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<ANGLE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
               "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
         "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<\\\"\>\"", "<>", 
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"\"\<\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"\"\<,E1\[Rule]\>\"", "<>", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], ",", 
           "\"\<\>\""}], "]"}], "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"\"\<,E2\[Rule]\>\"", "<>", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], ",", 
           "\"\<\>\""}], "]"}], "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FINT\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"\"\<,FInt\[Rule]\>\"", "<>", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FINT\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], ",", 
           "\"\<\>\""}], "]"}], "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FINTX\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"\"\<,FIntX\[Rule]\>\"", "<>", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FINTX\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], ",", 
           "\"\<\>\""}], "]"}], "<>", "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4806774771046753`*^9, 3.4806774958392897`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rbendRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<rbend[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{
              "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
           "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FOCUS\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], ")"}], "]"}], ">",
             "0"}], ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"NumberRight", "@", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"ToString", "[", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FOCUS\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
               "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
         "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<ANGLE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], ")"}], "]"}], ">",
             "0"}], ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"NumberRight", "@", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"ToString", "[", 
                RowBox[{"First", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<ANGLE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
               "]"}], "]"}]}], "]"}], ",", "\"\<0\>\""}], "]"}], "<>", 
         "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<\\\"\>\"", "<>", 
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"\"\<\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{
                 "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", 
                 RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}],
               "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"\"\<,E1\[Rule]\>\"", "<>", 
            RowBox[{"NumberRight", "@", 
             RowBox[{"First", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"First", "@", 
                   RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}]}], 
           ",", "\"\<\>\""}], "]"}], "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"\"\<,E2\[Rule]\>\"", "<>", 
            RowBox[{"NumberRight", "@", 
             RowBox[{"First", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"First", "@", 
                   RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<E2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}]}], 
           ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FINT\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"\"\<,FInt\[Rule]\>\"", "<>", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FINT\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], ",", 
           "\"\<\>\""}], "]"}], "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
                    RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FINTX\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"\"\<,FIntX\[Rule]\>\"", "<>", 
            RowBox[{"First", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FINTX\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], ",", 
           "\"\<\>\""}], "]"}], "<>", "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.480677516402053*^9, 3.480677524011525*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"octRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<oct[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{
             "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "]"}], 
         "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K3\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<\\\"\>\"", "<>", 
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"\"\<\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{
                 "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", 
                 RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}],
               "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         "\"\<,Thin\[Rule]usethin\>\"", "<>", "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"sextRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<sext[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<\\\"\>\"", "<>", 
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"\"\<\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         "\"\<,Thin\[Rule]usethin\>\"", "<>", "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"monitorRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\""}],
           "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<bpm[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"NumberRight", "@", 
             RowBox[{"First", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Extract", "[", 
                  RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"First", "@", 
                   RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
            ",", "\"\<0\>\""}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<\\\"\>\"", "<>", 
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"\"\<\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"kickerRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<kick[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<HKICK\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<VKICK\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<\\\"\>\"", "<>", 
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"\"\<\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"hkickerRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<hkick[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<KICK\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<\\\"\>\"", "<>", 
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"\"\<\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"vkickerRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<vkick[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<KICK\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<\\\"\>\"", "<>", 
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"\"\<\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"driftRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "a", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<drift[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<\\\"\>\"", "<>", 
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"\"\<\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6255730745118246`*^9, 3.625573076123147*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"collimatorRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<rcoll[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         "\[IndentingNewLine]", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<XSIZE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         "\[IndentingNewLine]", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<YSIZE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\"\<,\>\"", "<>", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<\\\"\>\"", "<>", 
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"\"\<\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"driftRead2", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<drift[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringReplace", "[", 
             RowBox[{
              RowBox[{
              "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}], 
           "]"}], "]"}], "<>", "\"\<,\>\"", "<>", "\"\<0\>\"", "<>", 
         "\"\<,\>\"", "<>", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<\\\"\>\"", "<>", 
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"\"\<\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{
                 "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", 
                 RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], "]"}],
               "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"lcavRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<lcav[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"NumberRight", "@", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"ToString", "[", 
              RowBox[{"First", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], "]"}], 
             "]"}], "]"}]}], "]"}], "<>", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<,\\\"\>\"", "<>", 
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"\"\<,\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<DELTAE\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,VoltageGain\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<DELTAE\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}],
               "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<PHI0\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,CavityPhase\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<PHI0\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FREQ\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,Frequency\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<FREQ\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<ELOSS\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,LossFactor\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<ELOSS\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<VOLTERR\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,VoltageError\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<VOLTERR\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}],
               "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<LAGERR\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,LagError\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<LAGERR\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}],
               "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<NBIN\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,NumberBins\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<NBIN\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<BINMAX\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,MaxBinLength\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<BINMAX\>\""}], "]"}], 
                    "&"}], ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}],
               "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<LFILE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,LWakefieldFile\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<LFILE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TFILE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,TWakefieldFile\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TFILE\>\""}], "]"}], "&"}],
                     ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"multipoleRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"ReplaceExponent", "[", "b", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "=", 
          RowBox[{"StringToStream", "[", "a", "]"}]}], ")"}], ",", "Word", 
        ",", 
        RowBox[{"WordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<:\>\"", ",", "\"\<,\>\"", ",", "\"\<=\>\"", ",", "\"\<!\>\"", 
           ",", "\"\<&\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"Close", "[", "b", "]"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<Global`\>\"", "<>", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "]"}], "]"}], "]"}], "===", "List"}], ",", 
       RowBox[{"Madtomma`MADInput`MADInput`MADClear", "[", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"\"\<Global`\>\"", "<>", 
          RowBox[{
          "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"\"\<multipole[\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"Evaluate", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"First", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"\"\<\\\"\>\"", "<>", 
                RowBox[{"Extract", "[", 
                 RowBox[{"c", ",", "#"}], "]"}], "<>", "\"\<\\\"\>\""}], 
               "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"c", ",", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<TYPE\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}], ",", 
           RowBox[{"\"\<\\\"\>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"ToExpression", "[", 
               RowBox[{
               "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "]"}], "]"}], "<>", "\"\<\\\"\>\""}]}], "]"}], "<>", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<LRAD\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,LRAD\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<LRAD\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K0L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,K0L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K0L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T0\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,T0\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T0\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K1L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,K1L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K1L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,T1\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T1\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K2L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,K2L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K2L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,T2\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T2\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K3L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,K3L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K3L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T3\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,T3\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T3\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K4L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,K4L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K4L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T4\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,T4\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T4\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K5L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,K5L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K5L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T5\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,T5\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T5\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K6L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,K6L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K6L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T6\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,T6\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T6\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K7L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,K7L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K7L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T7\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,T7\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T7\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K8L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,K8L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K8L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T8\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,T8\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T8\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K9L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,K9L\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<K9L\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "<>", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"c", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"c", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T9\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}], "+", "1"}], ")"}]}], "]"}], 
            "\[GreaterEqual]", "1"}], ",", 
           RowBox[{"StringReplace", "[", 
            RowBox[{
             RowBox[{"ToString", "[", 
              RowBox[{"NumberRight", "@", 
               RowBox[{"First", "@", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\"\<,T9\[Rule]\>\"", "<>", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"c", ",", "#"}], "]"}]}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"c", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"ToUpperCase", "[", 
                    RowBox[{"StringReplace", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], "}"}]}], 
                    "]"}], "]"}], "]"}], ",", "\"\<T9\>\""}], "]"}], "&"}], 
                    ")"}]}]}], "]"}]}], "+", "1"}], ")"}]}], ")"}]}]}], "]"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", "\[Rule]", "\"\<*10^\>\""}], "}"}]}], 
            "]"}], ",", "\"\<\>\""}], "]"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "<>", "\"\<]\>\""}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}], 
      "]"}], ";", 
     RowBox[{"SelectionMove", "[", 
      RowBox[{
       RowBox[{"SelectedNotebook", "[", "]"}], ",", "After", ",", "Cell"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"lineRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "b", "]"}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<:LINE=(\>\"", "\[Rule]", "\"\<:={\>\""}], ",", 
          RowBox[{"\"\<:Line=(\>\"", "\[Rule]", "\"\<:={\>\""}], ",", 
          RowBox[{"\"\<:line=(\>\"", "\[Rule]", "\"\<:={\>\""}], ",", 
          RowBox[{"\"\<&\\n\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<)\>\"", "\[Rule]", "\"\<}\>\""}], ",", 
          RowBox[{"\"\<\\n\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<LINE\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<(\>\"", "\[Rule]", "\"\<{\>\""}], ",", 
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<100*\>\"", "\[Rule]", "\"\<Table[#,{100}]&@\>\""}], 
          ",", 
          RowBox[{"\"\<99*\>\"", "\[Rule]", "\"\<Table[#,{99}]&@\>\""}], ",", 
          RowBox[{"\"\<98*\>\"", "\[Rule]", "\"\<Table[#,{98}]&@\>\""}], ",", 
          RowBox[{"\"\<97*\>\"", "\[Rule]", "\"\<Table[#,{97}]&@\>\""}], ",", 
          RowBox[{"\"\<96*\>\"", "\[Rule]", "\"\<Table[#,{96}]&@\>\""}], ",", 
          RowBox[{"\"\<95*\>\"", "\[Rule]", "\"\<Table[#,{95}]&@\>\""}], ",", 
          RowBox[{"\"\<94*\>\"", "\[Rule]", "\"\<Table[#,{94}]&@\>\""}], ",", 
          RowBox[{"\"\<93*\>\"", "\[Rule]", "\"\<Table[#,{93}]&@\>\""}], ",", 
          RowBox[{"\"\<92*\>\"", "\[Rule]", "\"\<Table[#,{92}]&@\>\""}], ",", 
          RowBox[{"\"\<91*\>\"", "\[Rule]", "\"\<Table[#,{91}]&@\>\""}], ",", 
          RowBox[{"\"\<90*\>\"", "\[Rule]", "\"\<Table[#,{90}]&@\>\""}], ",", 
          RowBox[{"\"\<89*\>\"", "\[Rule]", "\"\<Table[#,{89}]&@\>\""}], ",", 
          RowBox[{"\"\<88*\>\"", "\[Rule]", "\"\<Table[#,{88}]&@\>\""}], ",", 
          RowBox[{"\"\<87*\>\"", "\[Rule]", "\"\<Table[#,{87}]&@\>\""}], ",", 
          RowBox[{"\"\<86*\>\"", "\[Rule]", "\"\<Table[#,{86}]&@\>\""}], ",", 
          RowBox[{"\"\<85*\>\"", "\[Rule]", "\"\<Table[#,{85}]&@\>\""}], ",", 
          RowBox[{"\"\<84*\>\"", "\[Rule]", "\"\<Table[#,{84}]&@\>\""}], ",", 
          RowBox[{"\"\<83*\>\"", "\[Rule]", "\"\<Table[#,{83}]&@\>\""}], ",", 
          RowBox[{"\"\<82*\>\"", "\[Rule]", "\"\<Table[#,{82}]&@\>\""}], ",", 
          RowBox[{"\"\<81*\>\"", "\[Rule]", "\"\<Table[#,{81}]&@\>\""}], ",", 
          RowBox[{"\"\<80*\>\"", "\[Rule]", "\"\<Table[#,{80}]&@\>\""}], ",", 
          RowBox[{"\"\<79*\>\"", "\[Rule]", "\"\<Table[#,{79}]&@\>\""}], ",", 
          RowBox[{"\"\<78*\>\"", "\[Rule]", "\"\<Table[#,{78}]&@\>\""}], ",", 
          RowBox[{"\"\<77*\>\"", "\[Rule]", "\"\<Table[#,{77}]&@\>\""}], ",", 
          RowBox[{"\"\<76*\>\"", "\[Rule]", "\"\<Table[#,{76}]&@\>\""}], ",", 
          RowBox[{"\"\<75*\>\"", "\[Rule]", "\"\<Table[#,{75}]&@\>\""}], ",", 
          RowBox[{"\"\<74*\>\"", "\[Rule]", "\"\<Table[#,{74}]&@\>\""}], ",", 
          RowBox[{"\"\<73*\>\"", "\[Rule]", "\"\<Table[#,{73}]&@\>\""}], ",", 
          RowBox[{"\"\<72*\>\"", "\[Rule]", "\"\<Table[#,{72}]&@\>\""}], ",", 
          RowBox[{"\"\<71*\>\"", "\[Rule]", "\"\<Table[#,{71}]&@\>\""}], ",", 
          RowBox[{"\"\<70*\>\"", "\[Rule]", "\"\<Table[#,{70}]&@\>\""}], ",", 
          RowBox[{"\"\<69*\>\"", "\[Rule]", "\"\<Table[#,{69}]&@\>\""}], ",", 
          RowBox[{"\"\<68*\>\"", "\[Rule]", "\"\<Table[#,{68}]&@\>\""}], ",", 
          RowBox[{"\"\<67*\>\"", "\[Rule]", "\"\<Table[#,{67}]&@\>\""}], ",", 
          RowBox[{"\"\<66*\>\"", "\[Rule]", "\"\<Table[#,{66}]&@\>\""}], ",", 
          RowBox[{"\"\<65*\>\"", "\[Rule]", "\"\<Table[#,{65}]&@\>\""}], ",", 
          RowBox[{"\"\<64*\>\"", "\[Rule]", "\"\<Table[#,{64}]&@\>\""}], ",", 
          RowBox[{"\"\<63*\>\"", "\[Rule]", "\"\<Table[#,{63}]&@\>\""}], ",", 
          RowBox[{"\"\<62*\>\"", "\[Rule]", "\"\<Table[#,{62}]&@\>\""}], ",", 
          RowBox[{"\"\<61*\>\"", "\[Rule]", "\"\<Table[#,{61}]&@\>\""}], ",", 
          RowBox[{"\"\<60*\>\"", "\[Rule]", "\"\<Table[#,{60}]&@\>\""}], ",", 
          RowBox[{"\"\<59*\>\"", "\[Rule]", "\"\<Table[#,{59}]&@\>\""}], ",", 
          RowBox[{"\"\<58*\>\"", "\[Rule]", "\"\<Table[#,{58}]&@\>\""}], ",", 
          RowBox[{"\"\<57*\>\"", "\[Rule]", "\"\<Table[#,{57}]&@\>\""}], ",", 
          RowBox[{"\"\<56*\>\"", "\[Rule]", "\"\<Table[#,{56}]&@\>\""}], ",", 
          RowBox[{"\"\<55*\>\"", "\[Rule]", "\"\<Table[#,{55}]&@\>\""}], ",", 
          RowBox[{"\"\<54*\>\"", "\[Rule]", "\"\<Table[#,{54}]&@\>\""}], ",", 
          RowBox[{"\"\<53*\>\"", "\[Rule]", "\"\<Table[#,{53}]&@\>\""}], ",", 
          RowBox[{"\"\<52*\>\"", "\[Rule]", "\"\<Table[#,{52}]&@\>\""}], ",", 
          RowBox[{"\"\<51*\>\"", "\[Rule]", "\"\<Table[#,{51}]&@\>\""}], ",", 
          RowBox[{"\"\<50*\>\"", "\[Rule]", "\"\<Table[#,{50}]&@\>\""}], ",", 
          RowBox[{"\"\<49*\>\"", "\[Rule]", "\"\<Table[#,{49}]&@\>\""}], ",", 
          RowBox[{"\"\<48*\>\"", "\[Rule]", "\"\<Table[#,{48}]&@\>\""}], ",", 
          RowBox[{"\"\<47*\>\"", "\[Rule]", "\"\<Table[#,{47}]&@\>\""}], ",", 
          RowBox[{"\"\<46*\>\"", "\[Rule]", "\"\<Table[#,{46}]&@\>\""}], ",", 
          RowBox[{"\"\<45*\>\"", "\[Rule]", "\"\<Table[#,{45}]&@\>\""}], ",", 
          RowBox[{"\"\<44*\>\"", "\[Rule]", "\"\<Table[#,{44}]&@\>\""}], ",", 
          RowBox[{"\"\<43*\>\"", "\[Rule]", "\"\<Table[#,{43}]&@\>\""}], ",", 
          RowBox[{"\"\<42*\>\"", "\[Rule]", "\"\<Table[#,{42}]&@\>\""}], ",", 
          RowBox[{"\"\<41*\>\"", "\[Rule]", "\"\<Table[#,{41}]&@\>\""}], ",", 
          RowBox[{"\"\<40*\>\"", "\[Rule]", "\"\<Table[#,{40}]&@\>\""}], ",", 
          RowBox[{"\"\<39*\>\"", "\[Rule]", "\"\<Table[#,{39}]&@\>\""}], ",", 
          RowBox[{"\"\<38*\>\"", "\[Rule]", "\"\<Table[#,{38}]&@\>\""}], ",", 
          RowBox[{"\"\<37*\>\"", "\[Rule]", "\"\<Table[#,{37}]&@\>\""}], ",", 
          RowBox[{"\"\<36*\>\"", "\[Rule]", "\"\<Table[#,{36}]&@\>\""}], ",", 
          RowBox[{"\"\<35*\>\"", "\[Rule]", "\"\<Table[#,{35}]&@\>\""}], ",", 
          RowBox[{"\"\<34*\>\"", "\[Rule]", "\"\<Table[#,{34}]&@\>\""}], ",", 
          RowBox[{"\"\<33*\>\"", "\[Rule]", "\"\<Table[#,{33}]&@\>\""}], ",", 
          RowBox[{"\"\<32*\>\"", "\[Rule]", "\"\<Table[#,{32}]&@\>\""}], ",", 
          RowBox[{"\"\<31*\>\"", "\[Rule]", "\"\<Table[#,{31}]&@\>\""}], ",", 
          RowBox[{"\"\<30*\>\"", "\[Rule]", "\"\<Table[#,{30}]&@\>\""}], ",", 
          RowBox[{"\"\<29*\>\"", "\[Rule]", "\"\<Table[#,{29}]&@\>\""}], ",", 
          RowBox[{"\"\<28*\>\"", "\[Rule]", "\"\<Table[#,{28}]&@\>\""}], ",", 
          RowBox[{"\"\<27*\>\"", "\[Rule]", "\"\<Table[#,{27}]&@\>\""}], ",", 
          RowBox[{"\"\<26*\>\"", "\[Rule]", "\"\<Table[#,{26}]&@\>\""}], ",", 
          RowBox[{"\"\<25*\>\"", "\[Rule]", "\"\<Table[#,{25}]&@\>\""}], ",", 
          RowBox[{"\"\<24*\>\"", "\[Rule]", "\"\<Table[#,{24}]&@\>\""}], ",", 
          RowBox[{"\"\<23*\>\"", "\[Rule]", "\"\<Table[#,{23}]&@\>\""}], ",", 
          RowBox[{"\"\<22*\>\"", "\[Rule]", "\"\<Table[#,{22}]&@\>\""}], ",", 
          RowBox[{"\"\<21*\>\"", "\[Rule]", "\"\<Table[#,{21}]&@\>\""}], ",", 
          RowBox[{"\"\<20*\>\"", "\[Rule]", "\"\<Table[#,{20}]&@\>\""}], ",", 
          RowBox[{"\"\<19*\>\"", "\[Rule]", "\"\<Table[#,{19}]&@\>\""}], ",", 
          RowBox[{"\"\<18*\>\"", "\[Rule]", "\"\<Table[#,{18}]&@\>\""}], ",", 
          RowBox[{"\"\<17*\>\"", "\[Rule]", "\"\<Table[#,{17}]&@\>\""}], ",", 
          RowBox[{"\"\<16*\>\"", "\[Rule]", "\"\<Table[#,{16}]&@\>\""}], ",", 
          RowBox[{"\"\<15*\>\"", "\[Rule]", "\"\<Table[#,{15}]&@\>\""}], ",", 
          RowBox[{"\"\<14*\>\"", "\[Rule]", "\"\<Table[#,{14}]&@\>\""}], ",", 
          RowBox[{"\"\<13*\>\"", "\[Rule]", "\"\<Table[#,{13}]&@\>\""}], ",", 
          RowBox[{"\"\<12*\>\"", "\[Rule]", "\"\<Table[#,{12}]&@\>\""}], ",", 
          RowBox[{"\"\<11*\>\"", "\[Rule]", "\"\<Table[#,{11}]&@\>\""}], ",", 
          RowBox[{"\"\<10*\>\"", "\[Rule]", "\"\<Table[#,{10}]&@\>\""}], ",", 
          RowBox[{"\"\<9*\>\"", "\[Rule]", "\"\<Table[#,{9}]&@\>\""}], ",", 
          RowBox[{"\"\<8*\>\"", "\[Rule]", "\"\<Table[#,{8}]&@\>\""}], ",", 
          RowBox[{"\"\<7*\>\"", "\[Rule]", "\"\<Table[#,{7}]&@\>\""}], ",", 
          RowBox[{"\"\<6*\>\"", "\[Rule]", "\"\<Table[#,{6}]&@\>\""}], ",", 
          RowBox[{"\"\<5*\>\"", "\[Rule]", "\"\<Table[#,{5}]&@\>\""}], ",", 
          RowBox[{"\"\<4*\>\"", "\[Rule]", "\"\<Table[#,{4}]&@\>\""}], ",", 
          RowBox[{"\"\<3*\>\"", "\[Rule]", "\"\<Table[#,{3}]&@\>\""}], ",", 
          RowBox[{"\"\<2*\>\"", "\[Rule]", "\"\<Table[#,{2}]&@\>\""}], ",", 
          RowBox[{"\"\<1*\>\"", "\[Rule]", "\"\<Table[#,{1}]&@\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<*100\>\"", "\[Rule]", "\"\<Table[#,{100}]&@\>\""}], 
          ",", 
          RowBox[{"\"\<*99\>\"", "\[Rule]", "\"\<Table[#,{99}]&@\>\""}], ",", 
          RowBox[{"\"\<*98\>\"", "\[Rule]", "\"\<Table[#,{98}]&@\>\""}], ",", 
          RowBox[{"\"\<*97\>\"", "\[Rule]", "\"\<Table[#,{97}]&@\>\""}], ",", 
          RowBox[{"\"\<*96\>\"", "\[Rule]", "\"\<Table[#,{96}]&@\>\""}], ",", 
          RowBox[{"\"\<*95\>\"", "\[Rule]", "\"\<Table[#,{95}]&@\>\""}], ",", 
          RowBox[{"\"\<*94\>\"", "\[Rule]", "\"\<Table[#,{94}]&@\>\""}], ",", 
          RowBox[{"\"\<*93\>\"", "\[Rule]", "\"\<Table[#,{93}]&@\>\""}], ",", 
          RowBox[{"\"\<*92\>\"", "\[Rule]", "\"\<Table[#,{92}]&@\>\""}], ",", 
          RowBox[{"\"\<*91\>\"", "\[Rule]", "\"\<Table[#,{91}]&@\>\""}], ",", 
          RowBox[{"\"\<*90\>\"", "\[Rule]", "\"\<Table[#,{90}]&@\>\""}], ",", 
          RowBox[{"\"\<*89\>\"", "\[Rule]", "\"\<Table[#,{89}]&@\>\""}], ",", 
          RowBox[{"\"\<*88\>\"", "\[Rule]", "\"\<Table[#,{88}]&@\>\""}], ",", 
          RowBox[{"\"\<*87\>\"", "\[Rule]", "\"\<Table[#,{87}]&@\>\""}], ",", 
          RowBox[{"\"\<*86\>\"", "\[Rule]", "\"\<Table[#,{86}]&@\>\""}], ",", 
          RowBox[{"\"\<*85\>\"", "\[Rule]", "\"\<Table[#,{85}]&@\>\""}], ",", 
          RowBox[{"\"\<*84\>\"", "\[Rule]", "\"\<Table[#,{84}]&@\>\""}], ",", 
          RowBox[{"\"\<*83\>\"", "\[Rule]", "\"\<Table[#,{83}]&@\>\""}], ",", 
          RowBox[{"\"\<*82\>\"", "\[Rule]", "\"\<Table[#,{82}]&@\>\""}], ",", 
          RowBox[{"\"\<*81\>\"", "\[Rule]", "\"\<Table[#,{81}]&@\>\""}], ",", 
          RowBox[{"\"\<*80\>\"", "\[Rule]", "\"\<Table[#,{80}]&@\>\""}], ",", 
          RowBox[{"\"\<*79\>\"", "\[Rule]", "\"\<Table[#,{79}]&@\>\""}], ",", 
          RowBox[{"\"\<*78\>\"", "\[Rule]", "\"\<Table[#,{78}]&@\>\""}], ",", 
          RowBox[{"\"\<*77\>\"", "\[Rule]", "\"\<Table[#,{77}]&@\>\""}], ",", 
          RowBox[{"\"\<*76\>\"", "\[Rule]", "\"\<Table[#,{76}]&@\>\""}], ",", 
          RowBox[{"\"\<*75\>\"", "\[Rule]", "\"\<Table[#,{75}]&@\>\""}], ",", 
          RowBox[{"\"\<*74\>\"", "\[Rule]", "\"\<Table[#,{74}]&@\>\""}], ",", 
          RowBox[{"\"\<*73\>\"", "\[Rule]", "\"\<Table[#,{73}]&@\>\""}], ",", 
          RowBox[{"\"\<*72\>\"", "\[Rule]", "\"\<Table[#,{72}]&@\>\""}], ",", 
          RowBox[{"\"\<*71\>\"", "\[Rule]", "\"\<Table[#,{71}]&@\>\""}], ",", 
          RowBox[{"\"\<*70\>\"", "\[Rule]", "\"\<Table[#,{70}]&@\>\""}], ",", 
          RowBox[{"\"\<*69\>\"", "\[Rule]", "\"\<Table[#,{69}]&@\>\""}], ",", 
          RowBox[{"\"\<*68\>\"", "\[Rule]", "\"\<Table[#,{68}]&@\>\""}], ",", 
          RowBox[{"\"\<*67\>\"", "\[Rule]", "\"\<Table[#,{67}]&@\>\""}], ",", 
          RowBox[{"\"\<*66\>\"", "\[Rule]", "\"\<Table[#,{66}]&@\>\""}], ",", 
          RowBox[{"\"\<*65\>\"", "\[Rule]", "\"\<Table[#,{65}]&@\>\""}], ",", 
          RowBox[{"\"\<*64\>\"", "\[Rule]", "\"\<Table[#,{64}]&@\>\""}], ",", 
          RowBox[{"\"\<*63\>\"", "\[Rule]", "\"\<Table[#,{63}]&@\>\""}], ",", 
          RowBox[{"\"\<*62\>\"", "\[Rule]", "\"\<Table[#,{62}]&@\>\""}], ",", 
          RowBox[{"\"\<*61\>\"", "\[Rule]", "\"\<Table[#,{61}]&@\>\""}], ",", 
          RowBox[{"\"\<*60\>\"", "\[Rule]", "\"\<Table[#,{60}]&@\>\""}], ",", 
          RowBox[{"\"\<*59\>\"", "\[Rule]", "\"\<Table[#,{59}]&@\>\""}], ",", 
          RowBox[{"\"\<*58\>\"", "\[Rule]", "\"\<Table[#,{58}]&@\>\""}], ",", 
          RowBox[{"\"\<*57\>\"", "\[Rule]", "\"\<Table[#,{57}]&@\>\""}], ",", 
          RowBox[{"\"\<*56\>\"", "\[Rule]", "\"\<Table[#,{56}]&@\>\""}], ",", 
          RowBox[{"\"\<*55\>\"", "\[Rule]", "\"\<Table[#,{55}]&@\>\""}], ",", 
          RowBox[{"\"\<*54\>\"", "\[Rule]", "\"\<Table[#,{54}]&@\>\""}], ",", 
          RowBox[{"\"\<*53\>\"", "\[Rule]", "\"\<Table[#,{53}]&@\>\""}], ",", 
          RowBox[{"\"\<*52\>\"", "\[Rule]", "\"\<Table[#,{52}]&@\>\""}], ",", 
          RowBox[{"\"\<*51\>\"", "\[Rule]", "\"\<Table[#,{51}]&@\>\""}], ",", 
          RowBox[{"\"\<*50\>\"", "\[Rule]", "\"\<Table[#,{50}]&@\>\""}], ",", 
          RowBox[{"\"\<*49\>\"", "\[Rule]", "\"\<Table[#,{49}]&@\>\""}], ",", 
          RowBox[{"\"\<*48\>\"", "\[Rule]", "\"\<Table[#,{48}]&@\>\""}], ",", 
          RowBox[{"\"\<*47\>\"", "\[Rule]", "\"\<Table[#,{47}]&@\>\""}], ",", 
          RowBox[{"\"\<*46\>\"", "\[Rule]", "\"\<Table[#,{46}]&@\>\""}], ",", 
          RowBox[{"\"\<*45\>\"", "\[Rule]", "\"\<Table[#,{45}]&@\>\""}], ",", 
          RowBox[{"\"\<*44\>\"", "\[Rule]", "\"\<Table[#,{44}]&@\>\""}], ",", 
          RowBox[{"\"\<*43\>\"", "\[Rule]", "\"\<Table[#,{43}]&@\>\""}], ",", 
          RowBox[{"\"\<*42\>\"", "\[Rule]", "\"\<Table[#,{42}]&@\>\""}], ",", 
          RowBox[{"\"\<*41\>\"", "\[Rule]", "\"\<Table[#,{41}]&@\>\""}], ",", 
          RowBox[{"\"\<*40\>\"", "\[Rule]", "\"\<Table[#,{40}]&@\>\""}], ",", 
          RowBox[{"\"\<*39\>\"", "\[Rule]", "\"\<Table[#,{39}]&@\>\""}], ",", 
          RowBox[{"\"\<*38\>\"", "\[Rule]", "\"\<Table[#,{38}]&@\>\""}], ",", 
          RowBox[{"\"\<*37\>\"", "\[Rule]", "\"\<Table[#,{37}]&@\>\""}], ",", 
          RowBox[{"\"\<*36\>\"", "\[Rule]", "\"\<Table[#,{36}]&@\>\""}], ",", 
          RowBox[{"\"\<*35\>\"", "\[Rule]", "\"\<Table[#,{35}]&@\>\""}], ",", 
          RowBox[{"\"\<*34\>\"", "\[Rule]", "\"\<Table[#,{34}]&@\>\""}], ",", 
          RowBox[{"\"\<*33\>\"", "\[Rule]", "\"\<Table[#,{33}]&@\>\""}], ",", 
          RowBox[{"\"\<*32\>\"", "\[Rule]", "\"\<Table[#,{32}]&@\>\""}], ",", 
          RowBox[{"\"\<*31\>\"", "\[Rule]", "\"\<Table[#,{31}]&@\>\""}], ",", 
          RowBox[{"\"\<*30\>\"", "\[Rule]", "\"\<Table[#,{30}]&@\>\""}], ",", 
          RowBox[{"\"\<*29\>\"", "\[Rule]", "\"\<Table[#,{29}]&@\>\""}], ",", 
          RowBox[{"\"\<*28\>\"", "\[Rule]", "\"\<Table[#,{28}]&@\>\""}], ",", 
          RowBox[{"\"\<*27\>\"", "\[Rule]", "\"\<Table[#,{27}]&@\>\""}], ",", 
          RowBox[{"\"\<*26\>\"", "\[Rule]", "\"\<Table[#,{26}]&@\>\""}], ",", 
          RowBox[{"\"\<*25\>\"", "\[Rule]", "\"\<Table[#,{25}]&@\>\""}], ",", 
          RowBox[{"\"\<*24\>\"", "\[Rule]", "\"\<Table[#,{24}]&@\>\""}], ",", 
          RowBox[{"\"\<*23\>\"", "\[Rule]", "\"\<Table[#,{23}]&@\>\""}], ",", 
          RowBox[{"\"\<*22\>\"", "\[Rule]", "\"\<Table[#,{22}]&@\>\""}], ",", 
          RowBox[{"\"\<*21\>\"", "\[Rule]", "\"\<Table[#,{21}]&@\>\""}], ",", 
          RowBox[{"\"\<*20\>\"", "\[Rule]", "\"\<Table[#,{20}]&@\>\""}], ",", 
          RowBox[{"\"\<*19\>\"", "\[Rule]", "\"\<Table[#,{19}]&@\>\""}], ",", 
          RowBox[{"\"\<*18\>\"", "\[Rule]", "\"\<Table[#,{18}]&@\>\""}], ",", 
          RowBox[{"\"\<*17\>\"", "\[Rule]", "\"\<Table[#,{17}]&@\>\""}], ",", 
          RowBox[{"\"\<*16\>\"", "\[Rule]", "\"\<Table[#,{16}]&@\>\""}], ",", 
          RowBox[{"\"\<*15\>\"", "\[Rule]", "\"\<Table[#,{15}]&@\>\""}], ",", 
          RowBox[{"\"\<*14\>\"", "\[Rule]", "\"\<Table[#,{14}]&@\>\""}], ",", 
          RowBox[{"\"\<*13\>\"", "\[Rule]", "\"\<Table[#,{13}]&@\>\""}], ",", 
          RowBox[{"\"\<*12\>\"", "\[Rule]", "\"\<Table[#,{12}]&@\>\""}], ",", 
          RowBox[{"\"\<*11\>\"", "\[Rule]", "\"\<Table[#,{11}]&@\>\""}], ",", 
          RowBox[{"\"\<*10\>\"", "\[Rule]", "\"\<Table[#,{10}]&@\>\""}], ",", 
          RowBox[{"\"\<*9\>\"", "\[Rule]", "\"\<Table[#,{9}]&@\>\""}], ",", 
          RowBox[{"\"\<*8\>\"", "\[Rule]", "\"\<Table[#,{8}]&@\>\""}], ",", 
          RowBox[{"\"\<*7\>\"", "\[Rule]", "\"\<Table[#,{7}]&@\>\""}], ",", 
          RowBox[{"\"\<*6\>\"", "\[Rule]", "\"\<Table[#,{6}]&@\>\""}], ",", 
          RowBox[{"\"\<*5\>\"", "\[Rule]", "\"\<Table[#,{5}]&@\>\""}], ",", 
          RowBox[{"\"\<*4\>\"", "\[Rule]", "\"\<Table[#,{4}]&@\>\""}], ",", 
          RowBox[{"\"\<*3\>\"", "\[Rule]", "\"\<Table[#,{3}]&@\>\""}], ",", 
          RowBox[{"\"\<*2\>\"", "\[Rule]", "\"\<Table[#,{2}]&@\>\""}], ",", 
          RowBox[{"\"\<*1\>\"", "\[Rule]", "\"\<Table[#,{1}]&@\>\""}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"\"\<-\>\"", "\[Rule]", "\"\<Reverse@MADFlatten@\>\""}]}], 
         "}"}]}], "]"}]}], ";", 
     RowBox[{"ToExpression", "[", "b", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.419072572624592*^9, 3.4190725951433873`*^9}, {
  3.4190726508074026`*^9, 3.4190726755594616`*^9}}],

Cell[BoxData[
 RowBox[{"Reverse", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\"\<*\>\"", "<>", 
      RowBox[{"ToString", "[", "#", "]"}]}], "\[Rule]", 
     RowBox[{"\"\<Table[#,{\>\"", "<>", 
      RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<}]&@\>\""}]}], "&"}], "/@", 
   RowBox[{"Range", "[", "100", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.419072488378357*^9, 3.4190725836730223`*^9}, {
  3.419072640587285*^9, 3.4190726674494123`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"constantRead", "[", 
   RowBox[{"pos_", ",", "file_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"a", "\[LeftDoubleBracket]", "pos", "\[RightDoubleBracket]"}]}],
      ";", 
     RowBox[{"c", "=", "pos"}], ";", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"a", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}], "===", "\"\<&\>\""}], ",", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"StringInsert", "[", 
          RowBox[{"b", ",", 
           RowBox[{"a", "\[LeftDoubleBracket]", 
            RowBox[{"c", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"-", "1"}]}], "]"}]}], ";", 
        RowBox[{"c", "+=", "1"}], ";"}]}], "]"}], ";", 
     RowBox[{"b", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "b", "]"}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<&\\n\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<\\n\>\"", "\[Rule]", "\"\<\>\""}], ",", 
          RowBox[{"\"\<&\>\"", "\[Rule]", "\"\<\>\""}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", "b"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"NumberQ", "[", 
              RowBox[{"StringTake", "[", 
               RowBox[{"d", ",", 
                RowBox[{"{", 
                 RowBox[{"#", "-", "1"}], "}"}]}], "]"}], "]"}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"NumberQ", "[", 
                RowBox[{"StringTake", "[", 
                 RowBox[{"d", ",", 
                  RowBox[{"{", 
                   RowBox[{"#", "+", "1"}], "}"}]}], "]"}], "]"}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"d", ",", 
                  RowBox[{"{", 
                   RowBox[{"#", "+", "1"}], "}"}]}], "]"}], "===", 
                "\"\<+\>\""}], ")"}], "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"d", ",", 
                  RowBox[{"{", 
                   RowBox[{"#", "+", "1"}], "}"}]}], "]"}], "===", 
                "\"\<-\>\""}], ")"}]}], ")"}]}], ",", 
           RowBox[{"d", "=", 
            RowBox[{"StringReplacePart", "[", 
             RowBox[{"d", ",", "\"\<*10^\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "#"}], "}"}]}], "]"}]}]}], "]"}], ")"}], 
        "&"}], "/@", 
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"d", ",", "\"\<E\>\""}], "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", "d", "]"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReadInMADFile", "[", "file_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "readfile", "}"}], ",", 
    RowBox[{
     RowBox[{"readfile", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Position", "[", 
       RowBox[{"readfile", ",", 
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"StringMatchQ", "[", 
             RowBox[{
              RowBox[{"StringReplace", "[", 
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
              "\"\<*:DRIF*\>\""}], "]"}], "&&", 
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "#", "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
          ")"}]}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"constantRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:=*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"quadRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:QUADRUPOLE*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"sbendRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:SBEND*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"rbendRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:RBEND*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"sextRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:SEXTUPOLE*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"octRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:OCTUPOLE*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"monitorRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:MONITOR*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"kickerRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:KICKER*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"hkickerRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:HKICKER*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"vkickerRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:VKICKER*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"driftRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:DRIF*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"collimatorRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:RCOLLIMATOR*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"driftRead2", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:MARKER*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"driftRead2", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:MATRIX*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"multipoleRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:MULTIPOLE\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"lcavRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:LCAVITY*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"lineRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"StringReplace", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
                 RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
               "\"\<*:LINE*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6255729824169097`*^9, 3.625572995005927*^9}, 
   3.625573124817884*^9, {3.6255731573998995`*^9, 3.62557315980438*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReadInMADLines", "[", "file_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "readfile", "}"}], ",", 
    RowBox[{
     RowBox[{"readfile", "=", 
      RowBox[{"ReadList", "[", 
       RowBox[{"file", ",", "Record", ",", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<;\>\"", ",", "\"\<\\n\>\""}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"lineRead", "[", 
        RowBox[{"#", ",", "file"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", 
        RowBox[{"readfile", ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringMatchQ", "[", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"ToUpperCase", "[", "#", "]"}], "]"}], ",", 
               "\"\<*:LINE*\>\""}], "]"}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "#", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "=!=", "\"\<!\>\""}]}], "&"}], 
           ")"}]}]}], "]"}]}]}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["More", "Section"],

Cell[BoxData[
 RowBox[{"End", "[", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"EndPackage", "[", "]"}]], "Input",
 InitializationCell->True]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1580, 899},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 427, 9, 31, "Input",
 InitializationCell->True],
Cell[975, 31, 143, 4, 31, "Input"],
Cell[1121, 37, 223, 6, 31, "Input",
 InitializationCell->True],
Cell[1347, 45, 146, 5, 31, "Input",
 InitializationCell->True],
Cell[1496, 52, 248, 6, 31, "Input",
 InitializationCell->True],
Cell[1747, 60, 146, 5, 31, "Input",
 InitializationCell->True],
Cell[1896, 67, 101, 2, 31, "Input",
 InitializationCell->True],
Cell[2000, 71, 3495, 92, 112, "Input",
 InitializationCell->True],
Cell[5498, 165, 365, 11, 31, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[5888, 180, 105, 2, 70, "Section"],
Cell[5996, 184, 10032, 244, 412, "Input",
 InitializationCell->True],
Cell[16031, 430, 10040, 244, 412, "Input",
 InitializationCell->True],
Cell[26074, 676, 27883, 656, 1072, "Input",
 InitializationCell->True],
Cell[53960, 1334, 16922, 407, 592, "Input",
 InitializationCell->True],
Cell[70885, 1743, 8554, 208, 412, "Input",
 InitializationCell->True],
Cell[79442, 1953, 8889, 216, 412, "Input",
 InitializationCell->True],
Cell[88334, 2171, 8480, 209, 352, "Input",
 InitializationCell->True],
Cell[96817, 2382, 13917, 334, 492, "Input",
 InitializationCell->True],
Cell[110737, 2718, 7673, 188, 332, "Input",
 InitializationCell->True],
Cell[118413, 2908, 6361, 158, 272, "Input",
 InitializationCell->True],
Cell[124777, 3068, 6313, 157, 272, "Input",
 InitializationCell->True],
Cell[131093, 3227, 14009, 334, 532, "Input",
 InitializationCell->True],
Cell[145105, 3563, 14009, 334, 532, "Input",
 InitializationCell->True],
Cell[159117, 3899, 33008, 778, 1312, "Input",
 InitializationCell->True],
Cell[192128, 4679, 60148, 1418, 1972, "Input",
 InitializationCell->True],
Cell[252279, 6099, 18864, 274, 912, "Input",
 InitializationCell->True],
Cell[271146, 6375, 4039, 104, 232, "Input",
 InitializationCell->True],
Cell[275188, 6481, 18776, 477, 492, "Input",
 InitializationCell->True],
Cell[293967, 6960, 36, 0, 31, "Input"],
Cell[294006, 6962, 1711, 45, 72, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[295754, 7012, 102, 2, 70, "Section"],
Cell[295859, 7016, 8125, 200, 392, "Input",
 InitializationCell->True],
Cell[303987, 7218, 20832, 502, 632, "Input",
 InitializationCell->True],
Cell[324822, 7722, 21241, 512, 632, "Input",
 InitializationCell->True],
Cell[346066, 8236, 8551, 209, 392, "Input",
 InitializationCell->True],
Cell[354620, 8447, 8260, 202, 392, "Input",
 InitializationCell->True],
Cell[362883, 8651, 7832, 195, 332, "Input",
 InitializationCell->True],
Cell[370718, 8848, 9600, 233, 452, "Input",
 InitializationCell->True],
Cell[380321, 9083, 8303, 203, 372, "Input",
 InitializationCell->True],
Cell[388627, 9288, 8303, 203, 372, "Input",
 InitializationCell->True],
Cell[396933, 9493, 7140, 175, 312, "Input",
 InitializationCell->True],
Cell[404076, 9670, 9704, 236, 432, "Input",
 InitializationCell->True],
Cell[413783, 9908, 6087, 152, 232, "Input",
 InitializationCell->True],
Cell[419873, 10062, 32562, 776, 1312, "Input",
 InitializationCell->True],
Cell[452438, 10840, 59037, 1408, 1972, "Input",
 InitializationCell->True],
Cell[511478, 12250, 18510, 265, 892, "Input",
 InitializationCell->True],
Cell[529991, 12517, 466, 11, 31, "Input"],
Cell[530460, 12530, 3824, 98, 212, "Input",
 InitializationCell->True],
Cell[534287, 12630, 18110, 462, 392, "Input",
 InitializationCell->True],
Cell[552400, 13094, 1306, 36, 52, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[553743, 13135, 23, 0, 70, "Section"],
Cell[553769, 13137, 78, 2, 31, "Input",
 InitializationCell->True],
Cell[553850, 13141, 85, 2, 31, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
