(*******************************************************************
This file was generated automatically by the Mathematica front end.
It contains Initialization cells from a Notebook file, which
typically will have the same name as this file except ending in
".nb" instead of ".m".

This file is intended to be loaded into the Mathematica kernel using
the package loading commands Get or Needs.  Doing so is equivalent
to using the Evaluate Initialization Cells menu command in the front
end.

DO NOT EDIT THIS FILE.  This entire file is regenerated
automatically each time the parent Notebook file is saved in the
Mathematica front end.  Any changes you make to this file will be
overwritten.
***********************************************************************)

















































































































BeginPackage["Madtomma`Algebra`Symplectic`",
{"LinearAlgebra`MatrixManipulation`",
    "JMJUtils`BumpEtc`"}]



Symplectic::usage=
    "Symplectic.m is a package that provides functions for manipulating \
synplectic matrices.";

SymplecticQ::usage=
    "SymplecticQ[mat] tests whether the matrix mat is symplectic, returning \
True or False where it can decide.  For numerical matrices, it uses the \
option SymplecticTolerance.";

SymplecticJ::usage="SymplecticJ[n] is the 2n by 2n symplectic unit matrix.";

SymplecticInverse::usage=
    "SymplecticInverse[mat] returns the inverse of the symplectic matrix \
mat.";

SymplecticConjugate::usage=
    "SymplecticConjugate[mat] returns the symplectic conjugate of a vector or \
a square matrix of even dimension.";

SymplecticDimension::usage=
    "SymplecticDimension[mat] returns half the the dimension of a vector or a \
square matrix of even dimension.";

SymplecticTolerance::usage=
    "SymplecticTolerance is an option of SymplecticQ with default value zero.\
\nIt specifies a numerical tolerance when the matrix infinity-norm is used to \
test symplecticity of a matrix of approximate numbers.";

SymplectifyMatrix::usage="SymplectifyMatrix[mat] returns a symplectification \
of an approximately symplectic square matrix of even dimension."



Symplectic::"nonsymplectic"="Argument is not a symplectic matrix."







Begin["`Private`"]



SymplecticJ[n_Integer/;n>0]:=
  SymplecticJ[n]=
    Block[{s},s=Table[0,{2 n},{2 n}];
      s=ReplacePart[s,1,Table[{2 k-1,2 k},{k,1,n}]];
      ReplacePart[s,-1,Table[{2 k,2 k-1},{k,1,n}]]]

evenSquareMatrixQ[mat_?MatrixQ]:=(SameQ@@#1&&EvenQ[First[#1]]&)[
    Dimensions[mat]]



evenVectorQ[vec_?VectorQ]:=(EvenQ[First[#]]&&Length[#]\[Equal]1)&@
    Dimensions[vec]











\!\(SymplecticDimension[mat_?evenSquareMatrixQ] := 
    1\/2\ First[Dimensions[mat]]\)

\!\(SymplecticDimension[vec_?evenVectorQ] := 1\/2\ First[Dimensions[vec]]\)

Options[SymplecticQ]={SymplecticTolerance\[Rule]0};

SymplecticQ[mat_?evenSquareMatrixQ,opts___]:=
  Module[{j=SymplecticJ[SymplecticDimension[mat]]},
    If[Min[Precision/@Flatten[mat]]<\[Infinity],
      MatrixNorm[
          Transpose[mat].j.mat-
            j]\[LessEqual](SymplecticTolerance/.\[InvisibleSpace]{opts}\
/.\[InvisibleSpace]Options[SymplecticQ]),Simplify[Transpose[mat].j.mat==j]]]

SymplecticQ[mat_?MatrixQ,opts___]:=False

SymplecticConjugate[mat_?evenSquareMatrixQ]:=
  Module[{j=SymplecticJ[SymplecticDimension[mat]]},-j.Transpose[mat].j]

SymplecticConjugate[v_?evenVectorQ]:=
  Module[{j=SymplecticJ[SymplecticDimension[v]]},v.Transpose[j]]







SymplecticInverse[mat_?SymplecticQ]:=SymplecticConjugate[mat]

SymplecticInverse[mat_?MatrixQ]:=(Message[Symplectic::nonsymplectic];
    HoldForm[SymplecticInverse[mat]])



SymplectifyMatrix[mat_?evenSquareMatrixQ]:=
  Module[{v,vs,dim=SymplecticDimension[mat],Idim},
    Idim=IdentityMatrix[2 dim];
    v=(Idim-mat).Inverse[Idim+mat];
    vs=(SymplecticConjugate[v]-v)/2;
    (vs+Idim).Inverse[Idim-vs]
    ]



End[ ]













EndPackage[]

If[$Remote,(Print["Remote kernel: SymplecticPalette.nb will not be opened"];
    Null),NotebookOpen[
    ToFileName[packageSourceDirectory["Symplectic"],"SymplecticPalette.nb"]]]































































































































































































































































































































































































