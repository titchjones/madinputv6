(***********************************************************************

                    Mathematica-Compatible Notebook

This notebook can be used on any computer system with Mathematica 4.0,
MathReader 4.0, or any compatible application. The data for the notebook 
starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do one of 
the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing the 
word CacheID, otherwise Mathematica-compatible applications may try to 
use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
***********************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[    112009,       3063]*)
(*NotebookOutlinePosition[    134291,       3870]*)
(*  CellTagsIndexPosition[    134104,       3861]*)
(*WindowFrame->Normal*)



Notebook[{

Cell[CellGroupData[{
Cell["MatrixTable Package DRAFT", "Title"],

Cell[TextData[ButtonBox["John M. Jowett",
  ButtonData:>{
    URL[ "http://wwwslap.cern.ch/~jowett/"], None},
  ButtonStyle->"Hyperlink"]], "Subsubtitle"],

Cell[CellGroupData[{

Cell["Introduction", "Section"],

Cell[TextData[{
  "This note is the documentation for a ",
  StyleBox["Mathematica",
    FontSlant->"Italic"],
  " package designed to handle data from a type of files generated by ",
  ButtonBox["MAD",
    ButtonData:>{
      URL[ "http://wwwslap.cern.ch/~fci/mad/mad.html"], None},
    ButtonStyle->"Hyperlink"],
  "  (only MAD Version 9) and initially transformed into basic mfs objects. \
The transformation function as well as the supplementary ones are \
intentionally kept similar to the functions in the TrackTable package for \
user's convenience as their operation is almost identical."
}], "Text"],

Cell[TextData[{
  "These packages and others are available in the context ",
  StyleBox["Madtomma", "Input"],
  "  (the word ",
  StyleBox["context",
    FontSlant->"Italic"],
  " is used in a special sense in ",
  StyleBox["Mathematica).",
    FontSlant->"Italic"]
}], "Text"],

Cell[TextData[{
  "This notebook adheres to the conventions for ",
  StyleBox["Mathematica",
    FontSlant->"Italic"],
  " package structure and documentation set out in Maeder, R. ",
  StyleBox["Programming in Mathematica",
    FontSlant->"Italic"],
  ", 3rd ed. Addison-Wesley, 1996.  As such it serves as the development \
medium for the package itself (the code is hidden in printed versions) as \
well as documentation and examples.   It is available on-line at"
}], "Text"],

Cell[TextData[ButtonBox["http://wwwslap.cern.ch/jowett/Madtomma",
  ButtonData:>{
    URL[ "http://wwwslap.cern.ch/jowett/Madtomma"], None},
  ButtonStyle->"Hyperlink"]], "Program"],

Cell[TextData[{
  "This notebook is based on the model by R. Maeder supplied with ",
  StyleBox["Mathematica",
    FontSlant->"Italic"],
  " 3.0."
}], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reference", "Section"],

Cell[CellGroupData[{

Cell["Title", "Subsubsection"],

Cell[TextData[{
  "MatrixTable",
  StyleBox[" Package",
    FontSlant->"Italic"]
}], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Authors", "Subsubsection"],

Cell["John M. Jowett", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Summary", "Subsubsection"],

Cell["\<\
This notebook is analogous to the EigenTable one and provides \
functions for data transfromation and manipulation for the MATRIX type files \
generated by MAD Version 9.\
\>", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Copyright", "Subsubsection"],

Cell[TextData[{
  "\[Copyright] Copyright ",
  StyleBox["CERN.1997",
    FontSlant->"Italic"],
  "\n\n",
  "The copyright and all other rights relating to this computer software, in \
whatever form, including but not\nlimited to the source code, the object code \
and user documentation, are vested in CERN. \n\nCERN, on a royalty-free and \
non-exclusive basis, hereby grants permission to use, copy, change, modify,\n\
translate, display, distribute and make available this computer software, \
subject to the following conditions:\n\n(1) this computer software is \
provided on an as-is basis and CERN provides no express or implied\n\
warranties of any kind, including but not limited to those of \
merchantability, fitness for a particular purpose\nand non-infringement of \
the proprietary rights, such as copyrights, patents and trade secrets, of \
third\nparties. CERN accepts no liability whatsoever for or in connection \
with the use of this computer software; \n\n(2) all copies made of this \
computer software or of parts thereof shall include this copyright statement \
in\nfull; \n\n(3) however, if this computer software or parts thereof are \
made available in any other form than their\noriginal form, or are included \
in any other computer software, the following short acknowledgement only\n\
must be mentioned in the copyright statement and in the user documentation \
(or, in the absence thereof, in\nany other appropriate place) concerning the \
computer software thus made available or created: \n\n\"This product includes \
computer software created and made available by CERN. This acknowledgement\n\
shall be mentioned in full in any product which includes the CERN computer \
software included herein or\nparts thereof.\" "
}], "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["Notebook Version", "Subsubsection"],

Cell["1.0", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
  StyleBox["Mathematica",
    FontSlant->"Italic"],
  " Version"
}], "Subsubsection"],

Cell["3.0 or later", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["History", "Subsubsection"],

Cell["Created by modifying EigenTable.nb, 20 March 2000.", "Text",
  CellTags->"Reference section"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Keywords", "Subsubsection"],

Cell["\<\
MATRIX, RMATRIX, MAD, data, table, OPTICS, eigenvectors, mfs, TFS\
\
\>", "Text"]
}, Open  ]],

Cell["Source", "Subsubsection"],

Cell[CellGroupData[{

Cell["Warnings", "Subsubsection"],

Cell[TextData[{
  "Note: all cells marked as \"InitializationCell\" will be written to the \
Auto-Save package. This package can then be read in programs that use it with \
",
  StyleBox["Needs[\"Template`\"]", "Input"],
  ". Cells not intended to belong to the package should not have this \
property."
}], "Text"]
}, Open  ]],

Cell["Limitation", "Subsubsection"],

Cell[CellGroupData[{

Cell["Discussion", "Subsubsection"],

Cell["\<\
Here we provide the internal specification of MatrixTable data \
objects.  Normal users may skip it.\
\>", "Text"],

Cell["\<\
The MatrixTable data objects consists of three parts. The first one \
is a copy of a transformed mfs data object. The last contains the actual data \
in forms of lists of objects - strings, numbers, vectors or matrices. Each \
element of the list stores the data corresponding to a certain element of the \
storage ring. The second-last part is a list of names of data stored in the \
last part. \
\>", "Text"]
}, Open  ]],

Cell["Requirements", "Subsubsection"]
}, Closed]],

Cell[CellGroupData[{

Cell["Setup", "Section"],

Cell["\<\
This section contains commands needed to load the corresponding \
package file.  The contents of this file are equivalent to the following \
sections (Interface, Implementation, Epilog) in which the package is \
developed. \
\>", "Text",
  CellTags->"Setup section"],

Cell[CellGroupData[{

Cell["Search Path (ESSENTIAL!)", "Subsection",
  CellTags->"Setup section"],

Cell["\<\
To have access to my packages, you may need to add my packages \
directory to your search path.  This is system-dependent and the latest \
information about arranging it on CERN computer systems can be found at\
\>", \
"Text"],

Cell[TextData[ButtonBox["http://wwwslap.cern.ch/~jowett/Madtomma/AboutFiles.\
html",
  ButtonData:>{
    URL[ "http://wwwslap.cern.ch/~jowett/Madtomma/AboutFiles.html"], None},
  ButtonStyle->"Hyperlink"]], "Program"],

Cell[TextData[{
  "and is not reproduced here.  I strongly recommend that you modify your \
kernel initialisation file once and for all as explained on this page.  Then \
all my packages will be found as easily as the Standard Packages that come \
with ",
  StyleBox["Mathematica",
    FontSlant->"Italic"],
  "."
}], "Text",
  CellTags->"Setup section"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loading the Package", "Subsection",
  CellTags->"Setup section"],

Cell[TextData[{
  "Once the package directory is on your search path, the ",
  StyleBox["Mfs", "Input"],
  " package can be loaded by evaluating the following cell. ",
  StyleBox["If you are using a copy of this notebook in order to work through \
the examples and you are invited to  evaluate all the initialisation cells in \
it, you should click \"NO\" and then go straight to the ",
    FontSlant->"Italic",
    FontColor->RGBColor[1, 0, 0]],
  StyleBox["\"",
    FontSlant->"Italic"],
  StyleBox[ButtonBox["User's Guide and Examples",
    ButtonData:>"Examples section",
    ButtonStyle->"Hyperlink"],
    FontSlant->"Italic"],
  StyleBox["\" ",
    FontSlant->"Italic"],
  StyleBox["without evaluating the intermediate sections.",
    FontSlant->"Italic",
    FontColor->RGBColor[1, 0, 0]]
}], "Text",
  CellTags->"Setup section"],

Cell[BoxData[
    RowBox[{
    "Needs", "[", "\"\<Madtomma`Mfs`MatrixTable`\>\"", "]"}]], "InputOnly"],

Cell[TextData[{
  "This is all you need to start using the package in your own applications.  \
 In interactive sessions, you will normally see a palette of buttons \
appearing on your screen.   This makes it easier to use the package: see ",
  ButtonBox["Section ",
    ButtonData:>"palette",
    ButtonStyle->"Hyperlink"],
  
  CounterBox["Section", "palette"],
  " below."
}], "Text",
  CellTags->"Setup section"],

Cell[TextData[{
  "These following sections are hidden when this notebook is used as the \
package documentation but may be inspected in the online copy that can be \
found in the appropriate  sub-directory of the directory added to the ",
  StyleBox["$Path", "Input"],
  " variable above."
}], "Text",
  CellTags->"Setup section"],

Cell[BoxData[
    RowBox[{"Remove", "[", "sJ3", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
    "Needs", "[", "\"\<Madtomma`Algebra`Symplectic`\>\"", "]"}]], "Input"],

Cell[BoxData[
    InterpretationBox[
      RowBox[{"NotebookObject", "[", 
        RowBox[{
        "\[LeftSkeleton]", "\<\"SymplecticPalette.nb\"\>", 
          "\[RightSkeleton]"}], "]"}],
      NotebookObject[ 
        FrontEndObject[ 
          LinkObject[ "gqq", 1, 1]], 34]]], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interface", "Section",
  InitializationCell->True],

Cell["\<\
This part declares the publicly visible functions, options, and \
values.\
\>", "Text",
  InitializationCell->True],

Cell[CellGroupData[{

Cell["Set up the package context, including public imports", "Subsection",
  InitializationCell->True],

Cell["\<\
BeginPackage[\"Madtomma`Mfs`MatrixTable`\",
\t{\"Madtomma`Mfs`Mfs`\",
\t\"Madtomma`Algebra`Symplectic\"}]\
\>", "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Usage messages for the exported functions and the context \
itself\
\>", "Subsection",
  InitializationCell->True],

Cell["\<\
MatrixTable::usage = \"MatrixTable.m is a package for working with \
MATRIX tables of transfer matrices saved by MAD (Version 9).\";\
\>", "Input",\

  InitializationCell->True],

Cell["\<\
makeMatrixTable::usage = \"makeMatrixTable[mfsdata] transforms an \
mfs data object created from a MAD Version 9 MATRIX table into a MatrixTable \
data object.\";\
\>", "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Error messages for the exported objects", "Subsection",
  InitializationCell->True],

Cell["makeMatrixTable::badarg = \"Wrong input mfs object.\";", "Input",
  InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation", "Section",
  InitializationCell->True],

Cell["\<\
This part contains the actual definitions and any auxiliary \
functions that should not be visible outside.\
\>", "Text"],

Cell[CellGroupData[{

Cell["Begin the private context (implementation part)", "Subsection",
  InitializationCell->True],

Cell["Begin[\"`Private`\"]", "Input",
  InitializationCell->True]
}, Open  ]],

Cell["Read in any hidden imports", "Subsection",
  InitializationCell->True],

Cell[CellGroupData[{

Cell["\<\
Unprotect any system functions for which definitions will be made\
\
\>", "Subsection",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"protected", " ", "=", 
        RowBox[{"Unprotect", "[", 
          RowBox[{
          "mfsTypes", ",", "mfsKeyValue", ",", "mfsKeyNames", ",", 
            "mfsColumnNames", ",", "mfsInterpretKeys", ",", "mfsAddKey", ",", 
            "mfsDeleteKey", ",", "mfsEditKey", ",", "mfsColumn"}], "]"}]}], 
      ";"}]], "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Definition of auxiliary functions and local (static) \
variables\
\>", "Subsection",
  InitializationCell->True],

Cell["For MAD8, the orbit columns were named as", "Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{"orbtemplate", " ", "=", " ", 
        RowBox[{"{", 
          RowBox[{
          "\"\<XCO\>\"", ",", "\"\<PXCO\>\"", ",", "\"\<YCO\>\"", ",", 
            "\"\<PYCO\>\"", ",", "\"\<TCO\>\"", ",", "\"\<PTCO\>\""}], 
          "}"}]}], ";"}]], "Input",
  Evaluatable->False],

Cell[TextData[{
  "Changed for MAD9, 29/9/1999.  But see the ",
  StyleBox["StringReplace", "Input"],
  " in ",
  StyleBox["make", "Input"],
  "MatrixTable",
  " that converts any old MAD8 tables to the new names. "
}], "Text"],

Cell[BoxData[
    \(\(orbtemplate\  = 
      \ {"\<XC\>", "\<PXC\>", "\<YC\>", "\<PYC\>", "\<TC\>", "\<PTC\>"}; 
    \)\)], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"mattemplate", "=", 
        RowBox[{"Table", "[", 
          RowBox[{
            RowBox[{"\"\<R\>\"", " ", "<>", " ", 
              RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", 
              RowBox[{"ToString", "[", "j", "]"}]}], "  ", ",", 
            RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "6"}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
      ";"}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"orbpos", "[", "qpmfs_mfs", "]"}], ":=", 
        RowBox[{"Flatten", "[", 
          RowBox[{
            RowBox[{
              RowBox[{"(", 
                RowBox[{"Position", "[", 
                  RowBox[{
                    RowBox[{"mfsColumnNames", "[", 
                      RowBox[{"(", 
                        RowBox[{
                          RowBox[{"(", 
                            RowBox[{
                              RowBox[{"StringReplace", "[", 
                                RowBox[{"#", ",", 
                                  RowBox[{"{", 
                                    RowBox[{
                                    "\"\<CO\>\"", "\[Rule]", "\"\<C\>\""}], 
                                    "}"}]}], "]"}], "&"}], ")"}], "/@", 
                          "qpmfs"}], ")"}], "]"}], ",", "#"}], "]"}], ")"}], 
              "&"}], "/@", "orbtemplate"}], "]"}]}], ";"}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"eigpos", "[", "qpmfs_mfs", "]"}], ":=", 
        RowBox[{"Flatten", "[", 
          RowBox[{
            RowBox[{
              RowBox[{"(", 
                RowBox[{"Position", "[", 
                  RowBox[{
                    RowBox[{"mfsColumnNames", "[", "qpmfs", "]"}], ",", "#"}],
                   "]"}], ")"}], "&"}], "/@", " ", 
            RowBox[{"Flatten", "[", "mattemplate", "]"}]}], "]"}]}], 
      ";"}]], "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition of the exported functions", "Subsection",
  InitializationCell->True],

Cell[CellGroupData[{

Cell[TextData[{
  StyleBox["Function make", "Input"],
  "MatrixTable"
}], "Subsubsection",
  InitializationCell->True],

Cell["\<\
Why make the head of this anything other than mfs?  Did I have a \
reason?\
\>", "Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"makeMatrixTable", "[", "qpmfs_mfs", "]"}], ":=", 
        RowBox[{"Module", "[", 
          RowBox[{
            RowBox[{"{", "}"}], ",", "\n", "\t\t", 
            RowBox[{"If", "[", 
              RowBox[{
                RowBox[{
                  RowBox[{"mfsKeyValue", "[", 
                    RowBox[{"qpmfs", ",", "\"\<TYPE\>\""}], "]"}], "==", 
                  "\"\<MATRIX\>\""}], ",", "\n", "\t\t\t", 
                RowBox[{"(", "\n", "\t\t\t\t", 
                  RowBox[{"MatrixTable", "[", "\n", "\t\t\t\t\t\t", 
                    RowBox[{
                      RowBox[{"First", "[", "qpmfs", "]"}], ",", "\n", 
                      "\t\t\t\t\t", 
                      RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t", 
                        RowBox[{
                          RowBox[{"Select", "[", 
                            RowBox[{
                              RowBox[{"(", 
                                RowBox[{
                                  RowBox[{"(", 
                                    RowBox[{
                                      RowBox[{"StringReplace", "[", 
                                        RowBox[{"#", ",", 
                                        RowBox[{"{", 
                                        RowBox[{
                                        "\"\<CO\>\"", "\[Rule]", 
                                        "\"\<C\>\""}], "}"}]}], "]"}], "&"}], 
                                    ")"}], "/@", 
                                  RowBox[{
                                  "qpmfs", "\[LeftDoubleBracket]", "2", 
                                    "\[RightDoubleBracket]"}]}], ")"}], ",", 
                              "\n", "\t\t\t\t\t\t\t", 
                              RowBox[{
                                RowBox[{"Not", "[", 
                                  RowBox[{"MemberQ", "[", 
                                    RowBox[{
                                      RowBox[{"Flatten", "[", 
                                        RowBox[{
                                        "mattemplate", "\[Union]", " ", 
                                        "orbtemplate"}], "]"}], ",", "#"}], 
                                    "]"}], "]"}], "&"}]}], "\n", 
                            "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                          "\t\t\t\t\t\t", 
                          RowBox[{"{", 
                            RowBox[{"\"\<ORBIT\>\"", ",", "\"\<RMATRIX\>\""}],
                             "}"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", 
                      "\t\t\t\t\t", 
                      RowBox[{
                        RowBox[{"(", 
                          RowBox[{
                            RowBox[{"{", "\n", "\t\t\t\t\t", 
                              RowBox[{
                                RowBox[{
                                "#", "\[LeftDoubleBracket]", "1", 
                                  "\[RightDoubleBracket]"}], ",", "\n", 
                                "\t\t\t\t\t\t", 
                                RowBox[{
                                "#", "\[LeftDoubleBracket]", "2", 
                                  "\[RightDoubleBracket]"}], ",", "\n", 
                                "\t\t\t\t\t\t", 
                                RowBox[{"#", "\[LeftDoubleBracket]", 
                                  RowBox[{"orbpos", "[", "qpmfs", "]"}], 
                                  "\[RightDoubleBracket]"}], ",", "\n", 
                                "\t\t\t\t\t\t", 
                                RowBox[{"Partition", "[", 
                                  RowBox[{
                                    RowBox[{"#", "\[LeftDoubleBracket]", 
                                      RowBox[{"eigpos", "[", "qpmfs", "]"}], 
                                      "\[RightDoubleBracket]"}], ",", "6"}], 
                                  "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "}"}], 
                            "&"}], ")"}], "/@", 
                        RowBox[{"Last", "[", "qpmfs", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t", "]"}], "\n", "\t\t\t\t", ")"}], ",", "\n",
                 "\t\t\t", 
                RowBox[{"(", 
                  RowBox[{
                    RowBox[{"Message", "[", 
                      RowBox[{"makeMatrixTable", "::", "badarg"}], "]"}], ";",
                     "Null"}], ")"}]}], "\n", "\t\t", "]"}]}], "\n", "\t\t", 
          "]"}]}], ";"}]], "Input",
  InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Additional definitions for  functions in the basic mfs package\
\>",
   "Subsection",
  InitializationCell->True],

Cell["\<\
The MatrixTable data structure has logical features in common with \
the basic mfs data type.  In many cases the internal structure is also \
similar.  This allows us to implement some functions on MatrixTable objects \
using the code developed for mfs objects and simply replacing the Head of the \
object by mfs.  These functions are unprotected and then re-protected in this \
package.
This section is analogous to one of the sections of the TrackTable package.\
\
\>", "Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{"mfsTypes", "=", 
        RowBox[{"Union", "[", 
          RowBox[{"mfsTypes", ",", 
            RowBox[{"{", "MatrixTable", "}"}]}], "]"}]}], ";"}]], "Input",
  InitializationCell->True],

Cell["\<\
It is worth noting that mfsKeyValue works on lists (and lists of \
lists) of keys.\
\>", "Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{"mfsKeyValue", "[", 
        RowBox[{"qp_MatrixTable", ",", "keyss_"}], "]"}], ":=", 
      RowBox[{"mfsKeyValue", "[", 
        RowBox[{
          RowBox[{"mfs", " ", "@@", " ", "qp"}], ",", "keyss"}], 
        "]"}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"mfsKeyNames", "[", "qp_MatrixTable", "]"}], ":=", 
      RowBox[{"mfsKeyNames", "[", 
        RowBox[{"mfs", " ", "@@", " ", "qp"}], "]"}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"mfsColumnNames", "[", "qp_MatrixTable", "]"}], ":=", 
      RowBox[{"mfsColumnNames", "[", 
        RowBox[{"mfs", "@@", "qp"}], "]"}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"mfsInterpretKeys", "[", "qp_MatrixTable", "]"}], ":=", 
      RowBox[{"mfsInterpretKeys", "[", 
        RowBox[{"mfs", " ", "@@", " ", "qp"}], "]"}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"mfsAddKey", "[", 
        RowBox[{"qp_MatrixTable", ",", 
          RowBox[{"{", 
            RowBox[{"key_String", ",", "value_"}], "}"}]}], "]"}], ":=", "\n",
       "\t", 
      RowBox[{"mfsAddKey", "[", 
        RowBox[{
          RowBox[{"mfs", " ", "@@", " ", "qp"}], ",", 
          RowBox[{"{", 
            RowBox[{"key", ",", "value"}], "}"}]}], "]"}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"mfsDeleteKey", "[", 
        RowBox[{"qp_MatrixTable", ",", "key_String"}], "]"}], ":=", 
      RowBox[{"mfsDeleteKey", "[", 
        RowBox[{
          RowBox[{"mfs", "@@", "qp"}], ",", "key"}], "]"}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"mfsEditKey", "[", 
        RowBox[{"qp_MatrixTable", ",", 
          RowBox[{"{", 
            RowBox[{"key_String", ",", "newValue_"}], "}"}]}], "]"}], ":=", 
      RowBox[{"mfsEditKey", "[", 
        RowBox[{
          RowBox[{"mfs", "@@", "qp"}], ",", 
          RowBox[{"{", 
            RowBox[{"key", ",", "newValue"}], "}"}]}], "]"}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"mfsColumn", "[", 
        RowBox[{"qp_MatrixTable", ",", "key_String"}], "]"}], ":=", 
      RowBox[{"Flatten", "[", 
        RowBox[{
          RowBox[{
            RowBox[{
              RowBox[{"(", 
                RowBox[{"#", "[", 
                  RowBox[{"[", 
                    RowBox[{"Flatten", "[", 
                      RowBox[{"Position", "[", 
                        RowBox[{
                          RowBox[{"mfsColumnNames", "[", "qp", "]"}], ",", 
                          "key"}], "]"}], "]"}], "]"}], "]"}], ")"}], "&"}], 
            " ", "/@", 
            RowBox[{"Last", "[", "qp", "]"}]}], ",", "1"}], "]"}]}]], "Input",\

  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"mfsColumn", "[", 
        RowBox[{"qp_MatrixTable", ",", "keys_List"}], "]"}], ":=", " ", 
      RowBox[{
        RowBox[{
          RowBox[{"mfsColumn", "[", 
            RowBox[{"qp", ",", "#"}], "]"}], "&"}], " ", "/@", " ", 
        "keys"}]}]], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{
      RowBox[{"mfsColumn", "[", "qp_MatrixTable", "]"}], ":=", 
      RowBox[{"Last", "[", "qp", "]"}]}]], "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["Restore protection of system symbols", "Subsection",
  InitializationCell->True],

Cell["Protect[ Evaluate[protected] ];", "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["End the private context", "Subsection",
  InitializationCell->True],

Cell["End[ ]", "Input",
  InitializationCell->True],

Cell[BoxData["\"\<Madtomma`Mfs`MatrixTable`Private`\>\""], "Input"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Epilog", "Section",
  InitializationCell->True],

Cell["This section protects exported symbols and ends the package.", "Text"],

Cell[CellGroupData[{

Cell["Protect exported symbol", "Subsection",
  InitializationCell->True],

Cell["Protect[makeMatrixTable]", "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{"{", "\"\<makeMatrixTable\>\"", "}"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["End the package context", "Subsection",
  InitializationCell->True],

Cell["EndPackage[ ]", "Input",
  InitializationCell->True]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Basic documentation", "Section"],

Cell["\<\
A quick way to document this small package is to list the names of \
the functions it exports [1]:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
    "Names", "[", "\"\<Madtomma`Mfs`MatrixTable`*\>\"", "]"}]], "Input",
  CellTags->"Setup section"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{"\<\"makeMatrixTable\"\>", ",", "\<\"MatrixTable\"\>"}], 
      "}"}]], "Output"]
}, Open  ]],

Cell["\<\
and then print their usage messages that say what they do.  \
Normally these messages are accessible by typing, e.g., \
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"?", "makeMatrixTable"}]], "Input"],

Cell[BoxData["\<\"makeMatrixTable[mfsdata] transforms an mfs data object \
created from a MAD Version 9 MATRIX table into a MatrixTable data \
object.\"\>"], "Print"]
}, Open  ]],

Cell["\<\
but the following utility function generates the same information \
in formatted form (the following subsections!).\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"UsageNotebook", "[", 
      RowBox[{"Names", "[", "\"\<Madtomma`Mfs`Mfs`*\>\"", "]"}], 
      "]"}]], "Input"],

Cell[BoxData[
    RowBox[{
      RowBox[{"Message", "::", "\<\"name\"\>"}], 
      RowBox[{
      ":", " "}], "\<\"Message name \\!\\(\\(\\({MatrixTable, mfs}\\)\\) :: \
\\\"usage\\\"\\) is not of the form symbol::name or symbol::name::language.\"\
\>"}]], "Message"],

Cell[BoxData[
    RowBox[{
      RowBox[{"Message", "::", "\<\"name\"\>"}], 
      RowBox[{
      ":", " "}], "\<\"Message name \
\\!\\(\\(\\({\\(\\(\\\"interpretDescriptors\\\" \[Rule] \
\\\"mfsInterpretKeys\\\"\\)\\), \\(\\(\[LeftSkeleton] 7 \
\[RightSkeleton]\\)\\), \\(\\(\\\"symplecticJ\\\" \[Rule] \\\"SymplecticJ\\\"\
\\)\\)}\\)\\) :: \\\"usage\\\"\\) is not of the form symbol::name or \
symbol::name::language.\"\>"}]], "Message"],

Cell[BoxData[
    InterpretationBox[
      RowBox[{"NotebookObject", "[", 
        RowBox[{"\[LeftSkeleton]", "\<\"Untitled-4\"\>", "\[RightSkeleton]"}],
         "]"}],
      NotebookObject[ 
        FrontEndObject[ 
          LinkObject[ "gqq", 1, 1]], 32]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples, Tests", "Section"],

Cell["For these examples is useful to load the packages", "Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{
      "Needs", "[", "\"\<LinearAlgebra`MatrixManipulation`\>\"", "]"}], 
      ";"}]], "Input",
  CellTags->"S5.52.1"],

Cell[BoxData[
    RowBox[{
      RowBox[{"Needs", "[", "\"\<Madtomma`Mfs`TrackTable`\>\"", "]"}], 
      ";"}]], "Input",
  CellTags->"S5.52.1"],

Cell[TextData[{
  "Having read in the ",
  StyleBox["MatrixTable", "Input"],
  " package you can handle data in types specified by ",
  StyleBox["mfsTypes", "Input"],
  " command - basic ",
  StyleBox["mfs", "Input"],
  " and ",
  StyleBox["MatrixTable", "Input"],
  " data objects."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData["mfsTypes"], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{"MatrixTable", ",", "mfs"}], "}"}]], "Output"]
}, Open  ]],

Cell["\<\
First, let us define a sample data file.  This one was created by \
MAD Version 9 using the MATRIX command to save the table  This is actually \
the internal representation of a Twiss table in MAD Version 9.  This is a \
small example but larger ones can just as well be handled.\
\>", "Text",
  CellTags->"Examples section"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"sampleFile", "=", 
      RowBox[{"ToFileName", "[", 
        RowBox[{
          RowBox[{"{", 
            RowBox[{
              RowBox[{"AfsHomeDirectory", "[", "\"\<jowett\>\"", "]"}], ",", 
              "\"\<public\>\"", ",", "\"\<math\>\"", ",", "\"\<Madtomma\>\"", 
              ",", "\"\<Mfs\>\"", ",", "\"\<Examples\>\""}], "}"}], ",", 
          "\"\<rmatrix.tfs\>\""}], "]"}]}]], "Input",
  CellTags->"Examples section"],

Cell[BoxData["\<\"P:\\\\cern.ch\\\\user\\\\j\\\\jowett\\\\public\\\\math\\\\\
Madtomma\\\\Mfs\\\\Examples\\\\rmatrix.tfs\"\>"], "Output"]
}, Open  ]],

Cell["Choose some directory of your own for the examples", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"SetDirectory", "[", "\"\<C:\\\\temp\>\"", "]"}]], "Input"],

Cell[BoxData["\<\"C:\\\\temp\"\>"], "Output"]
}, Open  ]],

Cell["\<\
Create an MatrixTable data object from a corresponding mfs \
object.\
\>", "Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{"mt", "=", 
        RowBox[{"makeMatrixTable", "[", 
          RowBox[{"tfsRead", "[", 
            RowBox[{"sampleFile", ",", 
              RowBox[{"Verbose", "\[Rule]", "False"}]}], "]"}], "]"}]}], 
      ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"ByteCount", "[", "mt", "]"}]], "Input"],

Cell[BoxData["6744"], "Output"]
}, Open  ]],

Cell["\<\
Inspect the first part of the created data object by listing \
descriptors' names.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"mfsKeyNames", "[", "mt", "]"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{"\<\"TYPE\"\>", ",", "\<\"NAME\"\>", ",", "\<\"DATE\"\>", 
        ",", "\<\"TIME\"\>", ",", "\<\"ORIGIN\"\>", ",", "\<\"COMMENT\"\>", 
        ",", "\<\"LINE\"\>", ",", "\<\"BEAM\"\>", ",", "\<\"PARTICLE\"\>", 
        ",", "\<\"CHARGE\"\>", ",", "\<\"MASS\"\>", ",", "\<\"MOMENTUM\"\>", 
        ",", "\<\"LENGTH\"\>", ",", "\<\"MU1\"\>", ",", "\<\"MU2\"\>", 
        ",", "\<\"MU3\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell["You can obtain their values.", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"mfsKeyValue", "[", 
      RowBox[{"mt", ",", 
        RowBox[{"{", 
          RowBox[{"\"\<ORIGIN\>\"", ",", "\"\<MOMENTUM\>\""}], "}"}]}], 
      "]"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{"\<\"MAD_9.3\"\>", ",", "45000.`"}], "}"}]], "Output"]
}, Open  ]],

Cell["\<\
You can add new descriptors as well as delete or edit the existing \
ones.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"First", "[", 
      RowBox[{"mt", "=", 
        RowBox[{"mfsAddKey", "[", 
          RowBox[{"mt", ",", 
            RowBox[{"{", 
              RowBox[{
              "\"\<REMARK\>\"", ",", 
                "\"\<Matrices are cumulative, always from beginning of \
line.\>\""}], "}"}]}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        RowBox[{"{", 
          RowBox[{"\<\"TYPE\"\>", ",", "\<\"MATRIX\"\>"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"NAME\"\>", ",", "\<\"RBENDLINEAR\"\>"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"DATE\"\>", ",", "\<\"20/03/2000\"\>"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"TIME\"\>", ",", "\<\"11.49.01\"\>"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"ORIGIN\"\>", ",", "\<\"MAD_9.3\"\>"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"COMMENT\"\>", ",", "\<\"\"\>"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"LINE\"\>", ",", "\<\"LRB1\"\>"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"BEAM\"\>", ",", "\<\"BEAM1\"\>"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"PARTICLE\"\>", ",", "\<\"PROTON\"\>"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"CHARGE\"\>", ",", "1.`"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"MASS\"\>", ",", "0.93827231`"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"MOMENTUM\"\>", ",", "45000.`"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"LENGTH\"\>", ",", "13.`"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"MU1\"\>", ",", "0.237572098915`"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"MU2\"\>", ",", "0.238531062034`"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"MU3\"\>", ",", "0.965031562407`"}], "}"}], ",", 
        RowBox[{"{", 
          
          RowBox[{"\<\"REMARK\"\>", 
            ",", "\<\"Matrices are cumulative, always from beginning of line.\
\"\>"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{"First", "[", "mt", "]"}], "//", "TableForm"}]], "Input"],

Cell[BoxData[
    TagBox[GridBox[{
          {"\<\"TYPE\"\>", "\<\"MATRIX\"\>"},
          {"\<\"NAME\"\>", "\<\"RBENDLINEAR\"\>"},
          {"\<\"DATE\"\>", "\<\"20/03/2000\"\>"},
          {"\<\"TIME\"\>", "\<\"11.49.01\"\>"},
          {"\<\"ORIGIN\"\>", "\<\"MAD_9.3\"\>"},
          {"\<\"COMMENT\"\>", "\<\"\"\>"},
          {"\<\"LINE\"\>", "\<\"LRB1\"\>"},
          {"\<\"BEAM\"\>", "\<\"BEAM1\"\>"},
          {"\<\"PARTICLE\"\>", "\<\"PROTON\"\>"},
          {"\<\"CHARGE\"\>", "1.`"},
          {"\<\"MASS\"\>", "0.93827231`"},
          {"\<\"MOMENTUM\"\>", "45000.`"},
          {"\<\"LENGTH\"\>", "13.`"},
          {"\<\"MU1\"\>", "0.237572098915`"},
          {"\<\"MU2\"\>", "0.238531062034`"},
          {"\<\"MU3\"\>", "0.965031562407`"},
          {"\<\"REMARK\"\>", "\<\"Matrices are cumulative, always from \
beginning of line.\"\>"}
          },
        RowSpacings->1,
        ColumnSpacings->3,
        RowAlignments->Baseline,
        ColumnAlignments->{Left}],
      (TableForm[ #]&)]], "Output"]
}, Open  ]],

Cell[TextData[{
  "You can create symbols for the descriptors using function ",
  StyleBox["mfsInterpretKeys", "Input"],
  "."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"mfsInterpretKeys", "[", "mt", "]"}]], "Input"],

Cell[BoxData[
    RowBox[{
      RowBox[{"LINE", "::", "\<\"shdw\"\>"}], 
      RowBox[{
      ":", " "}], "\<\"Symbol \\!\\(\\\"LINE\\\"\\) appears in multiple \
contexts \\!\\({\\\"Global`\\\", \\\"Geometrica`Geometrica97`\\\"}\\); \
definitions in context \\!\\(\\\"Global`\\\"\\) may shadow or be shadowed by \
other definitions.\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{"\<\"MATRIX\"\>", ",", "\<\"RBENDLINEAR\"\>", 
        ",", "\<\"20/03/2000\"\>", ",", "\<\"11.49.01\"\>", 
        ",", "\<\"MAD_9.3\"\>", ",", "\<\"\"\>", ",", "\<\"LRB1\"\>", 
        ",", "\<\"BEAM1\"\>", ",", "\<\"PROTON\"\>", ",", "1.`", ",", 
        "0.93827231`", ",", "45000.`", ",", "13.`", ",", "0.237572098915`", 
        ",", "0.238531062034`", ",", "0.965031562407`", 
        ",", "\<\"Matrices are cumulative, always from beginning of \
line.\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["TYPE"], "Input"],

Cell[BoxData["\<\"MATRIX\"\>"], "Output"]
}, Open  ]],

Cell[TextData[{
  "The ",
  StyleBox["mfsColumnNames", "Input"],
  " functions lets you know what type of data is stored in the table."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"mfsColumnNames", "[", "mt", "]"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{"\<\"NAME\"\>", ",", "\<\"S\"\>", ",", "\<\"ORBIT\"\>", 
        ",", "\<\"RMATRIX\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[TextData[{
  "Now, you can easily access the data using the ",
  StyleBox["mfsColumn", "Input"],
  " function, for example you can obtain all the element names together with \
their positions."
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{"Transpose", "[", 
        RowBox[{"mfsColumn", "[", 
          RowBox[{"mt", ",", 
            RowBox[{"{", 
              RowBox[{"\"\<NAME\>\"", ",", "\"\<S\>\""}], "}"}]}], "]"}], 
        "]"}], "//", "TableForm"}]], "Input"],

Cell[BoxData[
    TagBox[GridBox[{
          {"\<\"#S\"\>", "0.`"},
          {"\<\"RB1\"\>", "10.`"},
          {"\<\"D1\"\>", "12.`"},
          {"\<\"Q1\"\>", "13.`"},
          {"\<\"#E\"\>", "13.`"}
          },
        RowSpacings->1,
        ColumnSpacings->3,
        RowAlignments->Baseline,
        ColumnAlignments->{Left}],
      (TableForm[ #]&)]], "Output"]
}, Open  ]],

Cell["The list of elements", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"els", "=", 
      RowBox[{"mfsColumn", "[", 
        RowBox[{"mt", ",", "\"\<NAME\>\""}], "]"}]}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{"\<\"#S\"\>", ",", "\<\"RB1\"\>", ",", "\<\"D1\"\>", 
        ",", "\<\"Q1\"\>", ",", "\<\"#E\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell["and accumulated matrices", "Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{"accm", "=", 
        RowBox[{"mfsColumn", "[", 
          RowBox[{"mt", ",", "\"\<RMATRIX\>\""}], "]"}]}], ";"}]], "Input"],

Cell[TextData[{
  "If you do not specify the column name(s) the function returns the whole \
data block. Although this is rather wide for a printed page, you can see \
that, for each element, it contains the name, azimuth ",
  Cell[BoxData[
      FormBox["s", TraditionalForm]]],
  ", closed orbit vector and accumulated transfer matrix from the beginning \
of the beam line.  These can be displayed with standard commands"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"mfsColumn", "[", "mt", "]"}], "/.", 
        RowBox[{
          RowBox[{"{", 
            RowBox[{"nam_", ",", "s_", ",", "co_", ",", "mat_"}], "}"}], 
          "\[Rule]", 
          RowBox[{"{", 
            RowBox[{"nam", ",", "s", ",", 
              RowBox[{"MatrixForm", "[", "mat", "]"}], ",", 
              RowBox[{"MatrixForm", "[", "co", "]"}]}], " ", "}"}]}]}], "//", 
      "TableForm"}]], "Input"],

Cell[BoxData[
    TagBox[GridBox[{
          {"\<\"#S\"\>", "0.`", 
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"1.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
                    {"0.`", "1.`", "0.`", "0.`", "0.`", "0.`"},
                    {"0.`", "0.`", "1.`", "0.`", "0.`", "0.`"},
                    {"0.`", "0.`", "0.`", "1.`", "0.`", "0.`"},
                    {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
                    {"0.`", "0.`", "0.`", "0.`", "0.`", "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)], 
            InterpretationBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0.`"},
                    {"0.`"},
                    {"0.`"},
                    {"0.`"},
                    {"0.`"},
                    {"0.`"}
                    }], "\[NoBreak]", ")"}],
              MatrixForm[ {0.0, 0.0, 0.0, 0.0, 0.0, 0.0}]]},
          {"\<\"RB1\"\>", "10.`", 
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0.999828220461`", "9.77416322248`", "0.`", "0.`", "0.`",
                       "1.477092413178`"},
                    {"0.`", "1.000171809053`", "0.`", "0.`", "0.`", 
                      "0.302322466553`"},
                    {"0.`", "0.`", "0.954839271836`", "9.999198569869`", 
                      "0.`", "0.`"},
                    {"0.`", "0.`", 
                      RowBox[{"-", "0.008862542164`"}], "0.954487009436`", 
                      "0.`", "0.`"},
                    {
                      RowBox[{"-", "0.302270533738`"}], 
                      RowBox[{"-", "1.47760198881`"}], "0.`", "0.`", "1.`", 
                      RowBox[{"-", "0.223318272473`"}]},
                    {"0.`", "0.`", "0.`", "0.`", "0.`", "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)], 
            InterpretationBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {
                      RowBox[{"-", "0.005554629262`"}]},
                    {
                      RowBox[{"-", "0.001136594307`"}]},
                    {"0.`"},
                    {"0.`"},
                    {"0.000839644881`"},
                    {"0.`"}
                    }], "\[NoBreak]", ")"}],
              
              MatrixForm[ {-.005554629262, -.001136594307, 0.0, 
                0.0, .00083964488100000002, 0.0}]]},
          {"\<\"D1\"\>", "12.`", 
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0.999828220461`", "11.774506840585`", "0.`", "0.`", 
                      "0.`", "2.081737346283`"},
                    {"0.`", "1.000171809053`", "0.`", "0.`", "0.`", 
                      "0.302322466553`"},
                    {"0.`", "0.`", "0.937114187508`", "11.90817258874`", 
                      "0.`", "0.`"},
                    {"0.`", "0.`", 
                      RowBox[{"-", "0.008862542164`"}], "0.954487009436`", 
                      "0.`", "0.`"},
                    {
                      RowBox[{"-", "0.302270533738`"}], 
                      RowBox[{"-", "1.47760198881`"}], "0.`", "0.`", "1.`", 
                      RowBox[{"-", "0.223318271604`"}]},
                    {"0.`", "0.`", "0.`", "0.`", "0.`", "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)], 
            InterpretationBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {
                      RowBox[{"-", "0.007827817876`"}]},
                    {
                      RowBox[{"-", "0.001136594307`"}]},
                    {"0.`"},
                    {"0.`"},
                    {"0.000839644881`"},
                    {"0.`"}
                    }], "\[NoBreak]", ")"}],
              
              MatrixForm[ {-.0078278178760000008, -.001136594307, 0.0, 
                0.0, .00083964488100000002, 0.0}]]},
          {"\<\"Q1\"\>", "13.`", 
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0.994833243921`", "12.714189039793`", "0.`", "0.`", 
                      "0.`", "2.373156178216`"},
                    {
                      RowBox[{"-", "0.009981626731`"}], "0.877626191278`", 
                      "0.`", "0.`", "0.`", "0.280029418293`"},
                    {"0.`", "0.`", "0.932926343934`", "12.923841702325`", 
                      "0.`", "0.`"},
                    {"0.`", "0.`", "0.000479876441`", "1.078543717527`", 
                      "0.`", "0.`"},
                    {
                      RowBox[{"-", "0.302270533738`"}], 
                      RowBox[{"-", "1.47760198881`"}], "0.`", "0.`", "1.`", 
                      RowBox[{"-", "0.223318271169`"}]},
                    {"0.`", "0.`", "0.`", "0.`", "0.`", "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)], 
            InterpretationBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {
                      RowBox[{"-", "0.008923412322`"}]},
                    {
                      RowBox[{"-", "0.00105276829`"}]},
                    {"0.`"},
                    {"0.`"},
                    {"0.000839644881`"},
                    {"0.`"}
                    }], "\[NoBreak]", ")"}],
              
              MatrixForm[ {-.0089234123219999999, -.0010527682900000001, 0.0, 
                0.0, .00083964488100000002, 0.0}]]},
          {"\<\"#E\"\>", "13.`", 
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0.994833243921`", "12.714189039793`", "0.`", "0.`", 
                      "0.`", "2.373156178216`"},
                    {
                      RowBox[{"-", "0.009981626731`"}], "0.877626191278`", 
                      "0.`", "0.`", "0.`", "0.280029418293`"},
                    {"0.`", "0.`", "0.932926343934`", "12.923841702325`", 
                      "0.`", "0.`"},
                    {"0.`", "0.`", "0.000479876441`", "1.078543717527`", 
                      "0.`", "0.`"},
                    {
                      RowBox[{"-", "0.302270533738`"}], 
                      RowBox[{"-", "1.47760198881`"}], "0.`", "0.`", "1.`", 
                      RowBox[{"-", "0.223318271169`"}]},
                    {"0.`", "0.`", "0.`", "0.`", "0.`", "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)], 
            InterpretationBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {
                      RowBox[{"-", "0.008923412322`"}]},
                    {
                      RowBox[{"-", "0.00105276829`"}]},
                    {"0.`"},
                    {"0.`"},
                    {"0.000839644881`"},
                    {"0.`"}
                    }], "\[NoBreak]", ")"}],
              
              MatrixForm[ {-.0089234123219999999, -.0010527682900000001, 0.0, 
                0.0, .00083964488100000002, 0.0}]]}
          },
        RowSpacings->1,
        ColumnSpacings->3,
        RowAlignments->Baseline,
        ColumnAlignments->{Left}],
      (TableForm[ #]&)]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"orb", "=", 
      RowBox[{"mfsColumn", "[", 
        RowBox[{"mt", ",", "\"\<ORBIT\>\""}], "]"}]}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        RowBox[{"{", 
          RowBox[{
          "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}],
           "}"}], ",", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"-", "0.005554629262`"}], ",", 
            RowBox[{"-", "0.001136594307`"}], ",", "0.`", ",", "0.`", ",", 
            "0.000839644881`", ",", "0.`"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"-", "0.007827817876`"}], ",", 
            RowBox[{"-", "0.001136594307`"}], ",", "0.`", ",", "0.`", ",", 
            "0.000839644881`", ",", "0.`"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"-", "0.008923412322`"}], ",", 
            RowBox[{"-", "0.00105276829`"}], ",", "0.`", ",", "0.`", ",", 
            "0.000839644881`", ",", "0.`"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"-", "0.008923412322`"}], ",", 
            RowBox[{"-", "0.00105276829`"}], ",", "0.`", ",", "0.`", ",", 
            "0.000839644881`", ",", "0.`"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"orb", "[", 
      RowBox[{"[", "2", "]"}], "]"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        RowBox[{"-", "0.005554629262`"}], ",", 
        RowBox[{"-", "0.001136594307`"}], ",", "0.`", ",", "0.`", ",", 
        "0.000839644881`", ",", "0.`"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{"RotateLeft", "[", "tmat", "]"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}]], "Input"],

Cell[BoxData[
    RowBox[{
      RowBox[{"RotateLeft", "::", "\<\"normal\"\>"}], 
      RowBox[{
      ":", " "}], "\<\"Nonatomic expression expected at position \\!\\(1\\) \
in \\!\\(RotateLeft[tmat]\\).\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{
      RowBox[{"Part", "::", "\<\"partw\"\>"}], 
      RowBox[{
      ":", " "}], "\<\"Part \\!\\(2\\) of \\!\\(RotateLeft[tmat]\\) does not \
exist.\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{
      RowBox[{"RotateLeft", "[", "tmat", "]"}], "\[LeftDoubleBracket]", "2", 
      "\[RightDoubleBracket]"}]], "Output"]
}, Open  ]],

Cell["Extract the transfer matrix of the second element", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"MatrixForm", "[", 
      RowBox[{"m1", "=", 
        RowBox[{
        "accm", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "]"}]], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0.999828220461`", "9.77416322248`", "0.`", "0.`", "0.`", 
              "1.477092413178`"},
            {"0.`", "1.000171809053`", "0.`", "0.`", "0.`", 
              "0.302322466553`"},
            {"0.`", "0.`", "0.954839271836`", "9.999198569869`", "0.`", 
              "0.`"},
            {"0.`", "0.`", 
              RowBox[{"-", "0.008862542164`"}], "0.954487009436`", "0.`", 
              "0.`"},
            {
              RowBox[{"-", "0.302270533738`"}], 
              RowBox[{"-", "1.47760198881`"}], "0.`", "0.`", "1.`", 
              RowBox[{"-", "0.223318272473`"}]},
            {"0.`", "0.`", "0.`", "0.`", "0.`", "1.`"}
            }], "\[NoBreak]", ")"}],
      (MatrixForm[ #]&)]], "Output"]
}, Open  ]],

Cell["Check whether it is symplectic", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{
          RowBox[{"Transpose", "[", "m1", "]"}], ".", "sJ3", ".", "m1"}], "//",
         "Chop"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{
        RowBox[{"{", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{"0.999828220461`", ",", "0", ",", "0", ",", "0", ",", 
                RowBox[{"-", "0.302270533738`"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{
              "9.77416322248`", ",", "1.000171809053`", ",", "0", ",", "0", 
                ",", 
                RowBox[{"-", "1.47760198881`"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0.954839271836`", ",", 
                RowBox[{"-", "0.008862542164`"}], ",", "0", ",", "0"}], "}"}],
             ",", 
            RowBox[{"{", 
              RowBox[{
              "0", ",", "0", ",", "9.999198569869`", ",", "0.954487009436`", 
                ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{
              "0", ",", "0", ",", "0", ",", "0", ",", "1.`", ",", "0"}], 
              "}"}], ",", 
            RowBox[{"{", 
              RowBox[{
              "1.477092413178`", ",", "0.302322466553`", ",", "0", ",", "0", 
                ",", 
                RowBox[{"-", "0.223318272473`"}], ",", "1.`"}], "}"}]}], 
          "}"}], ".", "sJ3", ".", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{
              "0.999828220461`", ",", "9.77416322248`", ",", "0", ",", "0", 
                ",", "0", ",", "1.477092413178`"}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{
              "0", ",", "1.000171809053`", ",", "0", ",", "0", ",", "0", ",", 
                "0.302322466553`"}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{
              "0", ",", "0", ",", "0.954839271836`", ",", "9.999198569869`", 
                ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
                RowBox[{"-", "0.008862542164`"}], ",", "0.954487009436`", ",",
                 "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{
                RowBox[{"-", "0.302270533738`"}], ",", 
                RowBox[{"-", "1.47760198881`"}], ",", "0", ",", "0", ",", 
                "1.`", ",", 
                RowBox[{"-", "0.223318272473`"}]}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1.`"}], 
              "}"}]}], "}"}]}],
      (MatrixForm[ #]&)]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"sJ3", "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
    TagBox["sJ3",
      (MatrixForm[ #]&)]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"Dimensions", "[", "m1", "]"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{"6", ",", "6"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{"symplecticQ", "[", "mat_", "]"}], ":=", 
      RowBox[{"(", 
        RowBox[{
          RowBox[{"Chop", "[", 
            RowBox[{
              RowBox[{"Transpose", "[", "mat", "]"}], ".", "sJ3", ".", 
              "mat"}], "]"}], "\[Equal]", "sJ3"}], ")"}]}]], "Input"],

Cell[BoxData[
    RowBox[{
      RowBox[{"General", "::", "\<\"spell1\"\>"}], 
      RowBox[{
      ":", " "}], "\<\"Possible spelling error: new symbol name \
\\\"\\!\\(symplecticQ\\)\\\" is similar to existing symbol \
\\\"\\!\\(symplecticJ\\)\\\".\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"symplecticQ", "/@", "tmat"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{"False", ",", "True", ",", "False", ",", "True", ",", "False"}],
       "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"Transpose", "[", "m1", "]"}], ".", "sJ3", ".", "m1"}], "==", 
      "sJ3"}]], "Input"],

Cell[BoxData["False"], "Output"]
}, Open  ]],

Cell["Check all the matrices for symplecticiy", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"ColumnForm", "[", 
      RowBox[{
        RowBox[{"(", 
          RowBox[{
            RowBox[{"MatrixForm", "[", 
              RowBox[{"Chop", "[", 
                RowBox[{
                  RowBox[{"Transpose", "[", "#1", "]"}], ".", "sJ3", ".", 
                  "#1"}], "]"}], "]"}], "&"}], ")"}], "/@", "accm"}], 
      "]"}]], "Input"],

Cell[BoxData[
    InterpretationBox[GridBox[{
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0", "1.`", "0", "0", "0", "0"},
                    {
                      RowBox[{"-", "1.`"}], "0", "0", "0", "0", "0"},
                    {"0", "0", "0", "1.`", "0", "0"},
                    {"0", "0", 
                      RowBox[{"-", "1.`"}], "0", "0", "0"},
                    {"0", "0", "0", "0", "0", "1.`"},
                    {"0", "0", "0", "0", 
                      RowBox[{"-", "1.`"}], "0"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]},
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0", "1.00000000000072`", "0", "0", 
                      "9.53901822864367`*^-7", "0"},
                    {
                      RowBox[{"-", "1.00000000000072`"}], "0", "0", "0", "0", 
                      "0"},
                    {"0", "0", "0", "0.999999999998464`", "0", "0"},
                    {"0", "0", 
                      RowBox[{"-", "0.999999999998464`"}], "0", "0", "0"},
                    {
                      RowBox[{"-", "9.53901822864367`*^-7"}], "0", "0", "0", 
                      "0", "1.`"},
                    {"0", "0", "0", "0", 
                      RowBox[{"-", "1.`"}], "0"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]},
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0", "1.00000000000072`", "0", "0", 
                      "9.539008232195556`*^-7", "0"},
                    {
                      RowBox[{"-", "1.00000000000072`"}], "0", "0", "0", "0", 
                      "0"},
                    {"0", "0", "0", "0.9999999999984551`", "0", "0"},
                    {"0", "0", 
                      RowBox[{"-", "0.9999999999984551`"}], "0", "0", "0"},
                    {
                      RowBox[{"-", "9.539008232195556`*^-7"}], "0", "0", "0", 
                      "0", "1.`"},
                    {"0", "0", "0", "0", 
                      RowBox[{"-", "1.`"}], "0"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]},
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0", "1.00000000000171`", "0", "0", 
                      "9.491360861701992`*^-7", "0"},
                    {
                      RowBox[{"-", "1.00000000000171`"}], "0", "0", "0", 
                      RowBox[{"-", "9.523666189004132`*^-9"}], "0"},
                    {"0", "0", "0", "1.00000000000529`", "0", "0"},
                    {"0", "0", 
                      RowBox[{"-", "1.00000000000529`"}], "0", "0", "0"},
                    {
                      RowBox[{"-", "9.491360861701992`*^-7"}], 
                      "9.523666189004132`*^-9", "0", "0", "0", "1.`"},
                    {"0", "0", "0", "0", 
                      RowBox[{"-", "1.`"}], "0"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]},
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0", "1.00000000000171`", "0", "0", 
                      "9.491360861701992`*^-7", "0"},
                    {
                      RowBox[{"-", "1.00000000000171`"}], "0", "0", "0", 
                      RowBox[{"-", "9.523666189004132`*^-9"}], "0"},
                    {"0", "0", "0", "1.00000000000529`", "0", "0"},
                    {"0", "0", 
                      RowBox[{"-", "1.00000000000529`"}], "0", "0", "0"},
                    {
                      RowBox[{"-", "9.491360861701992`*^-7"}], 
                      "9.523666189004132`*^-9", "0", "0", "0", "1.`"},
                    {"0", "0", "0", "0", 
                      RowBox[{"-", "1.`"}], "0"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]}
          },
        GridBaseline->{Baseline, {1, 1}},
        ColumnAlignments->{Left}],
      ColumnForm[ {
        MatrixForm[ {{0, 1.0, 0, 0, 0, 0}, {-1.0, 0, 0, 0, 0, 0}, {0, 0, 0, 
          1.0, 0, 0}, {0, 0, -1.0, 0, 0, 0}, {0, 0, 0, 0, 0, 1.0}, {0, 0, 0, 
          0, -1.0, 0}}], 
        MatrixForm[ {{0, 1.0000000000007201, 0, 0, .95390182286436698*^-6, 
          0}, {-1.0000000000007201, 0, 0, 0, 0, 0}, {0, 0, 
          0, .99999999999846401, 0, 0}, {0, 0, -.99999999999846401, 0, 0, 
          0}, {-.95390182286436698*^-6, 0, 0, 0, 0, 1.0}, {0, 0, 0, 0, -1.0, 
          0}}], 
        MatrixForm[ {{0, 1.0000000000007201, 0, 0, .9539008232195556*^-6, 
          0}, {-1.0000000000007201, 0, 0, 0, 0, 0}, {0, 0, 
          0, .99999999999845512, 0, 0}, {0, 0, -.99999999999845512, 0, 0, 
          0}, {-.9539008232195556*^-6, 0, 0, 0, 0, 1.0}, {0, 0, 0, 0, -1.0, 
          0}}], 
        MatrixForm[ {{0, 1.00000000000171, 0, 0, .94913608617019918*^-6, 
          0}, {-1.00000000000171, 0, 0, 0, -.95236661890041319*^-8, 0}, {0, 0,
           0, 1.00000000000529, 0, 0}, {0, 0, -1.00000000000529, 0, 0, 
          0}, {-.94913608617019918*^-6, .95236661890041319*^-8, 0, 0, 0, 
          1.0}, {0, 0, 0, 0, -1.0, 0}}], 
        MatrixForm[ {{0, 1.00000000000171, 0, 0, .94913608617019918*^-6, 
          0}, {-1.00000000000171, 0, 0, 0, -.95236661890041319*^-8, 0}, {0, 0,
           0, 1.00000000000529, 0, 0}, {0, 0, -1.00000000000529, 0, 0, 
          0}, {-.94913608617019918*^-6, .95236661890041319*^-8, 0, 0, 0, 
          1.0}, {0, 0, 0, 0, -1.0, 0}}]}],
      Editable->False]], "Output"]
}, Open  ]],

Cell["Check all their determinants", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"Det", "[", 
          RowBox[{
            RowBox[{"Transpose", "[", "#1", "]"}], ".", "sJ3", ".", "#1"}], 
          "]"}], "&"}], "/@", "accm"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
      "1.`", ",", "0.9999999999983682`", ",", "0.9999999999983504`", ",", 
        "1.000000000014`", ",", "1.000000000014`"}], "}"}]], "Output"]
}, Open  ]],

Cell["\<\
Shift left one element and invert the matrix (this gives the \
inverse of the transfer matrix up to the end of the preceding element).\
\>", \
"Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{"accmli", "=", 
        RowBox[{"Inverse", "/@", 
          RowBox[{"RotateLeft", "[", 
            RowBox[{"accm", ",", "1"}], "]"}]}]}], ";"}]], "Input"],

Cell["\<\
Multiply each element by that to get the individual transfer matrix\
\
\>", "Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{"tmat", "=", 
        RowBox[{"MapThread", "[", 
          RowBox[{"Dot", ",", 
            RowBox[{"{", 
              RowBox[{"accmli", ",", "accm"}], "}"}]}], "]"}]}], 
      ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"ColumnForm", "[", 
      RowBox[{
        RowBox[{"MatrixForm", "/@", "tmat"}], "//", "Chop"}], "]"}]], "Input"],

Cell[BoxData[
    InterpretationBox[GridBox[{
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"1.00017180905228`", "0", "0", "0", 
                      "0.3023224665519337`", "0"},
                    {
                      RowBox[{"-", "9.774163222472962`"}], 
                      "0.9998282204602801`", "0", "0", 
                      RowBox[{"-", "1.4770933670787594`"}], "0"},
                    {"0", "0", "0.9544870094374659`", "0.008862542164013623`",
                       "0", "0"},
                    {"0", "0", 
                      RowBox[{"-", "9.999198569884358`"}], 
                      "0.9548392718374666`", "0", "0"},
                    {"0", "0", "0", "0", "1.`", "0"},
                    {"1.4776029428840067`", 
                      RowBox[{"-", "0.3022705337388485`"}], "0", "0", 
                      "0.22331856086020546`", "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]},
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0.9999999999999999`", "0", "0", "0", "0", "0"},
                    {
                      RowBox[{"-", "1.999999999999`"}], "0.9999999999999999`",
                       "0", "0", "0", "0"},
                    {"0", "0", "1.0000000000000089`", "0", "0", "0"},
                    {"0", "0", 
                      RowBox[{"-", "1.9999999999990603`"}], 
                      "1.0000000000000002`", "0", "0"},
                    {"0", "0", "0", "0", "1.`", "0"},
                    {"0", "0", "0", "0", 
                      RowBox[{"-", "8.689999275723892`*^-10"}], "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]},
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0.9950041652780722`", "0.009983341664818998`", "0", "0",
                       "0", "0"},
                    {
                      RowBox[{"-", "0.998334166470098`"}], 
                      "0.9950041652768297`", "0", "0", "0", "0"},
                    {"0", "0", "1.0050041680561579`", 
                      RowBox[{"-", "0.010016675001316243`"}], "0", "0"},
                    {"0", "0", 
                      RowBox[{"-", "1.0016675002027178`"}], 
                      "1.0050041680480255`", "0", "0"},
                    {"0", "0", "0", "0", "1.`", "0"},
                    {"0", "0", "0", "0", 
                      RowBox[{"-", "4.35000063747637`*^-10"}], "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]},
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"1.`", "0", "0", "0", "0", "0"},
                    {"0", "1.`", "0", "0", "0", "0"},
                    {"0", "0", "1.`", "0", "0", "0"},
                    {"0", "0", "0", "1.`", "0", "0"},
                    {"0", "0", "0", "0", "1.`", "0"},
                    {"0", "0", "0", "0", "0", "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]},
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0.994833243921`", 
                      RowBox[{"-", "0.009981626731`"}], "0", "0", 
                      RowBox[{"-", "0.302270533738`"}], "0"},
                    {"12.714189039793`", "0.877626191278`", "0", "0", 
                      RowBox[{"-", "1.47760198881`"}], "0"},
                    {"0", "0", "0.932926343934`", "0.000479876441`", "0", 
                      "0"},
                    {"0", "0", "12.923841702325`", "1.078543717527`", "0", 
                      "0"},
                    {"0", "0", "0", "0", "1.`", "0"},
                    {"2.373156178216`", "0.280029418293`", "0", "0", 
                      RowBox[{"-", "0.223318271169`"}], "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]}
          },
        GridBaseline->{Baseline, {1, 1}},
        ColumnAlignments->{Left}],
      ColumnForm[ {
        MatrixForm[ {{1.00017180905228, 0, 0, 0, .30232246655193368, 
          0}, {-9.7741632224729624, .99982822046028008, 0, 
          0, -1.4770933670787594, 0}, {0, 
          0, .95448700943746589, .0088625421640136232, 0, 0}, {0, 
          0, -9.9991985698843582, .95483927183746664, 0, 0}, {0, 0, 0, 0, 1.0,
           0}, {1.4776029428840067, -.30227053373884849, 0, 
          0, .22331856086020546, 1.0}}], 
        MatrixForm[ {{.99999999999999989, 0, 0, 0, 0, 
          0}, {-1.9999999999989999, .99999999999999989, 0, 0, 0, 0}, {0, 0, 
          1.0000000000000089, 0, 0, 0}, {0, 0, -1.9999999999990603, 
          1.0000000000000002, 0, 0}, {0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 
          0, -.8689999275723892*^-9, 1.0}}], 
        MatrixForm[ {{.99500416527807223, .0099833416648189982, 0, 0, 0, 
          0}, {-.99833416647009798, .99500416527682967, 0, 0, 0, 0}, {0, 0, 
          1.0050041680561579, -.010016675001316243, 0, 0}, {0, 
          0, -1.0016675002027178, 1.0050041680480255, 0, 0}, {0, 0, 0, 0, 1.0,
           0}, {0, 0, 0, 0, -.435000063747637*^-9, 1.0}}], 
        MatrixForm[ {{1.0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0}, {0, 0, 1.0, 
          0, 0, 0}, {0, 0, 0, 1.0, 0, 0}, {0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 
          0, 1.0}}], 
        MatrixForm[ {{.99483324392100003, -.0099816267310000005, 0, 
          0, -.302270533738, 0}, {12.714189039793, .87762619127800001, 0, 
          0, -1.47760198881, 0}, {0, 
          0, .93292634393399998, .00047987644099999998, 0, 0}, {0, 0, 
          12.923841702324999, 1.0785437175270001, 0, 0}, {0, 0, 0, 0, 1.0, 
          0}, {2.373156178216, .28002941829299999, 0, 0, -.22331827116899999, 
          1.0}}]}],
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
    RowBox[{
      RowBox[{"symplecticInverse", "[", "mat_", "]"}], ":=", 
      RowBox[{
        RowBox[{"Transpose", "[", "sJ3", "]"}], ".", 
        RowBox[{"Transpose", "[", "mat", "]"}], ".", "sJ3"}]}]], "Input"],

Cell["\<\
So we can test whether the transfer matrix for each individual \
element is symplectic.  The following should return a list of identity \
matrices.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"ColumnForm", "[", 
      RowBox[{
        RowBox[{"(", 
          RowBox[{
            RowBox[{"MatrixForm", "[", 
              RowBox[{"Chop", "[", 
                RowBox[{
                  RowBox[{"Transpose", "[", "sJ3", "]"}], ".", 
                  RowBox[{"Transpose", "[", "#1", "]"}], ".", "sJ3", ".", 
                  "#1"}], "]"}], "]"}], "&"}], ")"}], "/@", "tmat"}], 
      "]"}]], "Input"],

Cell[BoxData[
    InterpretationBox[GridBox[{
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0.99999999999928`", "0", "0", "0", "0", "0"},
                    {"0", "0.99999999999928`", "0", "0", 
                      RowBox[{"-", "9.540750705028245`*^-7"}], "0"},
                    {"0", "0", "1.0000000000015359`", "0", "0", "0"},
                    {"0", "0", "0", "1.0000000000015359`", "0", "0"},
                    {"0", "0", "0", "0", "1.`", "0"},
                    {"9.540750705028245`*^-7", "0", "0", "0", "0", "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]},
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0.9999999999999998`", "0", "0", "0", "0", "0"},
                    {"0", "0.9999999999999998`", "0", "0", "0", "0"},
                    {"0", "0", "1.000000000000009`", "0", "0", "0"},
                    {"0", "0", "0", "1.000000000000009`", "0", "0"},
                    {"0", "0", "0", "0", "1.`", "0"},
                    {"0", "0", "0", "0", "0", "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]},
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0.9999999999990102`", "0", "0", "0", "0", "0"},
                    {"0", "0.9999999999990102`", "0", "0", "0", "0"},
                    {"0", "0", "0.9999999999931655`", "0", "0", "0"},
                    {"0", "0", "0", "0.9999999999931655`", "0", "0"},
                    {"0", "0", "0", "0", "1.`", "0"},
                    {"0", "0", "0", "0", "0", "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]},
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"1.`", "0", "0", "0", "0", "0"},
                    {"0", "1.`", "0", "0", "0", "0"},
                    {"0", "0", "1.`", "0", "0", "0"},
                    {"0", "0", "0", "1.`", "0", "0"},
                    {"0", "0", "0", "0", "1.`", "0"},
                    {"0", "0", "0", "0", "0", "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]},
          {
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"1.00000000000171`", "0", "0", "0", 
                      "9.523666189004132`*^-9", "0"},
                    {"0", "1.00000000000171`", "0", "0", 
                      "9.491360861701992`*^-7", "0"},
                    {"0", "0", "1.00000000000529`", "0", "0", "0"},
                    {"0", "0", "0", "1.00000000000529`", "0", "0"},
                    {"0", "0", "0", "0", "1.`", "0"},
                    {
                      RowBox[{"-", "9.491360861701992`*^-7"}], 
                      "9.523666189004132`*^-9", "0", "0", "0", "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]}
          },
        GridBaseline->{Baseline, {1, 1}},
        ColumnAlignments->{Left}],
      ColumnForm[ {
        MatrixForm[ {{.99999999999928002, 0, 0, 0, 0, 0}, {
          0, .99999999999928002, 0, 0, -.95407507050282447*^-6, 0}, {0, 0, 
          1.0000000000015359, 0, 0, 0}, {0, 0, 0, 1.0000000000015359, 0, 0}, {
          0, 0, 0, 0, 1.0, 0}, {.95407507050282447*^-6, 0, 0, 0, 0, 1.0}}], 
        MatrixForm[ {{.99999999999999978, 0, 0, 0, 0, 0}, {
          0, .99999999999999978, 0, 0, 0, 0}, {0, 0, 1.0000000000000091, 0, 0,
           0}, {0, 0, 0, 1.0000000000000091, 0, 0}, {0, 0, 0, 0, 1.0, 0}, {0, 
          0, 0, 0, 0, 1.0}}], 
        MatrixForm[ {{.99999999999901024, 0, 0, 0, 0, 0}, {
          0, .99999999999901024, 0, 0, 0, 0}, {0, 0, .99999999999316547, 0, 0,
           0}, {0, 0, 0, .99999999999316547, 0, 0}, {0, 0, 0, 0, 1.0, 0}, {0, 
          0, 0, 0, 0, 1.0}}], 
        MatrixForm[ {{1.0, 0, 0, 0, 0, 0}, {0, 1.0, 0, 0, 0, 0}, {0, 0, 1.0, 
          0, 0, 0}, {0, 0, 0, 1.0, 0, 0}, {0, 0, 0, 0, 1.0, 0}, {0, 0, 0, 0, 
          0, 1.0}}], 
        MatrixForm[ {{1.00000000000171, 0, 0, 0, .95236661890041319*^-8, 0}, {
          0, 1.00000000000171, 0, 0, .94913608617019918*^-6, 0}, {0, 0, 
          1.00000000000529, 0, 0, 0}, {0, 0, 0, 1.00000000000529, 0, 0}, {0, 
          0, 0, 0, 1.0, 0}, {-.94913608617019918*^-6, .95236661890041319*^-8, 
          0, 0, 0, 1.0}}]}],
      Editable->False]], "Output"]
}, Open  ]],

Cell["Take the square root of that transfer matrix", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"MatrixPower", "[", 
          RowBox[{"m1", ",", 
            RowBox[{"1", "/", "2"}]}], "]"}], "//", "Chop"}], "//", 
      "MatrixForm"}]], "Input"],

Cell[BoxData[
    RowBox[{
      RowBox[{"Inverse", "::", "\<\"luc\"\>"}], 
      RowBox[{
      ":", " "}], "\<\"Result for \\!\\(Inverse\\) of badly conditioned \
matrix \\!\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\) may contain \
significant numerical errors.\"\>"}]], "Message"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1.0137086644909283`", 
              RowBox[{"-", "0.005072334509041968`"}], "0", "0", 
              RowBox[{"-", "0.15075550481184732`"}], "0"},
            {"6.460932827786109`", "0.9541478941028908`", "0", "0", 
              RowBox[{"-", "0.25769840671800637`"}], "0"},
            {"0", "0", "0.9650804709476437`", "0.00023959494531682925`", "0", 
              "0"},
            {"0", "0", "6.4526759002780665`", "1.0377849916998825`", "0", 
              "0"},
            {"0", "0", "0", "0", "1.`", "0"},
            {"0.7127895993409297`", "0.145150183582005`", "0", "0", "4.5`", 
              "1.`"}
            }], "\[NoBreak]", ")"}],
      (MatrixForm[ #]&)]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"Table", "[", 
      RowBox[{
        RowBox[{
          RowBox[{"(", 
            RowBox[{
              RowBox[{"MatrixNorm", "[", 
                RowBox[{"#", ",", "p"}], "]"}], "&"}], ")"}], "/@", "tmat"}], 
        ",", 
        RowBox[{"{", 
          RowBox[{"p", ",", "1", ",", "2"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        RowBox[{"{", 
          RowBox[{
          "12.251937974409248`", ",", "2.999999999999697`", ",", 
            "2.0066716682588757`", ",", "1.`", ",", "16.08217846193`"}], 
          "}"}], ",", 
        RowBox[{"{", 
          RowBox[{
          "10.095797251150044`", ",", "2.4142120682118353`", ",", 
            "1.6170616386793841`", ",", "1.`", ",", "13.055360907204964`"}], 
          "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"MatrixNorm", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", "tmat"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
      "12.251937974409248`", ",", "2.999999999999697`", ",", 
        "2.0066716682588757`", ",", "1.`", ",", "16.08217846193`"}], 
      "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"MatrixNorm", "[", 
          RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "tmat"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
      "10.095944573315542`", ",", "2.414212115488373`", ",", 
        "1.617913518981056`", ",", "1.`", ",", "13.053755210590802`"}], 
      "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{"MatrixNorm", "[", "#", "]"}], "&"}], "/@", "tmat"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
      "12.251084810012003`", ",", "2.9999999999990603`", ",", 
        "2.0066716682507435`", ",", "1.`", ",", "15.069417219881`"}], 
      "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transfer matrix for each element", "Subsection"],

Cell["\<\
Construct a function that provides the transfer matrix from one \
element to the next.\
\>", "Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{"elementMatrix", "[", "mt_mfs", "]"}], ":=", 
      RowBox[{"Module", "[", 
        RowBox[{
          RowBox[{"{", 
            RowBox[{
              RowBox[{"newmt", "=", "mt"}], ",", "nam", ",", "ss", ",", 
              "accm", ",", "accmli"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
            RowBox[{"nam", "=", 
              RowBox[{"mfsColumn", "[", 
                RowBox[{"mt", ",", "\"\<NAME\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ss", "=", 
              RowBox[{"mfsColumn", "[", 
                RowBox[{"mt", ",", "\"\<S\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"accm", "=", 
              RowBox[{"mfsColumn", "[", 
                RowBox[{"mt", ",", "\"\<RMATRIX\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"accmli", "=", 
              RowBox[{"Inverse", "/@", 
                RowBox[{"RotateLeft", "[", 
                  RowBox[{"accm", ",", "1"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"mfs", "[", 
              RowBox[{
                RowBox[{"First", "[", "mt", "]"}], ",", 
                RowBox[{"{", 
                  RowBox[{
                  "\"\<NAMEFROMTO\>\"", ",", "\"\<SFROMTO\>\"", ",", 
                    "\"\<RMATRIXFROMTO\>\""}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Transpose", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                      RowBox[{"Drop", "[", 
                        RowBox[{
                          RowBox[{"Transpose", "[", 
                            RowBox[{"{", 
                              RowBox[{"nam", ",", 
                                RowBox[{"RotateLeft", "[", "nam", "]"}]}], 
                              "}"}], "]"}], ",", 
                          RowBox[{"-", "1"}]}], "]"}], ",", 
                      "\[IndentingNewLine]", 
                      RowBox[{"Drop", "[", 
                        RowBox[{
                          RowBox[{"Transpose", "[", 
                            RowBox[{"{", 
                              RowBox[{"ss", ",", 
                                RowBox[{"RotateLeft", "[", "ss", "]"}]}], 
                              "}"}], "]"}], ",", 
                          RowBox[{"-", "1"}]}], "]"}], ",", 
                      "\[IndentingNewLine]", 
                      RowBox[{"Drop", "[", 
                        RowBox[{
                          RowBox[{"MapThread", "[", 
                            RowBox[{"Dot", ",", 
                              RowBox[{"{", 
                                RowBox[{"accmli", ",", "accm"}], "}"}]}], 
                            "]"}], ",", 
                          RowBox[{"-", "1"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}]}]], "Input"],

Cell["\<\
Alternative version assuming matrices are symplectic and can be \
inverted the fast way\
\>", "Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{"elementMatrixS", "[", "mt_mfs", "]"}], ":=", 
      RowBox[{"Module", "[", 
        RowBox[{
          RowBox[{"{", 
            RowBox[{
              RowBox[{"newmt", "=", "mt"}], ",", "nam", ",", "ss", ",", 
              "accm", ",", "accmli"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
            RowBox[{"nam", "=", 
              RowBox[{"mfsColumn", "[", 
                RowBox[{"mt", ",", "\"\<NAME\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"ss", "=", 
              RowBox[{"mfsColumn", "[", 
                RowBox[{"mt", ",", "\"\<S\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"accm", "=", 
              RowBox[{"mfsColumn", "[", 
                RowBox[{"mt", ",", "\"\<RMATRIX\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"accmli", "=", 
              RowBox[{"symplecticInverse", "/@", 
                RowBox[{"RotateLeft", "[", 
                  RowBox[{"accm", ",", "1"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"mfs", "[", 
              RowBox[{
                RowBox[{"First", "[", "mt", "]"}], ",", 
                RowBox[{"{", 
                  RowBox[{
                  "\"\<NAMEFROMTO\>\"", ",", "\"\<SFROMTO\>\"", ",", 
                    "\"\<RMATRIXFROMTO\>\""}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Transpose", "[", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                      RowBox[{"Drop", "[", 
                        RowBox[{
                          RowBox[{"Transpose", "[", 
                            RowBox[{"{", 
                              RowBox[{"nam", ",", 
                                RowBox[{"RotateLeft", "[", "nam", "]"}]}], 
                              "}"}], "]"}], ",", 
                          RowBox[{"-", "1"}]}], "]"}], ",", 
                      "\[IndentingNewLine]", 
                      RowBox[{"Drop", "[", 
                        RowBox[{
                          RowBox[{"Transpose", "[", 
                            RowBox[{"{", 
                              RowBox[{"ss", ",", 
                                RowBox[{"RotateLeft", "[", "ss", "]"}]}], 
                              "}"}], "]"}], ",", 
                          RowBox[{"-", "1"}]}], "]"}], ",", 
                      "\[IndentingNewLine]", 
                      RowBox[{"Drop", "[", 
                        RowBox[{
                          RowBox[{"MapThread", "[", 
                            RowBox[{"Dot", ",", 
                              RowBox[{"{", 
                                RowBox[{"accmli", ",", "accm"}], "}"}]}], 
                            "]"}], ",", 
                          RowBox[{"-", "1"}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}]}]], "Input"],

Cell["\<\
Should implement an option about whether to assume symplectic, then \
combine these two functions in one with just one line depending on the \
option.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"nam", "=", 
      RowBox[{"mfsColumn", "[", 
        RowBox[{"mt", ",", "\"\<NAME\>\""}], "]"}]}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{"\<\"#S\"\>", ",", "\<\"RB1\"\>", ",", "\<\"D1\"\>", 
        ",", "\<\"Q1\"\>", ",", "\<\"#E\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"ss", "=", 
      RowBox[{"mfsColumn", "[", 
        RowBox[{"mt", ",", "\"\<S\>\""}], "]"}]}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{"0.`", ",", "10.`", ",", "12.`", ",", "13.`", ",", "13.`"}], 
      "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"Transpose", "[", 
      RowBox[{"{", 
        RowBox[{"nam", ",", 
          RowBox[{"RotateLeft", "[", "nam", "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        RowBox[{"{", 
          RowBox[{"\<\"#S\"\>", ",", "\<\"RB1\"\>"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"RB1\"\>", ",", "\<\"D1\"\>"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"D1\"\>", ",", "\<\"Q1\"\>"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"Q1\"\>", ",", "\<\"#E\"\>"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"\<\"#E\"\>", ",", "\<\"#S\"\>"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
    RowBox[{
      RowBox[{"accmli", "=", 
        RowBox[{"Inverse", "/@", 
          RowBox[{"RotateLeft", "[", 
            RowBox[{"accm", ",", "1"}], "]"}]}]}], ";"}]], "Input"],

Cell["\<\
Multiply each element by that to get the individual transfer matrix\
\
\>", "Text"],

Cell[BoxData[
    RowBox[{
      RowBox[{"tmat", "=", 
        RowBox[{"MapThread", "[", 
          RowBox[{"Dot", ",", 
            RowBox[{"{", 
              RowBox[{"accmli", ",", "accm"}], "}"}]}], "]"}]}], 
      ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{"Last", "[", 
        RowBox[{"elementMatrix", "[", "mt", "]"}], "]"}], "/.", 
      RowBox[{
        RowBox[{"{", 
          RowBox[{"nn_", ",", "ss_", ",", "mm_"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
          RowBox[{"nn", ",", "ss", ",", 
            RowBox[{"MatrixForm", "[", "mm", "]"}]}], "}"}]}]}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        RowBox[{"{", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{"\<\"#S\"\>", ",", "\<\"RB1\"\>"}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{"0.`", ",", "10.`"}], "}"}], ",", 
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"1.00017180905228`", 
                      RowBox[{"-", "1.3877787807814457`*^-17"}], "0.`", "0.`",
                       "0.3023224665519337`", "0.`"},
                    {
                      RowBox[{"-", "9.774163222472962`"}], 
                      "0.9998282204602801`", "0.`", "0.`", 
                      RowBox[{"-", "1.4770933670787594`"}], "0.`"},
                    {"0.`", "0.`", "0.9544870094374659`", 
                      "0.008862542164013623`", "0.`", "0.`"},
                    {"0.`", "0.`", 
                      RowBox[{"-", "9.999198569884358`"}], 
                      "0.9548392718374666`", "0.`", "0.`"},
                    {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
                    {"1.4776029428840067`", 
                      RowBox[{"-", "0.3022705337388485`"}], "0.`", "0.`", 
                      "0.22331856086020546`", "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{"\<\"RB1\"\>", ",", "\<\"D1\"\>"}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{"10.`", ",", "12.`"}], "}"}], ",", 
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0.9999999999999999`", "8.075980089325423`*^-18", "0.`", 
                      "0.`", "2.479330879190389`*^-17", 
                      RowBox[{"-", "1.1102230246251565`*^-16"}]},
                    {
                      RowBox[{"-", "1.999999999999`"}], "0.9999999999999999`",
                       "0.`", "0.`", "0.`", "0.`"},
                    {"0.`", "0.`", "1.0000000000000089`", 
                      RowBox[{"-", "1.3877787807814457`*^-17"}], "0.`", 
                      "0.`"},
                    {"0.`", "0.`", 
                      RowBox[{"-", "1.9999999999990603`"}], 
                      "1.0000000000000002`", "0.`", "0.`"},
                    {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
                    {"6.969980148596733`*^-13", "0.`", "0.`", "0.`", 
                      RowBox[{"-", "8.689999275723892`*^-10"}], "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{"\<\"D1\"\>", ",", "\<\"Q1\"\>"}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{"12.`", ",", "13.`"}], "}"}], ",", 
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"0.9950041652780722`", "0.009983341664818998`", "0.`", 
                      "0.`", "0.`", "0.`"},
                    {
                      RowBox[{"-", "0.998334166470098`"}], 
                      "0.9950041652768297`", "0.`", "0.`", "0.`", "0.`"},
                    {"0.`", "0.`", "1.0050041680561579`", 
                      RowBox[{"-", "0.010016675001316243`"}], "0.`", "0.`"},
                    {"0.`", "0.`", 
                      RowBox[{"-", "1.0016675002027178`"}], 
                      "1.0050041680480255`", "0.`", "0.`"},
                    {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
                    {"1.3375967000683886`*^-12", "3.1097346919750635`*^-13", 
                      "0.`", "0.`", 
                      RowBox[{"-", "4.35000063747637`*^-10"}], "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"{", 
              RowBox[{"\<\"Q1\"\>", ",", "\<\"#E\"\>"}], "}"}], ",", 
            RowBox[{"{", 
              RowBox[{"13.`", ",", "13.`"}], "}"}], ",", 
            TagBox[
              RowBox[{"(", "\[NoBreak]", GridBox[{
                    {"1.`", "1.5612511283791264`*^-17", "0.`", "0.`", "0.`", 
                      "0.`"},
                    {"0.`", "1.`", "0.`", "0.`", "0.`", "0.`"},
                    {"0.`", "0.`", "1.`", 
                      RowBox[{"-", "3.469446951953614`*^-18"}], "0.`", 
                      "0.`"},
                    {"0.`", "0.`", "0.`", "1.`", "0.`", "0.`"},
                    {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
                    {"0.`", "5.551115123125783`*^-17", "0.`", "0.`", 
                      RowBox[{"-", "5.551115123125783`*^-17"}], "1.`"}
                    }], "\[NoBreak]", ")"}],
              (MatrixForm[ #]&)]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"ColumnForm", "[", 
      RowBox[{
        RowBox[{"Last", "[", 
          RowBox[{"elementMatrix", "[", "mt", "]"}], "]"}], "/.", 
        "\[InvisibleSpace]", 
        RowBox[{
          RowBox[{"{", 
            RowBox[{"nn_", ",", "ss_", ",", "mm_"}], "}"}], "\[Rule]", 
          RowBox[{"{", 
            RowBox[{"nn", ",", "ss", ",", 
              RowBox[{"MatrixForm", "[", 
                RowBox[{"Chop", "[", "mm", "]"}], "]"}]}], "}"}]}]}], 
      "]"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        RowBox[{"0.009999999999999787`", " ", "Second"}], ",", 
        InterpretationBox[GridBox[{
              {
                RowBox[{"{", 
                  RowBox[{
                    RowBox[{"{", 
                      RowBox[{"\<\"#S\"\>", ",", "\<\"RB1\"\>"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                      RowBox[{"0.`", ",", "10.`"}], "}"}], ",", 
                    TagBox[
                      RowBox[{"(", "\[NoBreak]", GridBox[{
                            {"1.00017180905228`", 
                              RowBox[{"-", "1.3877787807814457`*^-17"}], 
                              "0.`", "0.`", "0.3023224665519337`", "0.`"},
                            {
                              RowBox[{"-", "9.774163222472962`"}], 
                              "0.9998282204602801`", "0.`", "0.`", 
                              RowBox[{"-", "1.4770933670787594`"}], "0.`"},
                            {"0.`", "0.`", "0.9544870094374659`", 
                              "0.008862542164013623`", "0.`", "0.`"},
                            {"0.`", "0.`", 
                              RowBox[{"-", "9.999198569884358`"}], 
                              "0.9548392718374666`", "0.`", "0.`"},
                            {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
                            {"1.4776029428840067`", 
                              RowBox[{"-", "0.3022705337388485`"}], "0.`", 
                              "0.`", "0.22331856086020546`", "1.`"}
                            }], "\[NoBreak]", ")"}],
                      (MatrixForm[ #]&)]}], "}"}]},
              {
                RowBox[{"{", 
                  RowBox[{
                    RowBox[{"{", 
                      RowBox[{"\<\"RB1\"\>", ",", "\<\"D1\"\>"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                      RowBox[{"10.`", ",", "12.`"}], "}"}], ",", 
                    TagBox[
                      RowBox[{"(", "\[NoBreak]", GridBox[{
                            {"0.9999999999999999`", "8.075980089325423`*^-18",
                               "0.`", "0.`", "2.479330879190389`*^-17", 
                              RowBox[{"-", "1.1102230246251565`*^-16"}]},
                            {
                              RowBox[{"-", "1.999999999999`"}], 
                              "0.9999999999999999`", "0.`", "0.`", "0.`", 
                              "0.`"},
                            {"0.`", "0.`", "1.0000000000000089`", 
                              RowBox[{"-", "1.3877787807814457`*^-17"}], 
                              "0.`", "0.`"},
                            {"0.`", "0.`", 
                              RowBox[{"-", "1.9999999999990603`"}], 
                              "1.0000000000000002`", "0.`", "0.`"},
                            {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
                            {"6.969980148596733`*^-13", "0.`", "0.`", "0.`", 
                              RowBox[{"-", "8.689999275723892`*^-10"}], 
                              "1.`"}
                            }], "\[NoBreak]", ")"}],
                      (MatrixForm[ #]&)]}], "}"}]},
              {
                RowBox[{"{", 
                  RowBox[{
                    RowBox[{"{", 
                      RowBox[{"\<\"D1\"\>", ",", "\<\"Q1\"\>"}], "}"}], ",", 
                    RowBox[{"{", 
                      RowBox[{"12.`", ",", "13.`"}], "}"}], ",", 
                    TagBox[
                      RowBox[{"(", "\[NoBreak]", GridBox[{
                            {"0.9950041652780722`", "0.009983341664818998`", 
                              "0.`", "0.`", "0.`", "0.`"},
                            {
                              RowBox[{"-", "0.998334166470098`"}], 
                              "0.9950041652768297`", "0.`", "0.`", "0.`", 
                              "0.`"},
                            {"0.`", "0.`", "1.0050041680561579`", 
                              RowBox[{"-", "0.010016675001316243`"}], "0.`", 
                              "0.`"},
                            {"0.`", "0.`", 
                              RowBox[{"-", "1.0016675002027178`"}], 
                              "1.0050041680480255`", "0.`", "0.`"},
                            {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
                            {"1.3375967000683886`*^-12", 
                              "3.1097346919750635`*^-13", "0.`", "0.`", 
                              RowBox[{"-", "4.35000063747637`*^-10"}], "1.`"}
                            }], "\[NoBreak]", ")"}],
                      (MatrixForm[ #]&)]}], "}"}]},
              {
                RowBox[{"{", 
                  RowBox[{
                    RowBox[{"{", 
                      RowBox[{"\<\"Q1\"\>", ",", "\<\"#E\"\>"}], "}"}], ",", 
                    RowBox[{"{", 
                      RowBox[{"13.`", ",", "13.`"}], "}"}], ",", 
                    TagBox[
                      RowBox[{"(", "\[NoBreak]", GridBox[{
                            {"1.`", "1.5612511283791264`*^-17", "0.`", "0.`", 
                              "0.`", "0.`"},
                            {"0.`", "1.`", "0.`", "0.`", "0.`", "0.`"},
                            {"0.`", "0.`", "1.`", 
                              RowBox[{"-", "3.469446951953614`*^-18"}], "0.`",
                               "0.`"},
                            {"0.`", "0.`", "0.`", "1.`", "0.`", "0.`"},
                            {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
                            {"0.`", "5.551115123125783`*^-17", "0.`", "0.`", 
                              RowBox[{"-", "5.551115123125783`*^-17"}], 
                              "1.`"}
                            }], "\[NoBreak]", ")"}],
                      (MatrixForm[ #]&)]}], "}"}]}
              },
            GridBaseline->{Baseline, {1, 1}},
            ColumnAlignments->{Left}],
          ColumnForm[ {{{"#S", "RB1"}, {0.0, .1*^2}, 
            
            MatrixForm[ {{1.00017180905228, -.13877787807814457*^-16, 0.0, 
              0.0, .30232246655193368, 
              0.0}, {-9.7741632224729624, .99982822046028008, 0.0, 
              0.0, -1.4770933670787594, 0.0}, {0.0, 
              0.0, .95448700943746589, .0088625421640136232, 0.0, 0.0}, {0.0, 
              0.0, -9.9991985698843582, .95483927183746664, 0.0, 0.0}, {0.0, 
              0.0, 0.0, 0.0, 1.0, 0.0}, {
              1.4776029428840067, -.30227053373884849, 0.0, 
              0.0, .22331856086020546, 1.0}}]}, {{"RB1", "D1"}, {.1*^2, 12.0},
             
            
            MatrixForm[ {{.99999999999999989, .80759800893254225*^-17, 0.0, 
              0.0, .24793308791903891*^-16, -.11102230246251565*^-15}, \
{-1.9999999999989999, .99999999999999989, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 
              1.0000000000000089, -.13877787807814457*^-16, 0.0, 0.0}, {0.0, 
              0.0, -1.9999999999990603, 1.0000000000000002, 0.0, 0.0}, {0.0, 
              0.0, 0.0, 0.0, 1.0, 0.0}, {.69699801485967328*^-12, 0.0, 0.0, 
              0.0, -.8689999275723892*^-9, 1.0}}]}, {{"D1", "Q1"}, {12.0, 
            13.0}, 
            
            MatrixForm[ {{.99500416527807223, .0099833416648189982, 0.0, 0.0, 
              0.0, 0.0}, {-.99833416647009798, .99500416527682967, 0.0, 0.0, 
              0.0, 0.0}, {0.0, 0.0, 1.0050041680561579, -.010016675001316243, 
              0.0, 0.0}, {0.0, 0.0, -1.0016675002027178, 1.0050041680480255, 
              0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 1.0, 
              0.0}, {.13375967000683886*^-11, .31097346919750635*^-12, 0.0, 
              0.0, -.435000063747637*^-9, 1.0}}]}, {{"Q1", "#E"}, {13.0, 
            13.0}, 
            
            MatrixForm[ {{1.0, .15612511283791264*^-16, 0.0, 0.0, 0.0, 0.0}, {
              0.0, 1.0, 0.0, 0.0, 0.0, 0.0}, {0.0, 0.0, 
              1.0, -.34694469519536142*^-17, 0.0, 0.0}, {0.0, 0.0, 0.0, 1.0, 
              0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 1.0, 0.0}, {
              0.0, .55511151231257827*^-16, 0.0, 
              0.0, -.55511151231257827*^-16, 1.0}}]}}],
          Editable->False]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"ColumnForm", "[", 
      RowBox[{
        RowBox[{"Last", "[", 
          RowBox[{"elementMatrixS", "[", "mt", "]"}], "]"}], "/.", 
        "\[InvisibleSpace]", 
        RowBox[{
          RowBox[{"{", 
            RowBox[{"nn_", ",", "ss_", ",", "mm_"}], "}"}], "\[Rule]", 
          RowBox[{"{", 
            RowBox[{"nn", ",", "ss", ",", 
              RowBox[{"MatrixForm", "[", 
                RowBox[{"Chop", "[", "mm", "]"}], "]"}]}], "}"}]}]}], 
      "]"}]], "Input"],

Cell[BoxData[
    InterpretationBox[GridBox[{
          {
            RowBox[{"{", 
              RowBox[{
                RowBox[{"{", 
                  RowBox[{"\<\"#S\"\>", ",", "\<\"RB1\"\>"}], "}"}], ",", 
                RowBox[{"{", 
                  RowBox[{"0.`", ",", "10.`"}], "}"}], ",", 
                TagBox[
                  RowBox[{"(", "\[NoBreak]", GridBox[{
                        {"1.000171809053`", "0.`", "0.`", "0.`", 
                          "0.302322466553`", "0.`"},
                        {
                          RowBox[{"-", "9.77416322248`"}], "0.999828220461`", 
                          "0.`", "0.`", 
                          RowBox[{"-", "1.477092413178`"}], "0.`"},
                        {"0.`", "0.`", "0.954487009436`", "0.008862542164`", 
                          "0.`", "0.`"},
                        {"0.`", "0.`", 
                          RowBox[{"-", "9.999198569869`"}], "0.954839271836`",
                           "0.`", "0.`"},
                        {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
                        {"1.47760198881`", 
                          RowBox[{"-", "0.302270533738`"}], "0.`", "0.`", 
                          "0.223318272473`", "1.`"}
                        }], "\[NoBreak]", ")"}],
                  (MatrixForm[ #]&)]}], "}"}]},
          {
            RowBox[{"{", 
              RowBox[{
                RowBox[{"{", 
                  RowBox[{"\<\"RB1\"\>", ",", "\<\"D1\"\>"}], "}"}], ",", 
                RowBox[{"{", 
                  RowBox[{"10.`", ",", "12.`"}], "}"}], ",", 
                TagBox[
                  RowBox[{"(", "\[NoBreak]", GridBox[{
                        {"1.00000000000072`", "0.`", "0.`", "0.`", 
                          "8.486544800234697`*^-13", "0.`"},
                        {
                          RowBox[{"-", "2.0000000000004405`"}], 
                          "1.00000000000072`", "0.`", "0.`", 
                          "9.539008232195556`*^-7", "0.`"},
                        {"0.`", "0.`", "0.999999999998464`", "0.`", "0.`", 
                          "0.`"},
                        {"0.`", "0.`", 
                          RowBox[{"-", "1.999999999995973`"}], 
                          "0.9999999999984551`", "0.`", "0.`"},
                        {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
                        {
                          RowBox[{"-", "9.53901822864367`*^-7"}], 
                          "8.486544800234697`*^-13", "0.`", "0.`", 
                          RowBox[{"-", "8.69000010839116`*^-10"}], "1.`"}
                        }], "\[NoBreak]", ")"}],
                  (MatrixForm[ #]&)]}], "}"}]},
          {
            RowBox[{"{", 
              RowBox[{
                RowBox[{"{", 
                  RowBox[{"\<\"D1\"\>", ",", "\<\"Q1\"\>"}], "}"}], ",", 
                RowBox[{"{", 
                  RowBox[{"12.`", ",", "13.`"}], "}"}], ",", 
                TagBox[
                  RowBox[{"(", "\[NoBreak]", GridBox[{
                        {"0.9950041652797735`", "0.009983341664836054`", 
                          "0.`", "0.`", "9.523666189004132`*^-9", "0.`"},
                        {
                          RowBox[{"-", "0.9983341664718051`"}], 
                          "0.9950041652785311`", "0.`", "0.`", 
                          "9.491360861701992`*^-7", "0.`"},
                        {"0.`", "0.`", "1.005004168061474`", 
                          RowBox[{"-", "0.010016675001369225`"}], "0.`", 
                          "0.`"},
                        {"0.`", "0.`", 
                          RowBox[{"-", "1.0016675002080166`"}], 
                          "1.0050041680533417`", "0.`", "0.`"},
                        {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
                        {
                          RowBox[{"-", "9.539008232195556`*^-7"}], 
                          "8.486544800234697`*^-13", "0.`", "0.`", 
                          RowBox[{"-", "4.3500000823648577`*^-10"}], "1.`"}
                        }], "\[NoBreak]", ")"}],
                  (MatrixForm[ #]&)]}], "}"}]},
          {
            RowBox[{"{", 
              RowBox[{
                RowBox[{"{", 
                  RowBox[{"\<\"Q1\"\>", ",", "\<\"#E\"\>"}], "}"}], ",", 
                RowBox[{"{", 
                  RowBox[{"13.`", ",", "13.`"}], "}"}], ",", 
                TagBox[
                  RowBox[{"(", "\[NoBreak]", GridBox[{
                        {"1.00000000000171`", "0.`", "0.`", "0.`", 
                          "9.523666189004132`*^-9", "0.`"},
                        {"0.`", "1.00000000000171`", "0.`", "0.`", 
                          "9.491360861701992`*^-7", "0.`"},
                        {"0.`", "0.`", "1.00000000000529`", "0.`", "0.`", 
                          "0.`"},
                        {"0.`", "0.`", "0.`", "1.00000000000529`", "0.`", 
                          "0.`"},
                        {"0.`", "0.`", "0.`", "0.`", "1.`", "0.`"},
                        {
                          RowBox[{"-", "9.491360861701992`*^-7"}], 
                          "9.523666189004132`*^-9", "0.`", "0.`", "0.`", 
                          "1.`"}
                        }], "\[NoBreak]", ")"}],
                  (MatrixForm[ #]&)]}], "}"}]}
          },
        GridBaseline->{Baseline, {1, 1}},
        ColumnAlignments->{Left}],
      ColumnForm[ {{{"#S", "RB1"}, {0.0, .1*^2}, 
        MatrixForm[ {{1.0001718090530001, 0.0, 0.0, 0.0, .30232246655299999, 
          0.0}, {-9.7741632224800004, .99982822046099995, 0.0, 
          0.0, -1.4770924131780001, 0.0}, {0.0, 
          0.0, .95448700943599996, .0088625421640000004, 0.0, 0.0}, {0.0, 
          0.0, -9.9991985698689998, .95483927183600004, 0.0, 0.0}, {0.0, 0.0, 
          0.0, 0.0, 1.0, 0.0}, {1.47760198881, -.302270533738, 0.0, 
          0.0, .22331827247300001, 1.0}}]}, {{"RB1", "D1"}, {.1*^2, 12.0}, 
        MatrixForm[ {{1.0000000000007201, 0.0, 0.0, 
          0.0, .84865448002346966*^-12, 0.0}, {-2.0000000000004405, 
          1.0000000000007201, 0.0, 0.0, .9539008232195556*^-6, 0.0}, {0.0, 
          0.0, .99999999999846401, 0.0, 0.0, 0.0}, {0.0, 
          0.0, -1.999999999995973, .99999999999845512, 0.0, 0.0}, {0.0, 0.0, 
          0.0, 0.0, 1.0, 
          0.0}, {-.95390182286436698*^-6, .84865448002346966*^-12, 0.0, 
          0.0, -.86900001083911604*^-9, 1.0}}]}, {{"D1", "Q1"}, {12.0, 13.0}, 
        
        MatrixForm[ {{.99500416527977353, .009983341664836054, 0.0, 
          0.0, .95236661890041319*^-8, 
          0.0}, {-.99833416647180506, .99500416527853108, 0.0, 
          0.0, .94913608617019918*^-6, 0.0}, {0.0, 0.0, 
          1.0050041680614741, -.010016675001369225, 0.0, 0.0}, {0.0, 
          0.0, -1.0016675002080166, 1.0050041680533417, 0.0, 0.0}, {0.0, 0.0, 
          0.0, 0.0, 1.0, 
          0.0}, {-.9539008232195556*^-6, .84865448002346966*^-12, 0.0, 
          0.0, -.43500000823648577*^-9, 1.0}}]}, {{"Q1", "#E"}, {13.0, 13.0}, 
        
        MatrixForm[ {{1.00000000000171, 0.0, 0.0, 0.0, .95236661890041319*^-8,
           0.0}, {0.0, 1.00000000000171, 0.0, 0.0, .94913608617019918*^-6, 
          0.0}, {0.0, 0.0, 1.00000000000529, 0.0, 0.0, 0.0}, {0.0, 0.0, 0.0, 
          1.00000000000529, 0.0, 0.0}, {0.0, 0.0, 0.0, 0.0, 1.0, 
          0.0}, {-.94913608617019918*^-6, .95236661890041319*^-8, 0.0, 0.0, 
          0.0, 1.0}}]}}],
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"mat", "=", 
      RowBox[{"tmat", "[", 
        RowBox[{"[", 
          RowBox[{"-", "3"}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        RowBox[{"{", 
          RowBox[{
          "0.9950041652780722`", ",", "0.009983341664818998`", ",", "0.`", 
            ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{
            RowBox[{"-", "0.998334166470098`"}], ",", "0.9950041652768297`", 
            ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"0.`", ",", "0.`", ",", "1.0050041680561579`", ",", 
            RowBox[{"-", "0.010016675001316243`"}], ",", "0.`", ",", "0.`"}], 
          "}"}], ",", 
        RowBox[{"{", 
          RowBox[{"0.`", ",", "0.`", ",", 
            RowBox[{"-", "1.0016675002027178`"}], ",", "1.0050041680480255`", 
            ",", "0.`", ",", "0.`"}], "}"}], ",", 
        RowBox[{"{", 
          RowBox[{
          "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "1.`", ",", "0.`"}],
           "}"}], ",", 
        RowBox[{"{", 
          RowBox[{
          "1.3375967000683886`*^-12", ",", "3.1097346919750635`*^-13", ",", 
            "0.`", ",", "0.`", ",", 
            RowBox[{"-", "4.35000063747637`*^-10"}], ",", "1.`"}], "}"}]}], 
      "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{
          RowBox[{"Transpose", "[", "mat", "]"}], ".", "sJ3", ".", "mat"}], "//",
         "Chop"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0", "0.9999999999990102`", "0", "0", "0", "0"},
            {
              RowBox[{"-", "0.9999999999990102`"}], "0", "0", "0", "0", "0"},
            {"0", "0", "0", "0.9999999999931655`", "0", "0"},
            {"0", "0", 
              RowBox[{"-", "0.9999999999931655`"}], "0", "0", "0"},
            {"0", "0", "0", "0", "0", "1.`"},
            {"0", "0", "0", "0", 
              RowBox[{"-", "1.`"}], "0"}
            }], "\[NoBreak]", ")"}],
      (MatrixForm[ #]&)]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{
        RowBox[{
          RowBox[{
            RowBox[{"Transpose", "[", "mat", "]"}], ".", "sJ3", ".", "mat"}], 
          "-", "sJ3"}], "//", "Chop"}], "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0", "0", "0", "0", "0", "0"},
            {"0", "0", "0", "0", "0", "0"},
            {"0", "0", "0", "0", "0", "0"},
            {"0", "0", "0", "0", "0", "0"},
            {"0", "0", "0", "0", "0", "0"},
            {"0", "0", "0", "0", "0", "0"}
            }], "\[NoBreak]", ")"}],
      (MatrixForm[ #]&)]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"MatrixNorm", "[", 
      RowBox[{
        RowBox[{"Transpose", "[", "mat", "]"}], ".", "sJ3", ".", "mat"}], 
      "]"}]], "Input"],

Cell[BoxData["1.0000000000016485`"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{
      RowBox[{"MatrixNorm", "[", 
        RowBox[{
          RowBox[{"Transpose", "[", "mat", "]"}], ".", "sJ3", ".", "mat"}], 
        "]"}], "==", "1"}]], "Input"],

Cell[BoxData["False"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"?", "MatrixNorm"}]], "Input"],

Cell[BoxData["\<\"MatrixNorm[mat] gives the infinity-norm of the matrix mat \
of approximate numbers. MatrixNorm[mat, p] gives the p-norm, where p must be \
1, 2, or Infinity.\"\>"], "Print"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"Eigenvalues", "[", "mat", "]"}]], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{"1.1051709180688087`", ",", "1.`", ",", "1.`", ",", 
        RowBox[{
          RowBox[{"0.995004165277451`", "\[InvisibleSpace]"}], "+", 
          RowBox[{"0.0998334166475999`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{
          RowBox[{"0.995004165277451`", "\[InvisibleSpace]"}], "-", 
          RowBox[{"0.0998334166475999`", " ", "\[ImaginaryI]"}]}], ",", 
        "0.9048374180353745`"}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
FrontEndVersion->"4.0 for Microsoft Windows",
ScreenRectangle->{{0, 1024}, {0, 695}},
AutoGeneratedPackage->Automatic,
WindowToolbars->"RulerBar",
InitializationCellEvaluation->False,
CellGrouping->Automatic,
WindowSize->{1016, 668},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"ColorPalette"->{RGBColor, 128}},
ShowCellLabel->True,
RenderingOptions->{"ObjectDithering"->True,
"RasterDithering"->False},
Magnification->1,
StyleDefinitions -> Notebook[{
  
  Cell[CellGroupData[{
  Cell["Style Definitions", "Subtitle"],
  
  Cell["\<\
Modify the definitions below to change the default appearance of \
all cells in a given style.
Make modifications to any definition using commands in the Format menu.\
\>", 
    "Text"],
  
  Cell[CellGroupData[{
  
  Cell["Style Environment Names", "Section"],
  
  Cell[StyleData[All, "Working"],
    PageWidth->WindowWidth,
    CellBracketOptions->{"Color"->RGBColor[0.4, 0, 0.239994]},
    ScriptMinSize->9,
    Background->None],
  
  Cell[StyleData[All, "Presentation"],
    PageWidth->PaperWidth,
    CellBracketOptions->{"Color"->RGBColor[0, 0, 1]},
    ScriptMinSize->9],
  
  Cell[StyleData[All, "Printout"],
    PageWidth->PaperWidth,
    ShowCellLabel->False,
    ImageSize->{200, 200},
    PrivateFontOptions->{"FontType"->"Outline"}]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell["Notebook Options", "Section"],
  
  Cell["\<\
The options defined for the style below will be used at the \
Notebook level.\
\>", "Text"],
  
  Cell[StyleData["Notebook"],
    PageHeaders->{{Cell[ 
            TextData[ {
              CounterBox[ "Page"]}], "PageNumber"], None, Cell[ 
            TextData[ {
              ValueBox[ "FileName"]}], "Header"]}, {Cell[ 
            TextData[ {
              ValueBox[ "FileName"]}], "Header"], None, Cell[ 
            TextData[ {
              CounterBox[ "Page"]}], "PageNumber"]}},
    CellFrameLabelMargins->6,
    StyleMenuListing->None]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell["Styles for Headings", "Section"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Title"],
    CellFrame->{{0, 0}, {0, 0.25}},
    CellMargins->{{18, 10}, {0, 20}},
    CellGroupingRules->{"TitleGrouping", 0},
    PageBreakBelow->False,
    CellFrameMargins->6,
    CellFrameColor->GrayLevel[0],
    LineSpacing->{0.95, 0},
    CounterAssignments->{{"Section", 0}, {"Equation", 0}, {"Figure", 0}},
    FontFamily->"Helvetica",
    FontSize->36,
    FontWeight->"Bold",
    FontColor->RGBColor[0.4, 0, 0.239994]],
  
  Cell[StyleData["Title", "Presentation"],
    CellMargins->{{20, 10}, {2, 20}},
    CellFrameMargins->5,
    FontColor->RGBColor[0, 0, 1]],
  
  Cell[StyleData["Title", "Printout"],
    CellMargins->{{18, 30}, {0, 0}},
    CellFrameMargins->4,
    FontSize->24]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Subtitle"],
    CellMargins->{{20, 30}, {2, 10}},
    CellGroupingRules->{"TitleGrouping", 10},
    PageBreakBelow->False,
    CellFrameMargins->{{0, 4}, {8, 4}},
    LineSpacing->{1, 0},
    CounterAssignments->{{"Section", 0}, {"Equation", 0}, {"Figure", 0}},
    FontFamily->"Helvetica",
    FontSize->24],
  
  Cell[StyleData["Subtitle", "Presentation"],
    CellMargins->{{20, 10}, {2, 10}}],
  
  Cell[StyleData["Subtitle", "Printout"],
    CellMargins->{{18, 30}, {0, 10}},
    FontSize->18]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Section 1"],
    CellFrame->{{0, 0}, {0, 3}},
    CellMargins->{{18, 10}, {10, 30}},
    CellGroupingRules->{"SectionGrouping", 40},
    PageBreakBelow->False,
    CellFrameMargins->{{0, 4}, {8, 4}},
    CellFrameColor->RGBColor[0.4, 0, 0.239994],
    CounterIncrements->"Section",
    CounterAssignments->{{"Subsection", 0}, {"Subsubsection", 0}},
    FontFamily->"Helvetica",
    FontSize->18,
    FontWeight->"Bold"],
  
  Cell[StyleData["Section 1", "Presentation"],
    CellMargins->{{20, 10}, {6, 30}},
    CellFrameMargins->5],
  
  Cell[StyleData["Section 1", "Printout"],
    CellMargins->{{18, 30}, {4, 30}},
    CellFrameMargins->4,
    FontSize->14]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Section"],
    CellFrame->False,
    CellMargins->{{18, 10}, {10, 30}},
    CellGroupingRules->{"SectionGrouping", 40},
    PageBreakBelow->False,
    CellFrameMargins->4,
    CellFrameLabels->{{Cell[ 
            TextData[ {
              CounterBox[ "Section"]}]], None}, {None, None}},
    CounterIncrements->"Section",
    CounterAssignments->{{"Subsection", 0}, {"Subsubsection", 0}},
    FontFamily->"Helvetica",
    FontSize->18,
    FontWeight->"Bold"],
  
  Cell[StyleData["Section", "Presentation"],
    CellMargins->{{20, 10}, {0, 30}}],
  
  Cell[StyleData["Section", "Printout"],
    CellMargins->{{18, 30}, {0, 30}},
    CellFrameMargins->5,
    FontSize->14]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Subsection"],
    CellDingbat->None,
    CellMargins->{{38, 30}, {2, 20}},
    CellGroupingRules->{"SectionGrouping", 50},
    PageBreakBelow->False,
    CellFrameLabels->{{Cell[ 
            TextData[ {
              CounterBox[ "Section"], ".", 
              CounterBox[ "Subsection"]}]], None}, {None, None}},
    CounterIncrements->"Subsection",
    CounterAssignments->{{"Subsubsection", 0}},
    FontFamily->"Times",
    FontSize->14,
    FontWeight->"Bold"],
  
  Cell[StyleData["Subsection", "Presentation"],
    CellMargins->{{35, 30}, {0, 20}}],
  
  Cell[StyleData["Subsection", "Printout"],
    CellMargins->{{18, 30}, {0, 10}},
    FontSize->12]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Subsubsection"],
    CellDingbat->None,
    CellMargins->{{55, 30}, {4, 10}},
    CellGroupingRules->{"SectionGrouping", 60},
    PageBreakBelow->False,
    CellFrameLabels->{{Cell[ 
            TextData[ {
              CounterBox[ "Section"], ".", 
              CounterBox[ "Subsection"], ".", 
              CounterBox[ "Subsubsection"]}]], None}, {None, None}},
    CounterIncrements->"Subsubsection",
    FontFamily->"Times",
    FontSize->12,
    FontWeight->"Bold"],
  
  Cell[StyleData["Subsubsection", "Presentation"],
    CellMargins->{{31, 30}, {0, 12}}],
  
  Cell[StyleData["Subsubsection", "Printout"],
    CellMargins->{{18, 30}, {0, 12}},
    FontSize->10]
  }, Open  ]]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell["Styles for Body Text", "Section"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Text"],
    CellMargins->{{55, 10}, {6, 6}},
    TextJustification->1,
    LineSpacing->{1, 2},
    FontFamily->"Times"],
  
  Cell[StyleData["Text", "Presentation"],
    CellMargins->{{20, 10}, {6, 6}},
    TextAlignment->Left,
    TextJustification->0,
    LineSpacing->{1.3, 0},
    FontSize->14],
  
  Cell[StyleData["Text", "Printout"],
    CellMargins->{{18, 4}, {4, 4}},
    LineSpacing->{1, 3},
    FontSize->10]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Commentary"],
    CellMargins->{{55, 10}, {2, 6}},
    TextJustification->1,
    LineSpacing->{1, 2},
    FontFamily->"Helvetica",
    FontSize->10,
    FontColor->RGBColor[0, 0, 0.4]],
  
  Cell[StyleData["Commentary", "Presentation"],
    CellMargins->{{60, 30}, {2, 6}},
    TextJustification->1,
    LineSpacing->{1.3, 0},
    FontSize->12],
  
  Cell[StyleData["Commentary", "Printout"],
    CellMargins->{{18, 30}, {3, 0}},
    LineSpacing->{1, 3},
    FontFamily->"Times",
    FontSize->10]
  }, Open  ]]
  }, Closed]],
  
  Cell[CellGroupData[{
  
  Cell["Styles for Input/Output", "Section"],
  
  Cell["\<\
The cells in this section define styles used for input and output \
to the kernel.  Be careful when modifying, renaming, or removing these \
styles, because the front end associates special meanings with these style \
names.\
\>", "Text"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Input"],
    CellFrame->{{1, 1}, {0, 1}},
    CellMargins->{{55, 10}, {0, 0}},
    Evaluatable->True,
    CellGroupingRules->"InputGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    GroupPageBreakWithin->False,
    CellLabelPositioning->Automatic,
    CellLabelMargins->{{23, Inherited}, {Inherited, Inherited}},
    DefaultFormatType->DefaultInputFormatType,
    FormatType->InputForm,
    ShowStringCharacters->True,
    NumberMarks->True,
    FontSize->12,
    FontWeight->"Bold",
    Background->None],
  
  Cell[StyleData["Input", "Presentation"],
    CellMargins->{{60, 10}, {0, 10}},
    Background->None],
  
  Cell[StyleData["Input", "Printout"],
    CellMargins->{{55, 10}, {0, 10}},
    FontSize->10,
    Background->None]
  }, Open  ]],
  
  Cell[StyleData["InlineInput"],
    Evaluatable->True,
    CellGroupingRules->"InputGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    GroupPageBreakWithin->False,
    DefaultFormatType->DefaultInputFormatType,
    AutoItalicWords->{},
    FormatType->InputForm,
    ShowStringCharacters->True,
    NumberMarks->True,
    CounterIncrements->"Input",
    FontWeight->"Bold"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Output"],
    CellFrame->{{1, 1}, {1, 0}},
    CellMargins->{{55, 10}, {15, 0}},
    CellEditDuplicate->True,
    CellGroupingRules->"OutputGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    GroupPageBreakWithin->False,
    GeneratedCell->True,
    CellAutoOverwrite->True,
    CellLabelMargins->{{23, Inherited}, {Inherited, Inherited}},
    DefaultFormatType->DefaultOutputFormatType,
    FormatType->InputForm,
    FontSize->12,
    Background->None],
  
  Cell[StyleData["Output", "Presentation"],
    CellMargins->{{60, Inherited}, {10, 0}},
    Background->None],
  
  Cell[StyleData["Output", "Printout"],
    CellMargins->{{55, Inherited}, {10, 0}},
    FontSize->10,
    Background->None]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["InputOnly"],
    CellFrame->1,
    CellMargins->{{55, 10}, {15, 0}},
    Evaluatable->True,
    CellGroupingRules->"InputGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    GroupPageBreakWithin->False,
    CellLabelPositioning->Automatic,
    CellLabelMargins->{{23, Inherited}, {Inherited, Inherited}},
    DefaultFormatType->DefaultInputFormatType,
    FormatType->InputForm,
    ShowStringCharacters->True,
    NumberMarks->True,
    FontSize->12,
    FontWeight->"Bold",
    Background->GrayLevel[0.966674]],
  
  Cell[StyleData["InputOnly", "Presentation"],
    CellMargins->{{60, Inherited}, {10, 10}}],
  
  Cell[StyleData["InputOnly", "Printout"],
    CellMargins->{{55, Inherited}, {10, 10}},
    FontSize->10]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Message"],
    CellFrame->{{1, 1}, {0, 0}},
    CellDingbat->"\[LongDash]",
    CellMargins->{{55, 10}, {0, 0}},
    CellGroupingRules->"OutputGrouping",
    PageBreakWithin->False,
    GroupPageBreakWithin->False,
    GeneratedCell->True,
    CellAutoOverwrite->True,
    ShowCellLabel->False,
    CellLabelMargins->{{23, Inherited}, {Inherited, Inherited}},
    DefaultFormatType->DefaultOutputFormatType,
    FormatType->InputForm,
    StyleMenuListing->None,
    FontFamily->"Helvetica",
    FontSize->10,
    FontSlant->"Oblique",
    FontColor->GrayLevel[0],
    Background->GrayLevel[1]],
  
  Cell[StyleData["Message", "Presentation"],
    CellMargins->{{60, Inherited}, {Inherited, Inherited}},
    LineSpacing->{1, 0}],
  
  Cell[StyleData["Message", "Printout"],
    CellMargins->{{55, Inherited}, {0, 0}},
    FontSize->8]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Print"],
    CellFrame->True,
    CellMargins->{{55, 26}, {1, 6}},
    CellGroupingRules->"OutputGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    GroupPageBreakWithin->False,
    GeneratedCell->True,
    CellAutoOverwrite->True,
    ShowCellLabel->False,
    CellLabelMargins->{{23, Inherited}, {Inherited, Inherited}},
    DefaultFormatType->DefaultOutputFormatType,
    TextAlignment->Left,
    FormatType->InputForm,
    StyleMenuListing->None,
    FontSize->9,
    Background->GrayLevel[0.849989]],
  
  Cell[StyleData["Print", "Presentation"],
    CellFrame->True,
    CellMargins->{{60, Inherited}, {10, 2}},
    Background->GrayLevel[0.849989]],
  
  Cell[StyleData["Print", "Printout"],
    CellFrame->True,
    CellMargins->{{54, Inherited}, {2, 6}},
    FontSize->10,
    Background->GrayLevel[0.849989]]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Graphics"],
    CellFrame->{{1, 1}, {0, 0}},
    CellMargins->{{55, 10}, {0, 0}},
    CellGroupingRules->"GraphicsGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    GeneratedCell->True,
    CellAutoOverwrite->True,
    ShowCellLabel->False,
    DefaultFormatType->DefaultOutputFormatType,
    FormatType->InputForm,
    ImageSize->{288, 288},
    ImageMargins->{{35, Inherited}, {Inherited, 0}},
    StyleMenuListing->None,
    Background->GrayLevel[1]],
  
  Cell[StyleData["Graphics", "Presentation"],
    CellMargins->{{60, Inherited}, {0, 0}},
    ImageMargins->{{10, 10}, {10, 10}}],
  
  Cell[StyleData["Graphics", "Printout"],
    CellMargins->{{55, Inherited}, {0, 0}},
    ImageSize->{288, 288}]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["CellLabel"],
    StyleMenuListing->None,
    FontFamily->"Helvetica",
    FontSize->10,
    FontSlant->"Oblique",
    FontColor->RGBColor[0, 0, 1]],
  
  Cell[StyleData["CellLabel", "Presentation"],
    CellMargins->{{18, Inherited}, {Inherited, Inherited}}],
  
  Cell[StyleData["CellLabel", "Printout"],
    CellMargins->{{0, Inherited}, {Inherited, Inherited}},
    FontSize->8]
  }, Open  ]]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell["Unique Styles", "Section"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Author"],
    CellMargins->{{20, 30}, {45, 5}},
    CellGroupingRules->{"TitleGrouping", 20},
    PageBreakBelow->False,
    CellFrameMargins->{{0, 4}, {8, 4}},
    LineSpacing->{1, 0},
    CounterAssignments->{{"Section", 0}, {"Equation", 0}, {"Figure", 0}},
    FontFamily->"Helvetica",
    FontSize->16,
    FontSlant->"Italic"],
  
  Cell[StyleData["Author", "Presentation"],
    CellMargins->{{20, 30}, {45, 10}},
    FontSize->18],
  
  Cell[StyleData["Author", "Printout"],
    CellMargins->{{18, 30}, {45, 5}},
    FontSize->16]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Abstract"],
    CellFrame->False,
    CellMargins->{{18, 140}, {4, 30}},
    LineSpacing->{0.9, 0},
    FontFamily->"Times",
    FontSize->12],
  
  Cell[StyleData["Abstract", "Presentation"],
    CellFrame->True,
    CellMargins->{{20, 10}, {Inherited, 30}}],
  
  Cell[StyleData["Abstract", "Printout"],
    LineSpacing->{1, 2},
    FontSize->10]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Caption"],
    CellMargins->{{55, 10}, {5, 3}},
    FontFamily->"Helvetica",
    FontSize->9],
  
  Cell[StyleData["Caption", "Presentation"],
    CellMargins->{{60, 65}, {6, 4}},
    FontSize->10],
  
  Cell[StyleData["Caption", "Printout"],
    CellMargins->{{55, 55}, {5, 4}},
    LineSpacing->{1, 2},
    FontSize->8]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Reference"],
    CellMargins->{{24, 40}, {6, 6}},
    TextJustification->1,
    LineSpacing->{1, 0},
    FontFamily->"Times"],
  
  Cell[StyleData["Reference", "Presentation"],
    CellMargins->{{20, 40}, {Inherited, 6}},
    TextJustification->0,
    LineSpacing->{1, 4},
    FontSize->12],
  
  Cell[StyleData["Reference", "Printout"],
    CellMargins->{{18, 4}, {4, 4}},
    FontSize->9]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["PictureGroup"],
    CellFrame->{{1, 1}, {0, 0}},
    CellMargins->{{55, Inherited}, {0, 0}},
    CellGroupingRules->"GraphicsGrouping",
    CellHorizontalScrolling->True,
    PageBreakWithin->False,
    ShowCellLabel->False,
    ImageMargins->{{35, Inherited}, {Inherited, 0}},
    StyleMenuListing->None,
    Background->None],
  
  Cell[StyleData["PictureGroup", "Presentation"],
    CellMargins->{{60, Inherited}, {0, 0}},
    ImageMargins->{{10, 10}, {10, 10}},
    Background->None],
  
  Cell[StyleData["PictureGroup", "Printout"],
    CellMargins->{{55, Inherited}, {0, 0}},
    ImageSize->{288, 288},
    Background->None]
  }, Open  ]]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell["Formulas and Programming", "Section"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["DisplayFormula"],
    CellMargins->{{55, Inherited}, {Inherited, Inherited}},
    CellHorizontalScrolling->True,
    ScriptLevel->0,
    SingleLetterItalics->True,
    StyleMenuListing->None,
    UnderoverscriptBoxOptions->{LimitsPositioning->True}],
  
  Cell[StyleData["DisplayFormula", "Presentation"],
    CellMargins->{{60, 10}, {Inherited, 6}},
    LineSpacing->{1, 5}],
  
  Cell[StyleData["DisplayFormula", "Printout"],
    CellMargins->{{18, 4}, {4, 4}}]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["ChemicalFormula"],
    CellMargins->{{55, 10}, {Inherited, 0}},
    CellHorizontalScrolling->True,
    TextJustification->1,
    AutoSpacing->False,
    ScriptLevel->1,
    ScriptBaselineShifts->{0.6, Automatic},
    SingleLetterItalics->False,
    ZeroWidthTimes->True],
  
  Cell[StyleData["ChemicalFormula", "Presentation"],
    CellMargins->{{60, 10}, {Inherited, 6}}],
  
  Cell[StyleData["ChemicalFormula", "Printout"],
    CellMargins->{{18, 4}, {4, 4}},
    LineSpacing->{1, 3},
    FontSize->10]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["Program"],
    CellMargins->{{55, 10}, {Inherited, 0}},
    CellHorizontalScrolling->True,
    FontFamily->"Courier"],
  
  Cell[StyleData["Program", "Presentation"],
    CellMargins->{{60, 10}, {Inherited, 6}}],
  
  Cell[StyleData["Program", "Printout"],
    CellMargins->{{18, 4}, {4, 4}},
    LineSpacing->{1, 3},
    FontSize->9.5]
  }, Open  ]]
  }, Closed]],
  
  Cell[CellGroupData[{
  
  Cell["Styles for Automatic Numbering", "Section"],
  
  Cell["\<\
The following styles are useful for numbered equations, figures, \
etc.  They automatically give the cell a FrameLabel containing a reference to \
a particular counter, and also increment that counter.\
\>", "Text"],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["NumberedEquation"],
    CellMargins->{{55, 85}, {Inherited, Inherited}},
    CellFrameLabels->{{None, Cell[ 
            TextData[ {"(", 
              CounterBox[ "NumberedEquation"], ")"}]]}, {None, None}},
    DefaultFormatType->DefaultInputFormatType,
    CounterIncrements->"NumberedEquation",
    FormatTypeAutoConvert->False,
    FontFamily->"Times"],
  
  Cell[StyleData["NumberedEquation", "Presentation"],
    CellMargins->{{60, 10}, {Inherited, 6}},
    LineSpacing->{1, 0}],
  
  Cell[StyleData["NumberedEquation", "Printout"],
    CellMargins->{{18, 4}, {4, 4}},
    FontSize->8]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["NumberedFigure"],
    CellMargins->{{55, 95}, {Inherited, Inherited}},
    CellFrameLabels->{{None, None}, {Cell[ 
            TextData[ {"Figure ", 
              CounterBox[ "NumberedFigure"]}], FontWeight -> "Bold"], None}},
    CounterIncrements->"NumberedFigure",
    FormatTypeAutoConvert->False,
    FontFamily->"Times"],
  
  Cell[StyleData["NumberedFigure", "Presentation"],
    CellMargins->{{60, 80}, {Inherited, 6}},
    LineSpacing->{1, 0}],
  
  Cell[StyleData["NumberedFigure", "Printout"],
    CellMargins->{{18, 80}, {4, 4}},
    FontSize->8]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell[StyleData["NumberedTable"],
    CellMargins->{{55, 95}, {Inherited, Inherited}},
    CellFrameLabels->{{None, None}, {Cell[ 
            TextData[ {"Table ", 
              CounterBox[ "NumberedTable"]}], FontWeight -> "Bold"], None}},
    TextAlignment->Center,
    CounterIncrements->"NumberedTable",
    FormatTypeAutoConvert->False,
    FontFamily->"Times"],
  
  Cell[StyleData["NumberedTable", "Presentation"],
    CellMargins->{{60, 80}, {Inherited, 6}},
    LineSpacing->{1, 0}],
  
  Cell[StyleData["NumberedTable", "Printout"],
    CellMargins->{{18, 80}, {4, 4}},
    FontSize->8]
  }, Open  ]]
  }, Open  ]],
  
  Cell[CellGroupData[{
  
  Cell["Styles for Headers and Footers", "Section"],
  
  Cell[StyleData["Header"],
    StyleMenuListing->None,
    FontFamily->"Helvetica",
    FontSize->9],
  
  Cell[StyleData["PageNumber"],
    StyleMenuListing->None,
    FontFamily->"Helvetica",
    FontSize->9,
    FontWeight->"Bold"],
  
  Cell[StyleData["Footer"],
    TextAlignment->Center,
    StyleMenuListing->None,
    FontFamily->"Helvetica",
    FontSize->9]
  }, Closed]]
  }, Open  ]]
  }]
]


(***********************************************************************
Cached data follows.  If you edit this Notebook file directly, not using
Mathematica, you must remove the line containing CacheID at the top of 
the file.  The cache data will then be recreated when you save this file 
from within Mathematica.
***********************************************************************)

(*CellTagsOutline
CellTagsIndex->{
  "Reference section"->{
    Cell[6475, 202, 99, 1, 29, "Text",
      CellTags->"Reference section"]},
  "Setup section"->{
    Cell[7936, 260, 276, 6, 46, "Text",
      CellTags->"Setup section"],
    Cell[8237, 270, 75, 1, 41, "Subsection",
      CellTags->"Setup section"],
    Cell[8774, 286, 354, 9, 46, "Text",
      CellTags->"Setup section"],
    Cell[9165, 300, 70, 1, 41, "Subsection",
      CellTags->"Setup section"],
    Cell[9238, 303, 836, 21, 47, "Text",
      CellTags->"Setup section"],
    Cell[10182, 330, 416, 11, 46, "Text",
      CellTags->"Setup section"],
    Cell[10601, 343, 331, 7, 48, "Text",
      CellTags->"Setup section"],
    Cell[27351, 871, 128, 3, 27, "Input",
      CellTags->"Setup section"]},
  "S5.52.1"->{
    Cell[29477, 945, 160, 5, 27, "Input",
      CellTags->"S5.52.1"],
    Cell[29640, 952, 144, 4, 27, "Input",
      CellTags->"S5.52.1"]},
  "Examples section"->{
    Cell[30251, 979, 335, 6, 46, "Text",
      CellTags->"Examples section"],
    Cell[30611, 989, 458, 10, 27, "Input",
      CellTags->"Examples section"]}
  }
*)

(*CellTagsIndex
CellTagsIndex->{
  {"Reference section", 133032, 3827},
  {"Setup section", 133131, 3830},
  {"S5.52.1", 133755, 3847},
  {"Examples section", 133920, 3852}
  }
*)

(*NotebookFileOutline
Notebook[{

Cell[CellGroupData[{
Cell[1739, 51, 42, 0, 67, "Title"],
Cell[1784, 53, 154, 3, 53, "Subsubtitle"],

Cell[CellGroupData[{
Cell[1963, 60, 31, 0, 63, "Section"],
Cell[1997, 62, 608, 13, 63, "Text"],
Cell[2608, 77, 277, 9, 30, "Text"],
Cell[2888, 88, 479, 10, 46, "Text"],
Cell[3370, 100, 181, 3, 21, "Program"],
Cell[3554, 105, 158, 5, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[3749, 115, 28, 0, 63, "Section"],

Cell[CellGroupData[{
Cell[3802, 119, 30, 0, 31, "Subsubsection"],
Cell[3835, 121, 92, 4, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[3964, 130, 32, 0, 31, "Subsubsection"],
Cell[3999, 132, 30, 0, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[4066, 137, 32, 0, 31, "Subsubsection"],
Cell[4101, 139, 194, 4, 46, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[4332, 148, 34, 0, 31, "Subsubsection"],
Cell[4369, 150, 1765, 27, 420, "Text"]
}, Closed]],

Cell[CellGroupData[{
Cell[6171, 182, 41, 0, 25, "Subsubsection"],
Cell[6215, 184, 19, 0, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[6271, 189, 101, 4, 31, "Subsubsection"],
Cell[6375, 195, 28, 0, 29, "Text"]
}, Open  ]],

Cell[CellGroupData[{
Cell[6440, 200, 32, 0, 31, "Subsubsection"],
Cell[6475, 202, 99, 1, 29, "Text",
  CellTags->"Reference section"]
}, Open  ]],

Cell[CellGroupData[{
Cell[6611, 208, 33, 0, 31, "Subsubsection"],
Cell[6647, 210, 91, 3, 29, "Text"]
}, Open  ]],
Cell[6753, 216, 31, 0, 31, "Subsubsection"],

Cell[CellGroupData[{
Cell[6809, 220, 33, 0, 31, "Subsubsection"],
Cell[6845, 222, 315, 7, 64, "Text"]
}, Open  ]],
Cell[7175, 232, 35, 0, 31, "Subsubsection"],

Cell[CellGroupData[{
Cell[7235, 236, 35, 0, 31, "Subsubsection"],
Cell[7273, 238, 124, 3, 29, "Text"],
Cell[7400, 243, 420, 7, 80, "Text"]
}, Open  ]],
Cell[7835, 253, 37, 0, 31, "Subsubsection"]
}, Closed]],

Cell[CellGroupData[{
Cell[7909, 258, 24, 0, 37, "Section"],
Cell[7936, 260, 276, 6, 46, "Text",
  CellTags->"Setup section"],

Cell[CellGroupData[{
Cell[8237, 270, 75, 1, 41, "Subsection",
  CellTags->"Setup section"],
Cell[8315, 273, 236, 5, 46, "Text"],
Cell[8554, 280, 217, 4, 21, "Program"],
Cell[8774, 286, 354, 9, 46, "Text",
  CellTags->"Setup section"]
}, Open  ]],

Cell[CellGroupData[{
Cell[9165, 300, 70, 1, 41, "Subsection",
  CellTags->"Setup section"],
Cell[9238, 303, 836, 21, 47, "Text",
  CellTags->"Setup section"],
Cell[10077, 326, 102, 2, 51, "InputOnly"],
Cell[10182, 330, 416, 11, 46, "Text",
  CellTags->"Setup section"],
Cell[10601, 343, 331, 7, 48, "Text",
  CellTags->"Setup section"],
Cell[10935, 352, 64, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[11024, 357, 101, 2, 27, "Input"],
Cell[11128, 361, 292, 8, 41, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[11481, 376, 56, 1, 63, "Section",
  InitializationCell->True],
Cell[11540, 379, 125, 4, 29, "Text",
  InitializationCell->True],

Cell[CellGroupData[{
Cell[11690, 387, 102, 1, 41, "Subsection",
  InitializationCell->True],
Cell[11795, 390, 158, 5, 63, "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{
Cell[11990, 400, 124, 4, 41, "Subsection",
  InitializationCell->True],
Cell[12117, 406, 187, 5, 27, "Input",
  InitializationCell->True],
Cell[12307, 413, 215, 5, 45, "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{
Cell[12559, 423, 89, 1, 41, "Subsection",
  InitializationCell->True],
Cell[12651, 426, 99, 1, 27, "Input",
  InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[12799, 433, 61, 1, 63, "Section",
  InitializationCell->True],
Cell[12863, 436, 131, 3, 29, "Text"],

Cell[CellGroupData[{
Cell[13019, 443, 97, 1, 41, "Subsection",
  InitializationCell->True],
Cell[13119, 446, 65, 1, 27, "Input",
  InitializationCell->True]
}, Open  ]],
Cell[13199, 450, 76, 1, 41, "Subsection",
  InitializationCell->True],

Cell[CellGroupData[{
Cell[13300, 455, 125, 4, 41, "Subsection",
  InitializationCell->True],
Cell[13428, 461, 393, 9, 47, "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{
Cell[13858, 475, 122, 4, 41, "Subsection",
  InitializationCell->True],
Cell[13983, 481, 57, 0, 29, "Text"],
Cell[14043, 483, 314, 8, 27, "Input",
  Evaluatable->False],
Cell[14360, 493, 227, 7, 47, "Text"],
Cell[14590, 502, 160, 4, 27, "Input",
  InitializationCell->True],
Cell[14753, 508, 527, 13, 27, "Input",
  InitializationCell->True],
Cell[15283, 523, 998, 23, 67, "Input",
  InitializationCell->True],
Cell[16284, 548, 521, 14, 47, "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{
Cell[16842, 567, 86, 1, 41, "Subsection",
  InitializationCell->True],

Cell[CellGroupData[{
Cell[16953, 572, 118, 4, 32, "Subsubsection",
  InitializationCell->True],
Cell[17074, 578, 98, 3, 29, "Text"],
Cell[17175, 583, 4528, 85, 447, "Input",
  InitializationCell->True]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[21752, 674, 123, 4, 41, "Subsection",
  InitializationCell->True],
Cell[21878, 680, 490, 9, 80, "Text"],
Cell[22371, 691, 228, 6, 27, "Input",
  InitializationCell->True],
Cell[22602, 699, 106, 3, 29, "Text"],
Cell[22711, 704, 299, 8, 27, "Input",
  InitializationCell->True],
Cell[23013, 714, 221, 5, 27, "Input",
  InitializationCell->True],
Cell[23237, 721, 217, 5, 27, "Input",
  InitializationCell->True],
Cell[23457, 728, 231, 5, 27, "Input",
  InitializationCell->True],
Cell[23691, 735, 444, 12, 47, "Input",
  InitializationCell->True],
Cell[24138, 749, 284, 7, 27, "Input",
  InitializationCell->True],
Cell[24425, 758, 423, 11, 47, "Input",
  InitializationCell->True],
Cell[24851, 771, 724, 19, 47, "Input",
  InitializationCell->True],
Cell[25578, 792, 328, 9, 27, "Input",
  InitializationCell->True],
Cell[25909, 803, 170, 4, 27, "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{
Cell[26116, 812, 86, 1, 41, "Subsection",
  InitializationCell->True],
Cell[26205, 815, 76, 1, 27, "Input",
  InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{
Cell[26318, 821, 73, 1, 41, "Subsection",
  InitializationCell->True],
Cell[26394, 824, 51, 1, 27, "Input",
  InitializationCell->True],
Cell[26448, 827, 67, 0, 27, "Input"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[26564, 833, 53, 1, 37, "Section",
  InitializationCell->True],
Cell[26620, 836, 76, 0, 29, "Text"],

Cell[CellGroupData[{
Cell[26721, 840, 73, 1, 41, "Subsection",
  InitializationCell->True],
Cell[26797, 843, 69, 1, 27, "Input",
  InitializationCell->True],
Cell[26869, 846, 74, 1, 27, "Input"]
}, Open  ]],

Cell[CellGroupData[{
Cell[26980, 852, 73, 1, 41, "Subsection",
  InitializationCell->True],
Cell[27056, 855, 58, 1, 27, "Input",
  InitializationCell->True]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[27163, 862, 38, 0, 37, "Section"],
Cell[27204, 864, 122, 3, 29, "Text"],

Cell[CellGroupData[{
Cell[27351, 871, 128, 3, 27, "Input",
  CellTags->"Setup section"],
Cell[27482, 876, 127, 3, 41, "Output"]
}, Open  ]],
Cell[27624, 882, 142, 3, 29, "Text"],

Cell[CellGroupData[{
Cell[27791, 889, 61, 1, 27, "Input"],
Cell[27855, 892, 166, 2, 37, "Print"]
}, Open  ]],
Cell[28036, 897, 139, 3, 29, "Text"],

Cell[CellGroupData[{
Cell[28200, 904, 137, 3, 27, "Input"],
Cell[28340, 909, 267, 6, 14, "Message"],
Cell[28610, 917, 439, 9, 14, "Message"],
Cell[29052, 928, 271, 7, 41, "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[29372, 941, 34, 0, 63, "Section"],
Cell[29409, 943, 65, 0, 29, "Text"],
Cell[29477, 945, 160, 5, 27, "Input",
  CellTags->"S5.52.1"],
Cell[29640, 952, 144, 4, 27, "Input",
  CellTags->"S5.52.1"],
Cell[29787, 958, 295, 10, 30, "Text"],

Cell[CellGroupData[{
Cell[30107, 972, 34, 0, 27, "Input"],
Cell[30144, 974, 92, 2, 41, "Output"]
}, Open  ]],
Cell[30251, 979, 335, 6, 46, "Text",
  CellTags->"Examples section"],

Cell[CellGroupData[{
Cell[30611, 989, 458, 10, 27, "Input",
  CellTags->"Examples section"],
Cell[31072, 1001, 137, 1, 41, "Output"]
}, Open  ]],
Cell[31224, 1005, 66, 0, 29, "Text"],

Cell[CellGroupData[{
Cell[31315, 1009, 85, 1, 27, "Input"],
Cell[31403, 1012, 45, 0, 41, "Output"]
}, Open  ]],
Cell[31463, 1015, 92, 3, 29, "Text"],
Cell[31558, 1020, 265, 7, 27, "Input"],

Cell[CellGroupData[{
Cell[31848, 1031, 66, 1, 27, "Input"],
Cell[31917, 1034, 31, 0, 41, "Output"]
}, Open  ]],
Cell[31963, 1037, 106, 3, 29, "Text"],

Cell[CellGroupData[{
Cell[32094, 1044, 68, 1, 27, "Input"],
Cell[32165, 1047, 455, 7, 41, "Output"]
}, Open  ]],
Cell[32635, 1057, 44, 0, 29, "Text"],

Cell[CellGroupData[{
Cell[32704, 1061, 190, 5, 27, "Input"],
Cell[32897, 1068, 100, 2, 41, "Output"]
}, Open  ]],
Cell[33012, 1073, 98, 3, 29, "Text"],

Cell[CellGroupData[{
Cell[33135, 1080, 340, 9, 27, "Input"],
Cell[33478, 1091, 1724, 39, 79, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[35239, 1135, 98, 2, 27, "Input"],
Cell[35340, 1139, 1025, 25, 308, "Output"]
}, Open  ]],
Cell[36380, 1167, 138, 4, 30, "Text"],

Cell[CellGroupData[{
Cell[36543, 1175, 73, 1, 27, "Input"],
Cell[36619, 1178, 353, 7, 14, "Message"],
Cell[36975, 1187, 531, 9, 60, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[37543, 1201, 30, 0, 27, "Input"],
Cell[37576, 1203, 41, 0, 41, "Output"]
}, Open  ]],
Cell[37632, 1206, 147, 4, 30, "Text"],

Cell[CellGroupData[{
Cell[37804, 1214, 71, 1, 27, "Input"],
Cell[37878, 1217, 154, 3, 41, "Output"]
}, Open  ]],
Cell[38047, 1223, 210, 5, 30, "Text"],

Cell[CellGroupData[{
Cell[38282, 1232, 271, 7, 27, "Input"],
Cell[38556, 1241, 371, 12, 116, "Output"]
}, Open  ]],
Cell[38942, 1256, 36, 0, 29, "Text"],

Cell[CellGroupData[{
Cell[39003, 1260, 135, 3, 27, "Input"],
Cell[39141, 1265, 165, 3, 41, "Output"]
}, Open  ]],
Cell[39321, 1271, 40, 0, 29, "Text"],
Cell[39364, 1273, 165, 4, 27, "Input"],
Cell[39532, 1279, 435, 8, 46, "Text"],

Cell[CellGroupData[{
Cell[39992, 1291, 470, 12, 27, "Input"],
Cell[40465, 1305, 7191, 160, 516, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[47693, 1470, 136, 3, 27, "Input"],
Cell[47832, 1475, 1110, 26, 60, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[48979, 1506, 86, 2, 27, "Input"],
Cell[49068, 1510, 225, 5, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[49330, 1520, 147, 3, 27, "Input"],
Cell[49480, 1525, 224, 5, 14, "Message"],
Cell[49707, 1532, 195, 5, 14, "Message"],
Cell[49905, 1539, 148, 3, 41, "Output"]
}, Open  ]],
Cell[50068, 1545, 65, 0, 29, "Text"],

Cell[CellGroupData[{
Cell[50158, 1549, 186, 5, 27, "Input"],
Cell[50347, 1556, 799, 18, 132, "Output"]
}, Open  ]],
Cell[51161, 1577, 46, 0, 29, "Text"],

Cell[CellGroupData[{
Cell[51232, 1581, 189, 5, 27, "Input"],
Cell[51424, 1588, 2507, 59, 113, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[53968, 1652, 64, 1, 27, "Input"],
Cell[54035, 1655, 68, 2, 56, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[54140, 1662, 67, 1, 27, "Input"],
Cell[54210, 1665, 80, 2, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[54327, 1672, 314, 8, 27, "Input"],
Cell[54644, 1682, 270, 6, 14, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[54951, 1693, 66, 1, 27, "Input"],
Cell[55020, 1696, 135, 3, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[55192, 1704, 145, 4, 27, "Input"],
Cell[55340, 1710, 32, 0, 41, "Output"]
}, Open  ]],
Cell[55387, 1713, 55, 0, 29, "Text"],

Cell[CellGroupData[{
Cell[55467, 1717, 371, 10, 27, "Input"],
Cell[55841, 1729, 5601, 115, 531, "Output"]
}, Open  ]],
Cell[61457, 1847, 44, 0, 29, "Text"],

Cell[CellGroupData[{
Cell[61526, 1851, 216, 6, 27, "Input"],
Cell[61745, 1859, 192, 4, 41, "Output"]
}, Open  ]],
Cell[61952, 1866, 160, 4, 29, "Text"],
Cell[62115, 1872, 196, 5, 27, "Input"],
Cell[62314, 1879, 93, 3, 29, "Text"],
Cell[62410, 1884, 235, 7, 27, "Input"],

Cell[CellGroupData[{
Cell[62670, 1895, 139, 3, 27, "Input"],
Cell[62812, 1900, 5824, 115, 507, "Output"]
}, Open  ]],
Cell[68651, 2018, 231, 5, 27, "Input"],
Cell[68885, 2025, 171, 4, 29, "Text"],

Cell[CellGroupData[{
Cell[69081, 2033, 435, 11, 27, "Input"],
Cell[69519, 2046, 4438, 86, 516, "Output"]
}, Open  ]],
Cell[73972, 2135, 60, 0, 29, "Text"],

Cell[CellGroupData[{
Cell[74057, 2139, 209, 6, 27, "Input"],
Cell[74269, 2147, 287, 6, 14, "Message"],
Cell[74559, 2155, 769, 16, 117, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[75365, 2176, 345, 10, 27, "Input"],
Cell[75713, 2188, 473, 12, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[76223, 2205, 152, 4, 27, "Input"],
Cell[76378, 2211, 202, 5, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[76617, 2221, 152, 4, 27, "Input"],
Cell[76772, 2227, 205, 5, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[77014, 2237, 121, 3, 27, "Input"],
Cell[77138, 2242, 204, 5, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[77379, 2252, 54, 0, 41, "Subsection"],
Cell[77436, 2254, 110, 3, 29, "Text"],
Cell[77549, 2259, 3031, 66, 267, "Input"],
Cell[80583, 2327, 111, 3, 29, "Text"],
Cell[80697, 2332, 3042, 66, 267, "Input"],
Cell[83742, 2400, 174, 4, 29, "Text"],

Cell[CellGroupData[{
Cell[83941, 2408, 135, 3, 27, "Input"],
Cell[84079, 2413, 165, 3, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[84281, 2421, 131, 3, 27, "Input"],
Cell[84415, 2426, 131, 3, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[84583, 2434, 170, 4, 27, "Input"],
Cell[84756, 2440, 502, 12, 41, "Output"]
}, Open  ]],
Cell[85273, 2455, 196, 5, 27, "Input"],
Cell[85472, 2462, 93, 3, 29, "Text"],
Cell[85568, 2467, 235, 7, 27, "Input"],

Cell[CellGroupData[{
Cell[85828, 2478, 364, 9, 27, "Input"],
Cell[86195, 2489, 4789, 97, 482, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[91021, 2591, 503, 13, 27, "Input"],
Cell[91527, 2606, 8190, 151, 428, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[99754, 2762, 504, 13, 27, "Input"],
Cell[100261, 2777, 7456, 143, 432, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[107754, 2925, 144, 4, 27, "Input"],
Cell[107901, 2931, 1210, 28, 60, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[109148, 2964, 191, 5, 27, "Input"],
Cell[109342, 2971, 571, 13, 117, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[109950, 2989, 228, 6, 27, "Input"],
Cell[110181, 2997, 405, 10, 117, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[110623, 3012, 158, 4, 27, "Input"],
Cell[110784, 3018, 46, 0, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[110867, 3023, 192, 5, 27, "Input"],
Cell[111062, 3030, 32, 0, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[111131, 3035, 56, 1, 27, "Input"],
Cell[111190, 3038, 191, 2, 37, "Print"]
}, Open  ]],

Cell[CellGroupData[{
Cell[111418, 3045, 69, 1, 27, "Input"],
Cell[111490, 3048, 467, 9, 41, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)




(***********************************************************************
End of Mathematica Notebook file.
***********************************************************************)

